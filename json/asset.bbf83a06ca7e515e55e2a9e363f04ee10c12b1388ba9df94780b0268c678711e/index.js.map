{
  "version": 3,
  "sources": ["../../lambda/episodes/music-resolver.ts"],
  "sourcesContent": ["/**\r\n * lambda/episodes/music-resolver.ts\r\n * \r\n * Handles Music system queries and mutations:\r\n * - Get music eras and songs\r\n * - Retrieve music videos with shoppable items\r\n * - Admin: Create music eras, add songs, release music videos\r\n */\r\n\r\nimport {\r\n  DynamoDBClient,\r\n  PutItemCommand,\r\n  QueryCommand,\r\n  UpdateItemCommand,\r\n  GetItemCommand,\r\n} from \"@aws-sdk/client-dynamodb\";\r\nimport { marshall, unmarshall } from \"@aws-sdk/util-dynamodb\";\r\nimport { randomUUID } from \"crypto\";\r\nimport { AppSyncIdentityCognito } from \"aws-lambda\";\r\n\r\nconst ddb = new DynamoDBClient({});\r\nconst TABLE_NAME = process.env.TABLE_NAME!;\r\n\r\ntype SAIdentity = (AppSyncIdentityCognito & { groups?: string[] | null }) | null | undefined;\r\n\r\n// \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\r\n// Auth helpers\r\n// \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\r\n\r\nfunction isAdmin(identity: SAIdentity): boolean {\r\n  const claims = (identity as any)?.claims || {};\r\n  const raw = claims[\"cognito:groups\"];\r\n  const groups = Array.isArray(raw)\r\n    ? raw\r\n    : String(raw || \"\").split(\",\").map((g) => g.trim()).filter(Boolean);\r\n  return groups.includes(\"ADMIN\") || groups.includes(\"PRIME\");\r\n}\r\n\r\n// \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\r\n// Types\r\n// \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\r\n\r\ninterface MusicEra {\r\n  id: string;\r\n  name: string;\r\n  description: string;\r\n  aesthetic: string;\r\n  releaseDate: string;\r\n  songs: Song[];\r\n  musicVideos: MusicVideo[];\r\n  storyArcs: string[];\r\n  status: \"IN_PROGRESS\" | \"TEASER_RELEASED\" | \"RELEASED\" | \"ARCHIVED\";\r\n}\r\n\r\ninterface Song {\r\n  id: string;\r\n  title: string;\r\n  eraId: string;\r\n  inspirationStory: string;\r\n  lyrics?: string;\r\n  spotifyUrl?: string;\r\n  appleMusicUrl?: string;\r\n  audioUrl: string;\r\n  duration: number;\r\n  conflict?: string;\r\n  studio: StudioSession;\r\n  createdAt: string;\r\n}\r\n\r\ninterface MusicVideo {\r\n  id: string;\r\n  songId: string;\r\n  title: string;\r\n  description: string;\r\n  s3Key: string;\r\n  thumbnailKey?: string;\r\n  duration: number;\r\n  releaseDate: string;\r\n  status: \"IN_PROGRESS\" | \"TEASER_RELEASED\" | \"RELEASED\" | \"ARCHIVED\";\r\n}\r\n\r\ninterface StudioSession {\r\n  id: string;\r\n  songId: string;\r\n  producer: string;\r\n  engineerNotes: string;\r\n  recordedAt: string;\r\n  studio: string;\r\n}\r\n\r\n// \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\r\n// Helpers\r\n// \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\r\n\r\nfunction nowIso() {\r\n  return new Date().toISOString();\r\n}\r\n\r\nfunction pkForMusicEra() {\r\n  return \"MUSIC#ERA\";\r\n}\r\n\r\nfunction skForMusicEra(eraId: string) {\r\n  return `ERA#${eraId}`;\r\n}\r\n\r\nfunction pkForSong(eraId: string) {\r\n  return `MUSIC#ERA#${eraId}`;\r\n}\r\n\r\nfunction skForSong(songId: string) {\r\n  return `SONG#${songId}`;\r\n}\r\n\r\nfunction pkForMusicVideo(songId: string) {\r\n  return `MUSIC#SONG#${songId}`;\r\n}\r\n\r\nfunction skForMusicVideo(videoId: string) {\r\n  return `VIDEO#${videoId}`;\r\n}\r\n\r\nconst ddbMarshal = (value: any) =>\r\n  marshall(value, { removeUndefinedValues: true });\r\n\r\n// \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\r\n// Queries\r\n// \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\r\n\r\nasync function handleMusicEras(): Promise<MusicEra[]> {\r\n  const res = await ddb.send(\r\n    new QueryCommand({\r\n      TableName: TABLE_NAME,\r\n      KeyConditionExpression: \"pk = :pk\",\r\n      ExpressionAttributeValues: ddbMarshal({\r\n        \":pk\": pkForMusicEra(),\r\n      }),\r\n    }),\r\n  );\r\n\r\n  return (res.Items ?? []).map((raw) => unmarshall(raw) as MusicEra);\r\n}\r\n\r\nasync function handleMusicEra(args: { id: string }): Promise<MusicEra | null> {\r\n  const res = await ddb.send(\r\n    new QueryCommand({\r\n      TableName: TABLE_NAME,\r\n      KeyConditionExpression: \"pk = :pk AND sk = :sk\",\r\n      ExpressionAttributeValues: ddbMarshal({\r\n        \":pk\": pkForMusicEra(),\r\n        \":sk\": skForMusicEra(args.id),\r\n      }),\r\n    }),\r\n  );\r\n\r\n  const raw = (res.Items ?? [])[0];\r\n  if (!raw) return null;\r\n\r\n  return unmarshall(raw) as MusicEra;\r\n}\r\n\r\nasync function handleEraSongs(args: { eraId: string }): Promise<Song[]> {\r\n  const res = await ddb.send(\r\n    new QueryCommand({\r\n      TableName: TABLE_NAME,\r\n      KeyConditionExpression: \"pk = :pk AND begins_with(sk, :sk)\",\r\n      ExpressionAttributeValues: ddbMarshal({\r\n        \":pk\": pkForSong(args.eraId),\r\n        \":sk\": \"SONG#\",\r\n      }),\r\n    }),\r\n  );\r\n\r\n  return (res.Items ?? []).map((raw) => unmarshall(raw) as Song);\r\n}\r\n\r\nasync function handleSongMusicVideos(args: { songId: string }): Promise<MusicVideo[]> {\r\n  const res = await ddb.send(\r\n    new QueryCommand({\r\n      TableName: TABLE_NAME,\r\n      KeyConditionExpression: \"pk = :pk AND begins_with(sk, :sk)\",\r\n      ExpressionAttributeValues: ddbMarshal({\r\n        \":pk\": pkForMusicVideo(args.songId),\r\n        \":sk\": \"VIDEO#\",\r\n      }),\r\n    }),\r\n  );\r\n\r\n  return (res.Items ?? []).map((raw) => unmarshall(raw) as MusicVideo);\r\n}\r\n\r\nasync function handleMusicVideo(args: { id: string }): Promise<MusicVideo | null> {\r\n  // In production, would scan or use GSI to find video by id\r\n  // For now returning null as placeholder\r\n  return null;\r\n}\r\n\r\n// \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\r\n// Admin Mutations\r\n// \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\r\n\r\nasync function handleAdminCreateMusicEra(\r\n  args: {\r\n    name: string;\r\n    description: string;\r\n    aesthetic: string;\r\n    releaseDate: string;\r\n  },\r\n  identity: SAIdentity,\r\n): Promise<MusicEra> {\r\n  if (!isAdmin(identity)) throw new Error(\"ADMIN required\");\r\n\r\n  const eraId = randomUUID();\r\n  const now = nowIso();\r\n\r\n  const era: MusicEra = {\r\n    id: eraId,\r\n    name: args.name,\r\n    description: args.description,\r\n    aesthetic: args.aesthetic,\r\n    releaseDate: args.releaseDate,\r\n    songs: [],\r\n    musicVideos: [],\r\n    storyArcs: [],\r\n    status: \"IN_PROGRESS\",\r\n  };\r\n\r\n  await ddb.send(\r\n    new PutItemCommand({\r\n      TableName: TABLE_NAME,\r\n      Item: ddbMarshal({\r\n        pk: pkForMusicEra(),\r\n        sk: skForMusicEra(eraId),\r\n        entityType: \"MUSIC_ERA\",\r\n        gsi1pk: \"MUSIC#ERA#STATUS#IN_PROGRESS\",\r\n        gsi1sk: now,\r\n        ...era,\r\n      }),\r\n    }),\r\n  );\r\n\r\n  return era;\r\n}\r\n\r\nasync function handleAdminCreateSong(\r\n  args: {\r\n    eraId: string;\r\n    title: string;\r\n    inspirationStory: string;\r\n    spotifyUrl?: string;\r\n    audioUrl: string;\r\n  },\r\n  identity: SAIdentity,\r\n): Promise<Song> {\r\n  if (!isAdmin(identity)) throw new Error(\"ADMIN required\");\r\n\r\n  const songId = randomUUID();\r\n  const now = nowIso();\r\n\r\n  const studio: StudioSession = {\r\n    id: randomUUID(),\r\n    songId,\r\n    producer: \"TBD\",\r\n    engineerNotes: \"\",\r\n    recordedAt: now,\r\n    studio: \"TBD\",\r\n  };\r\n\r\n  const song: Song = {\r\n    id: songId,\r\n    title: args.title,\r\n    eraId: args.eraId,\r\n    inspirationStory: args.inspirationStory,\r\n    spotifyUrl: args.spotifyUrl,\r\n    audioUrl: args.audioUrl,\r\n    duration: 0,\r\n    studio,\r\n    createdAt: now,\r\n  };\r\n\r\n  await ddb.send(\r\n    new PutItemCommand({\r\n      TableName: TABLE_NAME,\r\n      Item: ddbMarshal({\r\n        pk: pkForSong(args.eraId),\r\n        sk: skForSong(songId),\r\n        entityType: \"SONG\",\r\n        gsi1pk: `MUSIC#ERA#${args.eraId}`,\r\n        gsi1sk: now,\r\n        ...song,\r\n      }),\r\n    }),\r\n  );\r\n\r\n  return song;\r\n}\r\n\r\nasync function handleAdminCreateMusicVideo(\r\n  args: {\r\n    songId: string;\r\n    title: string;\r\n    s3Key: string;\r\n  },\r\n  identity: SAIdentity,\r\n): Promise<MusicVideo> {\r\n  if (!isAdmin(identity)) throw new Error(\"ADMIN required\");\r\n\r\n  const videoId = randomUUID();\r\n  const now = nowIso();\r\n\r\n  const video: MusicVideo = {\r\n    id: videoId,\r\n    songId: args.songId,\r\n    title: args.title,\r\n    description: \"\",\r\n    s3Key: args.s3Key,\r\n    duration: 0,\r\n    releaseDate: now,\r\n    status: \"IN_PROGRESS\",\r\n  };\r\n\r\n  // Note: Would need to know eraId to properly store\r\n  // For now storing under song\r\n  await ddb.send(\r\n    new PutItemCommand({\r\n      TableName: TABLE_NAME,\r\n      Item: ddbMarshal({\r\n        pk: pkForMusicVideo(args.songId),\r\n        sk: skForMusicVideo(videoId),\r\n        entityType: \"MUSIC_VIDEO\",\r\n        gsi1pk: `MUSIC#VIDEO#STATUS#IN_PROGRESS`,\r\n        gsi1sk: now,\r\n        ...video,\r\n      }),\r\n    }),\r\n  );\r\n\r\n  return video;\r\n}\r\n\r\n// \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\r\n// AppSync Lambda resolver entrypoint\r\n// \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\r\n\r\nexport const handler = async (event: any) => {\r\n  console.log(\"MusicResolverFn event\", JSON.stringify(event));\r\n\r\n  const fieldName = event.info?.fieldName as string | undefined;\r\n\r\n  try {\r\n    switch (fieldName) {\r\n      case \"musicEras\":\r\n        return await handleMusicEras();\r\n\r\n      case \"musicEra\":\r\n        return await handleMusicEra(event.arguments);\r\n\r\n      case \"eraSongs\":\r\n        return await handleEraSongs(event.arguments);\r\n\r\n      case \"songMusicVideos\":\r\n        return await handleSongMusicVideos(event.arguments);\r\n\r\n      case \"musicVideo\":\r\n        return await handleMusicVideo(event.arguments);\r\n\r\n      case \"adminCreateMusicEra\":\r\n        return await handleAdminCreateMusicEra(event.arguments, event.identity);\r\n\r\n      case \"adminCreateSong\":\r\n        return await handleAdminCreateSong(event.arguments, event.identity);\r\n\r\n      case \"adminCreateMusicVideo\":\r\n        return await handleAdminCreateMusicVideo(event.arguments, event.identity);\r\n\r\n      default:\r\n        throw new Error(`Unknown field: ${fieldName}`);\r\n    }\r\n  } catch (err: any) {\r\n    console.error(\"MusicResolverFn error\", err);\r\n    throw err;\r\n  }\r\n};\r\n"],
  "mappings": "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",
  "names": ["music_resolver_exports", "__export", "handler", "__toCommonJS", "import_client_dynamodb", "import_util_dynamodb", "import_crypto", "ddb", "TABLE_NAME", "isAdmin", "identity", "raw", "groups", "g", "nowIso", "pkForMusicEra", "skForMusicEra", "eraId", "pkForSong", "skForSong", "songId", "pkForMusicVideo", "skForMusicVideo", "videoId", "ddbMarshal", "value", "handleMusicEras", "handleMusicEra", "args", "handleEraSongs", "handleSongMusicVideos", "handleMusicVideo", "handleAdminCreateMusicEra", "now", "era", "handleAdminCreateSong", "studio", "song", "handleAdminCreateMusicVideo", "video", "event", "fieldName", "err"]
}
