# ===============================================
# ⚠️  AUTO-GENERATED FILE — DO NOT EDIT
#
# Generated by: scripts/build-schema.mjs
# Source: appsync/schema/*.graphql
# ===============================================

# -----------------------------------------------
# 00_scalars.graphql
# -----------------------------------------------

# ─────────────────────────────────────────
# Scalars (AppSync + common)
# ─────────────────────────────────────────

scalar AWSDateTime
scalar AWSDate
scalar AWSJSON

# -----------------------------------------------
# 01_directives.graphql
# -----------------------------------------------

# ─────────────────────────────────────────
# AppSync auth directives (used throughout schema)
# ─────────────────────────────────────────

directive @aws_cognito_user_pools on FIELD_DEFINITION | OBJECT
directive @aws_auth(cognito_groups: [String!]) on FIELD_DEFINITION | OBJECT

# -----------------------------------------------
# 10_root.graphql
# -----------------------------------------------

# ─────────────────────────────────────────
# Root operation shells ONLY
# (Domain modules must use: extend type Query / extend type Mutation)
# ─────────────────────────────────────────

type Query {
  _root: String
}

type Mutation {
  _root: String
}

# -----------------------------------------------
# 15_core.graphql
# -----------------------------------------------

# ─────────────────────────────────────────
# Core / Auth
# ─────────────────────────────────────────

type Me {
  id: ID!
  email: String!
  role: String!
  tier: String!
}

type RoleResult {
  userId: ID!
  role: String!
}

extend type Query {
  # Simple healthcheck (used by hello.graphql in site/src/graphql)
  hello: String

  # Current user basic info
  me: Me! @aws_cognito_user_pools
}

extend type Mutation {
  setUserRole(userId: ID!, role: String!): RoleResult!
    @aws_cognito_user_pools
    @aws_auth(cognito_groups: ["ADMIN", "PRIME"])
}

# -----------------------------------------------
# 20_closet.graphql
# -----------------------------------------------

# ─────────────────────────────────────────
# Closet domain
# Owns: closet enums, types, inputs, bg change request types, comments, likes
# ─────────────────────────────────────────

# ─────────────────────────────────────────
# Enums
# ─────────────────────────────────────────

enum ClosetAudience {
  PUBLIC
  BESTIES
  EXCLUSIVE
}

enum ClosetVisibility {
  PRIVATE
  BESTIE
  PUBLIC
}

# Expanded to match values used by backend/workflows and to avoid
# AppSync "Invalid input for Enum 'ClosetStatus'" serialization errors.
enum ClosetStatus {
  DRAFT
  PENDING
  PENDING_PUBLISH
  APPROVED
  PUBLISHED
  REJECTED
  ARCHIVED
  FAILED
  EXPIRED
}



enum ClosetFeedSort {
  NEWEST
  MOST_LOVED
  LALAS_PICK
  MY_FAVES
}

# ─────────────────────────────────────────
# Core types
# ─────────────────────────────────────────

type ClosetItem {
  id: ID!
  ownerId: ID
  ownerSub: ID
  title: String
  mediaKey: String
  rawMediaKey: String
  category: String
  subcategory: String
  colorTags: [String!]
  season: String
  vibes: String
  notes: String
  visibility: ClosetVisibility!
  affiliateUrl: String
  episodeIds: [ID!]
  status: ClosetStatus!
  audience: ClosetAudience
  pinned: Boolean
  favoriteCount: Int
  coinValue: Int
  backgroundStatus: String
  scheduledAt: AWSDateTime
  createdAt: AWSDateTime
  updatedAt: AWSDateTime
}

type ClosetConnection {
  items: [ClosetItem!]!
  nextToken: String
}

# ─────────────────────────────────────────
# Comments & Likes
# ─────────────────────────────────────────

type Comment {
  id: ID!
  itemId: ID!
  userId: ID!
  text: String!
  createdAt: AWSDateTime!
}

type CommentConnection {
  items: [Comment!]!
  nextToken: String
}

type Like {
  itemId: ID!
  userId: ID!
  createdAt: AWSDateTime!
}

type LikeConnection {
  items: [Like!]!
  nextToken: String
}

# ─────────────────────────────────────────
# Inputs
# ─────────────────────────────────────────

input CreateClosetItemInput {
  title: String
  mediaKey: String
  rawMediaKey: String
  category: String
  subcategory: String
  colorTags: [String!]
  season: String
  vibes: String
  notes: String
  visibility: ClosetVisibility
  affiliateUrl: String
  episodeIds: [ID!]
}

input UpdateClosetItemStoryInput {
  itemId: ID!
  storyId: ID
  storyPosition: Int
}

input CommentOnClosetItemInput {
  itemId: ID!
  text: String!
}

input BestieCreateClosetItemInput {
  title: String
  mediaKey: String
  rawMediaKey: String
  category: String
  subcategory: String
  colorTags: [String!]
  season: String
  vibes: String
  notes: String
  visibility: ClosetVisibility
  affiliateUrl: String
  episodeIds: [ID!]
}

input BestieUpdateClosetItemInput {
  title: String
  mediaKey: String
  rawMediaKey: String
  category: String
  subcategory: String
  colorTags: [String!]
  season: String
  vibes: String
  notes: String
  visibility: ClosetVisibility
  affiliateUrl: String
  episodeIds: [ID!]
}

input AdminCreateClosetItemInput {
  ownerId: ID
  title: String
  mediaKey: String
  rawMediaKey: String
  category: String
  subcategory: String
  colorTags: [String!]
  season: String
  vibes: String
  notes: String
  visibility: ClosetVisibility
  affiliateUrl: String
  episodeIds: [ID!]
  status: ClosetStatus
  audience: ClosetAudience
  pinned: Boolean
  coinValue: Int
  backgroundStatus: String
}

input AdminUpdateClosetItemInput {
  id: ID!
  ownerId: ID
  title: String
  mediaKey: String
  rawMediaKey: String
  category: String
  subcategory: String
  colorTags: [String!]
  season: String
  vibes: String
  notes: String
  visibility: ClosetVisibility
  affiliateUrl: String
  episodeIds: [ID!]
  status: ClosetStatus
  audience: ClosetAudience
  pinned: Boolean
  coinValue: Int
  backgroundStatus: String
  scheduledAt: AWSDateTime
}

# ─────────────────────────────────────────
# Background change request (owned here, referenced elsewhere)
# ─────────────────────────────────────────

input BgChangeRequestInput {
  itemId: ID!
  newBackgroundKey: String!
  notes: String
}

type BgChangeRequestResult {
  ok: Boolean!
  requestId: ID
}

# ─────────────────────────────────────────
# Query operations
# ─────────────────────────────────────────

extend type Query {
  myCloset(limit: Int, nextToken: String): ClosetConnection!
    @aws_cognito_user_pools
    @aws_auth(cognito_groups: ["BESTIE", "CREATOR", "COLLAB", "ADMIN", "PRIME"])

  myWishlist(limit: Int, nextToken: String): ClosetConnection!
    @aws_cognito_user_pools
    @aws_auth(cognito_groups: ["BESTIE", "CREATOR", "COLLAB", "ADMIN", "PRIME"])

  bestieClosetItems(limit: Int, nextToken: String): ClosetConnection!
    @aws_cognito_user_pools
    @aws_auth(cognito_groups: ["BESTIE", "CREATOR", "COLLAB", "ADMIN", "PRIME"])

  closetItemComments(itemId: ID!, limit: Int, nextToken: String): CommentConnection!
    @aws_cognito_user_pools

  adminClosetItemLikes(itemId: ID!, limit: Int, nextToken: String): LikeConnection!
    @aws_cognito_user_pools
    @aws_auth(cognito_groups: ["ADMIN", "PRIME"])

  adminClosetItemComments(itemId: ID!, limit: Int, nextToken: String): CommentConnection!
    @aws_cognito_user_pools
    @aws_auth(cognito_groups: ["ADMIN", "PRIME"])

  adminListPending(limit: Int, nextToken: String): ClosetConnection!
    @aws_cognito_user_pools
    @aws_auth(cognito_groups: ["ADMIN", "PRIME"])

  adminListClosetItems(status: ClosetStatus, limit: Int, nextToken: String): ClosetConnection!
    @aws_cognito_user_pools
    @aws_auth(cognito_groups: ["ADMIN", "PRIME"])

  closetFeed(sort: ClosetFeedSort, limit: Int, nextToken: String): ClosetConnection!
    @aws_cognito_user_pools
}

# ─────────────────────────────────────────
# Mutation operations
# ─────────────────────────────────────────

extend type Mutation {
  createClosetItem(input: CreateClosetItemInput!): ClosetItem!
    @aws_cognito_user_pools
    @aws_auth(cognito_groups: ["BESTIE", "CREATOR", "COLLAB", "ADMIN", "PRIME"])

  requestClosetApproval(itemId: ID!): ClosetItem!
    @aws_cognito_user_pools
    @aws_auth(cognito_groups: ["BESTIE", "CREATOR", "COLLAB", "ADMIN", "PRIME"])

  updateClosetMediaKey(itemId: ID!, mediaKey: String!): ClosetItem!
    @aws_cognito_user_pools
    @aws_auth(cognito_groups: ["BESTIE", "CREATOR", "COLLAB", "ADMIN", "PRIME"])

  updateClosetItemStory(input: UpdateClosetItemStoryInput!): ClosetItem!
    @aws_cognito_user_pools
    @aws_auth(cognito_groups: ["BESTIE", "CREATOR", "COLLAB", "ADMIN", "PRIME"])

  likeClosetItem(itemId: ID!): ClosetItem!
    @aws_cognito_user_pools

  commentOnClosetItem(input: CommentOnClosetItemInput!): Comment!
    @aws_cognito_user_pools

  bestieCreateClosetItem(input: BestieCreateClosetItemInput!): ClosetItem!
    @aws_cognito_user_pools
    @aws_auth(cognito_groups: ["BESTIE", "CREATOR", "COLLAB", "ADMIN", "PRIME"])

  bestieUpdateClosetItem(id: ID!, input: BestieUpdateClosetItemInput!): ClosetItem!
    @aws_cognito_user_pools
    @aws_auth(cognito_groups: ["BESTIE", "CREATOR", "COLLAB", "ADMIN", "PRIME"])

  bestieDeleteClosetItem(id: ID!): Boolean!
    @aws_cognito_user_pools
    @aws_auth(cognito_groups: ["BESTIE", "CREATOR", "COLLAB", "ADMIN", "PRIME"])

  adminCreateClosetItem(input: AdminCreateClosetItemInput!): ClosetItem!
    @aws_cognito_user_pools
    @aws_auth(cognito_groups: ["ADMIN", "PRIME"])

  adminApproveItem(closetItemId: ID!): ClosetItem!
    @aws_cognito_user_pools
    @aws_auth(cognito_groups: ["ADMIN", "PRIME"])

  adminRejectItem(closetItemId: ID!, reason: String): ClosetItem!
    @aws_cognito_user_pools
    @aws_auth(cognito_groups: ["ADMIN", "PRIME"])

  adminPublishClosetItem(closetItemId: ID!): ClosetItem
    @aws_cognito_user_pools
    @aws_auth(cognito_groups: ["ADMIN", "PRIME"])

  adminSetClosetAudience(closetItemId: ID!, audience: ClosetAudience!): ClosetItem!
    @aws_cognito_user_pools
    @aws_auth(cognito_groups: ["ADMIN", "PRIME"])

  adminUpdateClosetItem(input: AdminUpdateClosetItemInput!): ClosetItem!
    @aws_cognito_user_pools
    @aws_auth(cognito_groups: ["ADMIN", "PRIME"])
}

# -----------------------------------------------
# 30_bestie.graphql
# -----------------------------------------------

# ─────────────────────────────────────────
# Bestie workflow + membership types
# ─────────────────────────────────────────

type BestieStatus {
  userId: ID!
  isBestie: Boolean!
  tier: String
  renewsAt: AWSDateTime
  trialActive: Boolean
  trialEndsAt: AWSDateTime
}

type BestieCheckoutSession {
  checkoutUrl: String!
}

extend type Mutation {
  """
  Bestie workflow: request a background swap for a closet item.
  """
  requestClosetBackgroundChange(input: BgChangeRequestInput!): BgChangeRequestResult!
    @aws_cognito_user_pools
    @aws_auth(cognito_groups: ["BESTIE", "CREATOR", "COLLAB", "ADMIN", "PRIME"])
}

# -----------------------------------------------
# 40_stories.graphql
# -----------------------------------------------

type BestieStory {
  id: ID!
  title: String!
  body: String
  createdAt: AWSDateTime!
  updatedAt: AWSDateTime
  status: BestieStoryStatus!
  episodeId: ID
  closetItemIds: [ID!]
  mediaKeys: [String!]
}

enum BestieStoryStatus {
  DRAFT
  SCHEDULED
  PUBLISHED
  ARCHIVED
}

type BestieStoryConnection {
  items: [BestieStory!]!
  nextToken: String
}

type Story {
  id: ID!
  ownerId: ID!
  title: String
  status: String
  createdAt: AWSDateTime
  publishedAt: AWSDateTime
}

input CreateStoryInput {
  title: String!
  closetItemIds: [ID!]
}

extend type Query {
  stories(limit: Int, nextToken: String): BestieStoryConnection
    @aws_cognito_user_pools

  myStories(limit: Int, nextToken: String): BestieStoryConnection
    @aws_cognito_user_pools
    @aws_auth(cognito_groups: ["BESTIE", "CREATOR", "COLLAB", "ADMIN", "PRIME"])
}

extend type Mutation {
  createStory(input: CreateStoryInput!): Story!
    @aws_cognito_user_pools
    @aws_auth(cognito_groups: ["BESTIE", "CREATOR", "COLLAB", "ADMIN", "PRIME"])

  publishStory(storyId: ID!): Story!
    @aws_cognito_user_pools
    @aws_auth(cognito_groups: ["BESTIE", "CREATOR", "COLLAB", "ADMIN", "PRIME"])
}

