# Styling Adventures GraphQL Schema
# Root types: Query, Mutation

# ─────────────────────────────────────────
# Root query type
# ─────────────────────────────────────────
type Query {
  # Simple healthcheck
  hello: String

  # Current user basic info
  me: Me!
    @aws_cognito_user_pools

  # Closet queries
  # Bestie+ only: Fans do not have a personal closet
  myCloset(limit: Int, nextToken: String): ClosetConnection!
    @aws_cognito_user_pools
    @aws_auth(cognito_groups: ["BESTIE", "CREATOR", "COLLAB", "ADMIN", "PRIME"])

  myWishlist(limit: Int, nextToken: String): ClosetConnection!
    @aws_cognito_user_pools
    @aws_auth(cognito_groups: ["BESTIE", "CREATOR", "COLLAB", "ADMIN", "PRIME"])

  # Bestie-only view (used by BestieCloset UI)
  bestieClosetItems(limit: Int, nextToken: String): ClosetConnection!
    @aws_cognito_user_pools
    @aws_auth(cognito_groups: ["BESTIE", "CREATOR", "COLLAB", "ADMIN", "PRIME"])

  # Comments & likes (Fans + Besties)
  closetItemComments(
    itemId: ID!
    limit: Int
    nextToken: String
  ): CommentConnection!
    @aws_cognito_user_pools

  adminClosetItemLikes(
    itemId: ID!
    limit: Int
    nextToken: String
  ): LikeConnection!
    @aws_cognito_user_pools
    @aws_auth(cognito_groups: ["ADMIN", "PRIME"])

  adminClosetItemComments(
    itemId: ID!
    limit: Int
    nextToken: String
  ): CommentConnection!
    @aws_cognito_user_pools
    @aws_auth(cognito_groups: ["ADMIN", "PRIME"])

  # Admin / feed views
  adminListPending(limit: Int, nextToken: String): ClosetConnection!
    @aws_cognito_user_pools
    @aws_auth(cognito_groups: ["ADMIN", "PRIME"])

  adminListClosetItems(
    status: ClosetStatus
    limit: Int
    nextToken: String
  ): ClosetConnection!
    @aws_cognito_user_pools
    @aws_auth(cognito_groups: ["ADMIN", "PRIME"])

  # Community feed – all signed-in users (Fans + Besties)
  closetFeed(
    sort: ClosetFeedSort
    limit: Int
    nextToken: String
  ): ClosetConnection!
    @aws_cognito_user_pools

  """
  Stories for the **public / community feed** (PUBLISHED only).
  Powered by BestiesStoriesStack.
  """
  stories(limit: Int, nextToken: String): BestieStoryConnection
    @aws_cognito_user_pools

  """
  Stories created by the current user (Bestie or higher).
  """
  myStories(limit: Int, nextToken: String): BestieStoryConnection
    @aws_cognito_user_pools
    @aws_auth(cognito_groups: ["BESTIE", "CREATOR", "COLLAB", "ADMIN", "PRIME"])

  # Episodes / early access
  isEpisodeEarlyAccess(episodeId: ID!): EpisodeAccess!
    @aws_cognito_user_pools

  # Fan/Bestie episode unlocks
  myUnlockedEpisodes: [EpisodeUnlock!]!
    @aws_cognito_user_pools

  # Game / leaderboard
  topXP(limit: Int = 50, season: String): [LeaderboardEntry!]!
    @aws_cognito_user_pools

  topCoins(limit: Int = 50, season: String): [LeaderboardEntry!]!
    @aws_cognito_user_pools

  # Polls
  getPoll(pollId: ID!): Poll
    @aws_cognito_user_pools

  # Game profile
  getMyProfile: GameProfile!
    @aws_cognito_user_pools

  # Bestie status
  meBestieStatus: BestieStatus!
    @aws_cognito_user_pools

  # Creator / livestream & monetisation
  getCreatorLivestreamInfo: CreatorLivestreamInfo!
    @aws_cognito_user_pools
    @aws_auth(cognito_groups: ["CREATOR", "ADMIN", "PRIME"])

  creatorRevenueSummary: CreatorRevenueSummary!
    @aws_cognito_user_pools
    @aws_auth(cognito_groups: ["CREATOR", "ADMIN", "PRIME"])

  """
  Monetization HQ: earnings broken down by platform and time window.
  """
  creatorRevenueByPlatform(
    window: CreatorRevenueWindow!
  ): CreatorRevenueByPlatform
    @aws_cognito_user_pools
    @aws_auth(cognito_groups: ["CREATOR", "ADMIN", "PRIME"])

  """
  Creator goal-setting & focus compass for the current creator.
  Values are simple string codes like:
    primaryGoal: "GROWTH" | "BALANCE" | "BUSINESS_FIRST"
    timeHorizon: "30_DAYS" | "90_DAYS" | "YEAR"
    riskTolerance: "LOW" | "MEDIUM" | "HIGH"
  """
  creatorGoalCompass: CreatorGoalCompass
    @aws_cognito_user_pools
    @aws_auth(cognito_groups: ["CREATOR", "ADMIN", "PRIME"])

  # Creator filing cabinets (personal asset library)
  creatorCabinets: [CreatorCabinet!]!
    @aws_cognito_user_pools
    @aws_auth(cognito_groups: ["CREATOR", "ADMIN", "PRIME"])

  creatorCabinet(id: ID!): CreatorCabinet
    @aws_cognito_user_pools
    @aws_auth(cognito_groups: ["CREATOR", "ADMIN", "PRIME"])

  # Folders for a given cabinet
  creatorCabinetFolders(cabinetId: ID!): [CreatorFolder!]!
    @aws_cognito_user_pools
    @aws_auth(cognito_groups: ["CREATOR", "ADMIN", "PRIME"])

  creatorCabinetAssets(
    cabinetId: ID!
    folderId: ID
    category: CreatorCabinetCategory
    tag: String
    search: String
    limit: Int
    nextToken: String
  ): CreatorAssetConnection!
    @aws_cognito_user_pools
    @aws_auth(cognito_groups: ["CREATOR", "ADMIN", "PRIME"])

  """
  Admin: List all creator assets for a given user (ownerSub).
  Optionally filter by cabinet, folder or moderationStatus.
  includeSoftDeleted=true lets admin see SOFT_DELETED items as well.
  """
  adminListCreatorAssetsByUser(
    ownerSub: ID!
    cabinetId: ID
    folderId: ID
    moderationStatus: CreatorAssetModerationStatus
    includeSoftDeleted: Boolean = true
    limit: Int = 50
    nextToken: String
  ): CreatorAssetConnection!
    @aws_cognito_user_pools
    @aws_auth(cognito_groups: ["ADMIN", "PRIME"])

  """
  Admin: Get a single creator asset by cabinet + id.
  """
  adminGetCreatorAsset(
    cabinetId: ID!
    id: ID!
  ): CreatorAsset
    @aws_cognito_user_pools
    @aws_auth(cognito_groups: ["ADMIN", "PRIME"])

  # Game economy config / rules (admin)
  getGameEconomyConfig: GameEconomyConfig!
    @aws_cognito_user_pools
    @aws_auth(cognito_groups: ["ADMIN", "PRIME"])

  # Episodes admin (admin-only)
  adminListEpisodes(
    status: EpisodeStatus
    showId: String
    season: Int
    limit: Int = 20
    nextToken: String
  ): EpisodeAdminConnection!
    @aws_cognito_user_pools
    @aws_auth(cognito_groups: ["ADMIN", "PRIME"])

  # Admin Settings
  getAdminSettings: AdminSettings!
    @aws_cognito_user_pools
    @aws_auth(cognito_groups: ["ADMIN", "PRIME"])
}

# ─────────────────────────────────────────
# Root mutation type
# ─────────────────────────────────────────
type Mutation {
  # Roles
  setUserRole(userId: ID!, role: String!): RoleResult!
    @aws_cognito_user_pools
    @aws_auth(cognito_groups: ["ADMIN", "PRIME"])

  # Closet (Bestie+ core)
  # Fans cannot own a closet; they can only engage with existing items.
  createClosetItem(input: CreateClosetItemInput!): ClosetItem!
    @aws_cognito_user_pools
    @aws_auth(cognito_groups: ["BESTIE", "CREATOR", "COLLAB", "ADMIN", "PRIME"])

  requestClosetApproval(itemId: ID!): ClosetItem!
    @aws_cognito_user_pools
    @aws_auth(cognito_groups: ["BESTIE", "CREATOR", "COLLAB", "ADMIN", "PRIME"])

  updateClosetMediaKey(itemId: ID!, mediaKey: String!): ClosetItem!
    @aws_cognito_user_pools
    @aws_auth(cognito_groups: ["BESTIE", "CREATOR", "COLLAB", "ADMIN", "PRIME"])

  updateClosetItemStory(input: UpdateClosetItemStoryInput!): ClosetItem!
    @aws_cognito_user_pools
    @aws_auth(cognito_groups: ["BESTIE", "CREATOR", "COLLAB", "ADMIN", "PRIME"])

  # Fan & Bestie engagement
  likeClosetItem(itemId: ID!): ClosetItem!
    @aws_cognito_user_pools

  commentOnClosetItem(input: CommentOnClosetItemInput!): Comment!
    @aws_cognito_user_pools

  # Pinned highlights & wishlist are Bestie+ (Fans have no persistent closet/profile)
  pinHighlight(itemId: ID!): GameProfile!
    @aws_cognito_user_pools
    @aws_auth(cognito_groups: ["BESTIE", "CREATOR", "COLLAB", "ADMIN", "PRIME"])

  toggleWishlistItem(itemId: ID!): ClosetItem!
    @aws_cognito_user_pools
    @aws_auth(cognito_groups: ["BESTIE", "CREATOR", "COLLAB", "ADMIN", "PRIME"])

  # Bestie closet aliases (used by BestieCloset UI)
  bestieCreateClosetItem(input: BestieCreateClosetItemInput!): ClosetItem!
    @aws_cognito_user_pools
    @aws_auth(cognito_groups: ["BESTIE", "CREATOR", "COLLAB", "ADMIN", "PRIME"])

  bestieUpdateClosetItem(id: ID!, input: BestieUpdateClosetItemInput!): ClosetItem!
    @aws_cognito_user_pools
    @aws_auth(cognito_groups: ["BESTIE", "CREATOR", "COLLAB", "ADMIN", "PRIME"])

  bestieDeleteClosetItem(id: ID!): Boolean!
    @aws_cognito_user_pools
    @aws_auth(cognito_groups: ["BESTIE", "CREATOR", "COLLAB", "ADMIN", "PRIME"])

  # Closet admin – argument names match React GQL
  adminCreateClosetItem(input: AdminCreateClosetItemInput!): ClosetItem!
    @aws_cognito_user_pools
    @aws_auth(cognito_groups: ["ADMIN", "PRIME"])

  adminApproveItem(closetItemId: ID!): ClosetItem!
    @aws_cognito_user_pools
    @aws_auth(cognito_groups: ["ADMIN", "PRIME"])

  adminRejectItem(closetItemId: ID!, reason: String): ClosetItem!
    @aws_cognito_user_pools
    @aws_auth(cognito_groups: ["ADMIN", "PRIME"])

  adminPublishClosetItem(closetItemId: ID!): ClosetItem
    @aws_cognito_user_pools
    @aws_auth(cognito_groups: ["ADMIN", "PRIME"])

  adminSetClosetAudience(
    closetItemId: ID!
    audience: ClosetAudience!
  ): ClosetItem!
    @aws_cognito_user_pools
    @aws_auth(cognito_groups: ["ADMIN", "PRIME"])

  adminUpdateClosetItem(
    input: AdminUpdateClosetItemInput!
  ): ClosetItem!
    @aws_cognito_user_pools
    @aws_auth(cognito_groups: ["ADMIN", "PRIME"])

  # Bestie membership / billing
  startBestieCheckout: BestieCheckoutSession!
    @aws_cognito_user_pools

  claimBestieTrial: BestieStatus!
    @aws_cognito_user_pools

  adminSetBestie(userId: ID!): BestieStatus!
    @aws_cognito_user_pools
    @aws_auth(cognito_groups: ["ADMIN", "PRIME"])

  adminRevokeBestie(userId: ID!): BestieStatus!
    @aws_cognito_user_pools
    @aws_auth(cognito_groups: ["ADMIN", "PRIME"])

  adminSetBestieByEmail(email: String!): BestieStatus!
    @aws_cognito_user_pools
    @aws_auth(cognito_groups: ["ADMIN", "PRIME"])

  adminRevokeBestieByEmail(email: String!): BestieStatus!
    @aws_cognito_user_pools
    @aws_auth(cognito_groups: ["ADMIN", "PRIME"])

  # Game engine
  # (Fan vs Bestie persistence is enforced in Lambda by tier, not schema)
  logGameEvent(input: LogGameEventInput!): GameEventResult!
    @aws_cognito_user_pools

  # Spend coins to unlock an episode early (Besties will actually have coins; Fans likely won't)
  unlockEpisode(episodeId: ID!): UnlockEpisodeResult!
    @aws_cognito_user_pools

  # NOTE: aligned with lambda/game/gameplay.ts (expects input: { userId, coins, xp? })
  awardCoins(input: AwardCoinsInput!): GameProfile!
    @aws_cognito_user_pools
    @aws_auth(cognito_groups: ["ADMIN", "PRIME"])

  # Polls (aligned with lambda/game/polls.ts)
  createPoll(input: CreatePollInput!): Poll!
    @aws_cognito_user_pools
    @aws_auth(cognito_groups: ["ADMIN", "PRIME"])

  votePoll(pollId: ID!, optionIndex: Int!): Poll!
    @aws_cognito_user_pools

  # Game profile updates
  grantBadge(userId: ID!, badge: String!): GameProfile!
    @aws_cognito_user_pools
    @aws_auth(cognito_groups: ["ADMIN", "PRIME"])

  # NOTE: aligned with lambda/game/profile.ts (event.arguments.displayName)
  setDisplayName(displayName: String!): GameProfile!
    @aws_cognito_user_pools

  updateProfile(input: UpdateProfileInput!): GameProfile!
    @aws_cognito_user_pools

  # Bestie workflow: background changes / stories / feed
  requestClosetBackgroundChange(input: BgChangeRequestInput!): BgChangeRequestResult!
    @aws_cognito_user_pools
    @aws_auth(cognito_groups: ["BESTIE", "CREATOR", "COLLAB", "ADMIN", "PRIME"])

  createStory(input: CreateStoryInput!): Story!
    @aws_cognito_user_pools
    @aws_auth(cognito_groups: ["BESTIE", "CREATOR", "COLLAB", "ADMIN", "PRIME"])

  publishStory(storyId: ID!): Story!
    @aws_cognito_user_pools
    @aws_auth(cognito_groups: ["BESTIE", "CREATOR", "COLLAB", "ADMIN", "PRIME"])

  addClosetItemToCommunityFeed(itemId: ID!): ClosetItem!
    @aws_cognito_user_pools
    @aws_auth(cognito_groups: ["BESTIE", "CREATOR", "COLLAB", "ADMIN", "PRIME"])

  removeClosetItemFromCommunityFeed(itemId: ID!): ClosetItem!
    @aws_cognito_user_pools
    @aws_auth(cognito_groups: ["BESTIE", "CREATOR", "COLLAB", "ADMIN", "PRIME"])

  shareClosetItemToPinterest(itemId: ID!): ShareResult!
    @aws_cognito_user_pools
    @aws_auth(cognito_groups: ["BESTIE", "CREATOR", "COLLAB", "ADMIN", "PRIME"])

  # Creator livestream + commerce
  pinLivestreamHighlight(highlightId: ID, title: String): PinResult!
    @aws_cognito_user_pools
    @aws_auth(cognito_groups: ["CREATOR", "ADMIN", "PRIME"])

  recordAffiliateClick(itemId: ID!, source: String): AffiliateClickResult!
    @aws_cognito_user_pools
    @aws_auth(cognito_groups: ["CREATOR", "ADMIN", "PRIME"])

  # Creator AI (Mutation, with new enum / result type)
  creatorAiSuggest(
    text: String
    kind: CreatorAiSuggestionKind
  ): CreatorAiSuggestionResult!
    @aws_cognito_user_pools
    @aws_auth(cognito_groups: ["CREATOR", "ADMIN", "PRIME"])

  """
  Update the creator’s goal compass for planning + focus.
  """
  updateCreatorGoalCompass(
    input: UpdateCreatorGoalCompassInput!
  ): CreatorGoalCompass!
    @aws_cognito_user_pools
    @aws_auth(cognito_groups: ["CREATOR", "ADMIN", "PRIME"])

  # Creator filing cabinets (mutations)
  createCreatorCabinet(
    input: CreateCreatorCabinetInput!
  ): CreatorCabinet!
    @aws_cognito_user_pools
    @aws_auth(cognito_groups: ["CREATOR", "ADMIN", "PRIME"])

  updateCreatorCabinet(
    input: UpdateCreatorCabinetInput!
  ): CreatorCabinet!
    @aws_cognito_user_pools
    @aws_auth(cognito_groups: ["CREATOR", "ADMIN", "PRIME"])

  deleteCreatorCabinet(id: ID!): Boolean!
    @aws_cognito_user_pools
    @aws_auth(cognito_groups: ["CREATOR", "ADMIN", "PRIME"])

  createCreatorFolder(
    input: CreateCreatorFolderInput!
  ): CreatorFolder!
    @aws_cognito_user_pools
    @aws_auth(cognito_groups: ["CREATOR", "ADMIN", "PRIME"])

  renameCreatorFolder(
    input: RenameCreatorFolderInput!
  ): CreatorFolder!
    @aws_cognito_user_pools
    @aws_auth(cognito_groups: ["CREATOR", "ADMIN", "PRIME"])

  deleteCreatorFolder(
    id: ID!
    cabinetId: ID!
  ): Boolean!
    @aws_cognito_user_pools
    @aws_auth(cognito_groups: ["CREATOR", "ADMIN", "PRIME"])

  """
  Returns a one-time signed URL for uploading a photo/video into a cabinet,
  plus the asset record that will represent it.
  """
  createCreatorAssetUpload(
    input: CreateCreatorAssetUploadInput!
  ): CreatorUploadUrl!
    @aws_cognito_user_pools
    @aws_auth(cognito_groups: ["CREATOR", "ADMIN", "PRIME"])

  updateCreatorAsset(
    input: UpdateCreatorAssetInput!
  ): CreatorAsset!
    @aws_cognito_user_pools
    @aws_auth(cognito_groups: ["CREATOR", "ADMIN", "PRIME"])

  deleteCreatorAsset(
    id: ID!
    cabinetId: ID!
  ): Boolean!
    @aws_cognito_user_pools
    @aws_auth(cognito_groups: ["CREATOR", "ADMIN", "PRIME"])

  moveCreatorAsset(
    input: MoveCreatorAssetInput!
  ): CreatorAsset!
    @aws_cognito_user_pools
    @aws_auth(cognito_groups: ["CREATOR", "ADMIN", "PRIME"])

  """
  Import an existing Bestie closet item as a creator asset.
  Does not modify the original closet item.
  """
  importClosetItemToCabinet(
    input: ImportClosetItemToCabinetInput!
  ): CreatorAsset!
    @aws_cognito_user_pools
    @aws_auth(cognito_groups: ["BESTIE", "CREATOR", "ADMIN", "PRIME"])

  """
  Hard moderation: set status to ACTIVE / REJECTED / INAPPROPRIATE / SOFT_DELETED
  and optionally attach a reason + extra tags.
  """
  adminModerateCreatorAsset(
    input: AdminModerateCreatorAssetInput!
  ): CreatorAsset!
    @aws_cognito_user_pools
    @aws_auth(cognito_groups: ["ADMIN", "PRIME"])

  """
  Convenience: mark asset as SOFT_DELETED but keep record around.
  """
  adminSoftDeleteCreatorAsset(
    input: AdminSoftDeleteCreatorAssetInput!
  ): CreatorAsset!
    @aws_cognito_user_pools
    @aws_auth(cognito_groups: ["ADMIN", "PRIME"])

  """
  Convenience: flip SOFT_DELETED → ACTIVE again.
  """
  adminRestoreCreatorAsset(
    input: AdminRestoreCreatorAssetInput!
  ): CreatorAsset!
    @aws_cognito_user_pools
    @aws_auth(cognito_groups: ["ADMIN", "PRIME"])

  """
  Convenience wrapper: tag as REJECTED with reason/tags.
  """
  adminRejectCreatorAsset(
    input: AdminRejectCreatorAssetInput!
  ): CreatorAsset!
    @aws_cognito_user_pools
    @aws_auth(cognito_groups: ["ADMIN", "PRIME"])

  # Game economy config / rules (admin)
  updateGameEconomyConfig(input: UpdateGameEconomyConfigInput!): GameEconomyConfig!
    @aws_cognito_user_pools
    @aws_auth(cognito_groups: ["ADMIN", "PRIME"])

  # Episodes admin (admin-only)
  adminCreateEpisode(input: AdminCreateEpisodeInput!): Episode!
    @aws_cognito_user_pools
    @aws_auth(cognito_groups: ["ADMIN", "PRIME"])

  adminUpdateEpisode(episodeId: ID!, input: AdminUpdateEpisodeInput!): Episode!
    @aws_cognito_user_pools
    @aws_auth(cognito_groups: ["ADMIN", "PRIME"])

  # Admin Settings
  updateAdminSettings(input: AdminSettingsInput!): AdminSettings!
    @aws_cognito_user_pools
    @aws_auth(cognito_groups: ["ADMIN", "PRIME"])
}

# ─────────────────────────────────────────
# Admin Settings Types
# ─────────────────────────────────────────

type AdminSettings {
  animationsEnabled: Boolean!
  soundsEnabled: Boolean!
  autoBadgeGrant: Boolean!
  badgeRules: [BadgeRule!]!
}

type BadgeRule {
  id: ID!
  label: String!
  trigger: String!
}

input AdminSettingsInput {
  animationsEnabled: Boolean
  soundsEnabled: Boolean
  autoBadgeGrant: Boolean
  badgeRules: [BadgeRuleInput!]
}

input BadgeRuleInput {
  id: ID!
  label: String!
  trigger: String!
}

# ─────────────────────────────────────────
# Game economy configuration / rules
# ─────────────────────────────────────────

"""
Single game rule describing how coins are earned or spent,
plus optional JSON metadata to tune behavior.
"""
type GameRule {
  id: ID!
  category: String!
  label: String!
  description: String
  coins: Int!
  per: String
  maxPerDay: Int
  meta: AWSJSON
}

"""
Top-level economy config used by admin + fan-facing rules + overview.
"""
type GameEconomyConfig {
  id: ID!
  version: Int!
  updatedAt: AWSDateTime
  updatedBy: String

  # Global economy knobs
  coinToUsdRatio: Float
  dailyCoinCap: Int
  weeklyCoinCap: Int
  monthlyBonusEventsLimit: Int

  # Rule list
  rules: [GameRule!]!

  # Optional freeform notes for admins
  notes: String
}

input GameRuleInput {
  id: ID
  category: String!
  label: String!
  description: String
  coins: Int!
  per: String
  maxPerDay: Int
  meta: AWSJSON
}

input UpdateGameEconomyConfigInput {
  coinToUsdRatio: Float
  dailyCoinCap: Int
  weeklyCoinCap: Int
  monthlyBonusEventsLimit: Int
  rules: [GameRuleInput!]!
  notes: String
}

# ─────────────────────────────────────────
# Core / Auth
# ─────────────────────────────────────────

type Me {
  id: ID!
  email: String!
  role: String!
  tier: String!
}

type RoleResult {
  userId: ID!
  role: String!
}

# ─────────────────────────────────────────
# Closet enums
# ─────────────────────────────────────────

enum ClosetAudience {
  PUBLIC
  BESTIES
  EXCLUSIVE
}

enum ClosetVisibility {
  PRIVATE
  BESTIE
  PUBLIC
}

enum ClosetStatus {
  PENDING
  APPROVED
  PUBLISHED
  REJECTED
}

enum ClosetFeedSort {
  NEWEST
  MOST_LOVED
  LALAS_PICK
  MY_FAVES
}

# ─────────────────────────────────────────
# Closet core types
# ─────────────────────────────────────────

type ClosetItem {
  id: ID!
  ownerId: ID
  ownerSub: ID
  title: String
  mediaKey: String
  rawMediaKey: String
  category: String
  subcategory: String
  colorTags: [String!]
  season: String
  vibes: String
  notes: String
  visibility: ClosetVisibility!
  affiliateUrl: String
  episodeIds: [ID!]
  status: ClosetStatus!
  audience: ClosetAudience
  pinned: Boolean
  favoriteCount: Int
  coinValue: Int
  backgroundStatus: String
  scheduledAt: AWSDateTime
  createdAt: AWSDateTime
  updatedAt: AWSDateTime
}

type ClosetConnection {
  items: [ClosetItem!]!
  nextToken: String
}

# ─────────────────────────────────────────
# Closet inputs – fan / bestie
# ─────────────────────────────────────────

input CreateClosetItemInput {
  title: String
  mediaKey: String
  rawMediaKey: String
  category: String
  subcategory: String
  colorTags: [String!]
  season: String
  vibes: String
  notes: String
  visibility: ClosetVisibility
  affiliateUrl: String
  episodeIds: [ID!]
}

input UpdateClosetItemStoryInput {
  itemId: ID!
  storyId: ID
  storyPosition: Int
}

input CommentOnClosetItemInput {
  itemId: ID!
  text: String!
}

input BestieCreateClosetItemInput {
  title: String
  mediaKey: String
  rawMediaKey: String
  category: String
  subcategory: String
  colorTags: [String!]
  season: String
  vibes: String
  notes: String
  visibility: ClosetVisibility
  affiliateUrl: String
  episodeIds: [ID!]
}

input BestieUpdateClosetItemInput {
  title: String
  mediaKey: String
  rawMediaKey: String
  category: String
  subcategory: String
  colorTags: [String!]
  season: String
  vibes: String
  notes: String
  visibility: ClosetVisibility
  affiliateUrl: String
  episodeIds: [ID!]
}

# ─────────────────────────────────────────
# Closet inputs – admin
# ─────────────────────────────────────────

input AdminCreateClosetItemInput {
  ownerId: ID
  title: String
  mediaKey: String
  rawMediaKey: String
  category: String
  subcategory: String
  colorTags: [String!]
  season: String
  vibes: String
  notes: String
  visibility: ClosetVisibility
  affiliateUrl: String
  episodeIds: [ID!]
  status: ClosetStatus
  audience: ClosetAudience
  pinned: Boolean
  coinValue: Int
  backgroundStatus: String
}

input AdminUpdateClosetItemInput {
  id: ID!
  ownerId: ID
  title: String
  mediaKey: String
  rawMediaKey: String
  category: String
  subcategory: String
  colorTags: [String!]
  season: String
  vibes: String
  notes: String
  visibility: ClosetVisibility
  affiliateUrl: String
  episodeIds: [ID!]
  status: ClosetStatus
  audience: ClosetAudience
  pinned: Boolean
  coinValue: Int
  backgroundStatus: String
  scheduledAt: AWSDateTime
}

type Comment {
  id: ID!
  itemId: ID!
  userId: ID!
  text: String!
  createdAt: AWSDateTime!
}

type CommentConnection {
  items: [Comment!]!
  nextToken: String
}

type Like {
  itemId: ID!
  userId: ID!
  createdAt: AWSDateTime!
}

type LikeConnection {
  items: [Like!]!
  nextToken: String
}

# ─────────────────────────────────────────
# Episodes / Bestie access
# ─────────────────────────────────────────

enum EpisodeStatus {
  DRAFT
  SCHEDULED
  PUBLISHED
}

type ThumbnailImage {
  key: String!
  primary: Boolean!
}

type Episode {
  id: ID!
  title: String!
  season: Int
  episodeNumber: Int
  showId: String
  shortDescription: String
  fullDescription: String
  status: EpisodeStatus!
  publicAt: String!
  durationSeconds: Int
  unlockCoinCost: Int
  chatEnabled: Boolean!
  thumbnails: [ThumbnailImage!]!
  outfitsLinkedCount: Int
}

type EpisodeAdminConnection {
  items: [Episode!]!
  nextToken: String
}

type EpisodeAccess {
  episodeId: ID!
  isEarly: Boolean!
  reason: String
}

type EpisodeUnlock {
  episodeId: ID!
  unlockedAt: String!
  costCoins: Int!
  source: String
  episode: Episode
}

type UnlockEpisodeResult {
  success: Boolean!
  unlockedAt: String!
  costCoins: Int!
  episode: Episode!
  remainingCoins: Int!
}

type BestieStatus {
  userId: ID!
  isBestie: Boolean!
  tier: String
  renewsAt: AWSDateTime
  trialActive: Boolean
  trialEndsAt: AWSDateTime
}

type BestieCheckoutSession {
  checkoutUrl: String!
}

input AdminCreateEpisodeInput {
  id: ID
  title: String!
  season: Int
  episodeNumber: Int
  showId: String
  shortDescription: String
  fullDescription: String
  status: EpisodeStatus!
  publicAt: String!
  durationSeconds: Int
  unlockCoinCost: Int
  chatEnabled: Boolean = true
  thumbnails: [ThumbnailImageInput!]
}

input AdminUpdateEpisodeInput {
  title: String
  season: Int
  episodeNumber: Int
  showId: String
  shortDescription: String
  fullDescription: String
  status: EpisodeStatus
  publicAt: String
  durationSeconds: Int
  unlockCoinCost: Int
  chatEnabled: Boolean
  thumbnails: [ThumbnailImageInput!]
}

input ThumbnailImageInput {
  key: String!
  primary: Boolean!
}

input BgChangeRequestInput {
  itemId: ID!
  newBackgroundKey: String!
  notes: String
}

type BgChangeRequestResult {
  ok: Boolean!
  requestId: ID
}

# ─────────────────────────────────────────
# Bestie Stories
# ─────────────────────────────────────────

enum BestieStoryStatus {
  DRAFT
  SCHEDULED
  PUBLISHED
  ARCHIVED
}

type BestieStory {
  id: ID!
  title: String!
  body: String
  createdAt: AWSDateTime!
  updatedAt: AWSDateTime
  status: BestieStoryStatus!
  episodeId: ID
  closetItemIds: [ID!]
  mediaKeys: [String!]
}

type BestieStoryConnection {
  items: [BestieStory!]!
  nextToken: String
}

type Story {
  id: ID!
  ownerId: ID!
  title: String
  status: String
  createdAt: AWSDateTime
  publishedAt: AWSDateTime
}

input CreateStoryInput {
  title: String!
  closetItemIds: [ID!]
}

type ShareResult {
  ok: Boolean!
  url: String
}

# ─────────────────────────────────────────
# Fans / Game types
# ─────────────────────────────────────────

type GameProfile {
  userId: ID!
  displayName: String
  level: Int!
  xp: Int!
  coins: Int!
  badges: [String!]!
  avatarUrl: String
  bio: String
  lastEventAt: AWSDateTime
  streakCount: Int
  lastLoginAt: AWSDateTime
  pinnedClosetItems: [ClosetItem!]!
}

type GameEventResult {
  success: Boolean!
  xp: Int
  coins: Int
  newXP: Int
  newCoins: Int
  lastEventAt: AWSDateTime
}

type LeaderboardEntry {
  userId: ID!
  displayName: String
  xp: Int
  coins: Int
  rank: Int!
}

input LogGameEventInput {
  type: String!
  metadata: AWSJSON
}

input AwardCoinsInput {
  userId: ID!
  coins: Int!
  xp: Int
}

input UpdateProfileInput {
  displayName: String
  avatarUrl: String
  bio: String
}

# ─────────────────────────────────────────
# Polls
# ─────────────────────────────────────────

type Poll {
  pollId: ID!
  question: String!
  options: [String!]!
  totals: [Int!]!
  createdBy: String
  createdAt: AWSDateTime
}

input CreatePollInput {
  question: String!
  options: [String!]!
}

# ─────────────────────────────────────────
# Creator / Livestream / Commerce / AI + Cabinets
# ─────────────────────────────────────────

type CreatorLivestreamInfo {
  channelArn: String
  playbackUrl: String
  isLive: Boolean!
}

type CreatorRevenueSummary {
  periodStart: AWSDateTime
  periodEnd: AWSDateTime
  currency: String!
  totalRevenue: Float!
  totalOrders: Int!
}

enum CreatorRevenueWindow {
  LAST_7_DAYS
  LAST_30_DAYS
  LAST_90_DAYS
}

type CreatorPlatformRevenue {
  platform: String!
  label: String
  currency: String!
  amount: Float!
  lastPayoutAt: AWSDateTime
}

type CreatorRevenueTimeseriesPoint {
  date: AWSDate!
  totalRevenue: Float!
}

type CreatorRevenueByPlatform {
  currency: String!
  totalRevenue: Float!
  platforms: [CreatorPlatformRevenue!]!
  timeseries: [CreatorRevenueTimeseriesPoint!]!
}

enum CreatorAiSuggestionKind {
  CAPTION
  HASHTAGS
  OTHER
}

type CreatorAiSuggestionResult {
  suggestions: [String!]!
}

enum CreatorAssetKind {
  PHOTO
  VIDEO
  OTHER
}

"""
Creator goal-setting compass for planning content & business focus.
Backed by string codes for flexibility.
"""
type CreatorGoalCompass {
  primaryGoal: String!
  timeHorizon: String!
  weeklyCapacity: Int!
  focusAreas: [String!]!
  riskTolerance: String!
  notes: String
  updatedAt: AWSDateTime
}

input UpdateCreatorGoalCompassInput {
  primaryGoal: String!
  timeHorizon: String!
  weeklyCapacity: Int!
  focusAreas: [String!]!
  riskTolerance: String!
  notes: String
}

"""
Admin moderation state for creator assets.
"""
enum CreatorAssetModerationStatus {
  ACTIVE
  REJECTED
  INAPPROPRIATE
  SOFT_DELETED
}

"""
High-level category for creator content.
"""
enum CreatorCabinetCategory {
  OUTFIT_REFS
  EPISODE_BTS
  STORYBOARD
  BRIEF
  SPONSOR_ASSETS
  THUMBNAILS
  OTHER
}

type CreatorCabinet {
  id: ID!
  ownerSub: ID!
  name: String!
  description: String
  defaultCategory: CreatorCabinetCategory
  tags: [String!]
  assetCount: Int!
  createdAt: AWSDateTime!
  updatedAt: AWSDateTime!
}

type CreatorFolder {
  id: ID!
  cabinetId: ID!
  name: String!
  specialKind: String
  createdAt: AWSDateTime!
  updatedAt: AWSDateTime!
}

type CreatorAsset {
  id: ID!
  cabinetId: ID!
  folderId: ID
  ownerSub: ID!
  kind: CreatorAssetKind!
  category: CreatorCabinetCategory
  title: String
  notes: String
  tags: [String!]
  s3Key: String!
  contentType: String
  createdAt: AWSDateTime!
  updatedAt: AWSDateTime!

  # NEW moderation/admin fields:
  moderationStatus: CreatorAssetModerationStatus!   # default ACTIVE
  moderationReason: String
  moderatedBy: String
  moderatedAt: AWSDateTime

  # If this asset was imported from a Bestie closet item
  sourceClosetItemId: ID
}

type CreatorAssetConnection {
  items: [CreatorAsset!]!
  nextToken: String
}

type CreatorUploadUrl {
  uploadUrl: String!
  asset: CreatorAsset!
}

input CreateCreatorCabinetInput {
  name: String!
  description: String
  defaultCategory: CreatorCabinetCategory
  tags: [String!]
}

input UpdateCreatorCabinetInput {
  id: ID!
  name: String
  description: String
  defaultCategory: CreatorCabinetCategory
  tags: [String!]
}

input CreateCreatorFolderInput {
  cabinetId: ID!
  name: String!
}

input RenameCreatorFolderInput {
  id: ID!
  cabinetId: ID!
  name: String!
}

input CreateCreatorAssetUploadInput {
  cabinetId: ID!
  folderId: ID
  fileName: String!
  contentType: String!
  kind: CreatorAssetKind!
  category: CreatorCabinetCategory
  title: String
  notes: String
  tags: [String!]
}

input UpdateCreatorAssetInput {
  id: ID!
  cabinetId: ID!
  folderId: ID
  category: CreatorCabinetCategory
  title: String
  notes: String
  tags: [String!]
}

input MoveCreatorAssetInput {
  id: ID!
  cabinetId: ID!
  destinationFolderId: ID
}

input ImportClosetItemToCabinetInput {
  closetItemId: ID!
  cabinetId: ID!
  folderId: ID
  kind: CreatorAssetKind
  title: String
  notes: String
  tags: [String!]
}

input AdminModerateCreatorAssetInput {
  cabinetId: ID!
  id: ID!
  moderationStatus: CreatorAssetModerationStatus!
  moderationReason: String
  tags: [String!]
}

input AdminSoftDeleteCreatorAssetInput {
  cabinetId: ID!
  id: ID!
  reason: String
}

input AdminRestoreCreatorAssetInput {
  cabinetId: ID!
  id: ID!
}

input AdminRejectCreatorAssetInput {
  cabinetId: ID!
  id: ID!
  moderationReason: String
  tags: [String!]
}

type PinResult {
  ok: Boolean!
}

type AffiliateClickResult {
  ok: Boolean!
}

# ─────────────────────────────────────────
# Monetization HQ v2 + Director Suite (additive)
# ─────────────────────────────────────────

"""
Bucket of revenue for a single platform in Monetization HQ (v2).
This is kept separate from CreatorPlatformRevenue for flexibility.
"""
type CreatorRevenuePlatformBucket {
  platform: String!
  label: String!
  currency: String!
  amount: Float!
  lastPayoutAt: AWSDateTime
}

"""
Monetization HQ v2 result wrapper.
Shape mirrors CreatorRevenueByPlatform but uses CreatorRevenuePlatformBucket.
"""
type CreatorRevenueByPlatformResult {
  currency: String!
  totalRevenue: Float!
  platforms: [CreatorRevenuePlatformBucket!]!
  timeseries: [CreatorRevenueTimeseriesPoint!]!
}

# Note: existing Query.creatorRevenueByPlatform(window: CreatorRevenueWindow!): CreatorRevenueByPlatform
# is left as-is to avoid breaking clients. You can later change its return type to
# CreatorRevenueByPlatformResult! once the frontend is migrated.

# --- Director Suite shoot plans ---

input DirectorSceneInput {
  id: ID!
  title: String!
  shotType: String
  location: String
  mood: String
  beats: String
}

type DirectorScene {
  id: ID!
  title: String!
  shotType: String
  location: String
  mood: String
  beats: String
}

type DirectorShootPlan {
  id: ID!
  creatorId: ID!
  shootName: String!
  primaryPlatform: String!
  objective: String!
  scenes: [DirectorScene!]!
  createdAt: AWSDateTime!
  updatedAt: AWSDateTime!
}

input SaveDirectorShootPlanInput {
  id: ID
  shootName: String!
  primaryPlatform: String!
  objective: String!
  scenes: [DirectorSceneInput!]!
}

type DirectorShootPlanConnection {
  items: [DirectorShootPlan!]!
  nextToken: String
}

extend type Query {
  getDirectorShootPlan(id: ID!): DirectorShootPlan
  listDirectorShootPlans(
    limit: Int
    nextToken: String
  ): DirectorShootPlanConnection!
}

extend type Mutation {
  saveDirectorShootPlan(
    input: SaveDirectorShootPlanInput!
  ): DirectorShootPlan!
}
