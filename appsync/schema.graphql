schema {
  query: Query
  mutation: Mutation
}

# ─────────────────────────────────────────
# Root query type
# ─────────────────────────────────────────
type Query {
  # Simple healthcheck
  hello: String

  # Current user basic info
  me: Me!
    @aws_cognito_user_pools

  # Closet queries
  # Bestie+ only: Fans do not have a personal closet
  myCloset(limit: Int, nextToken: String): ClosetConnection!
    @aws_cognito_user_pools
    @aws_auth(cognito_groups: ["BESTIE", "CREATOR", "COLLAB", "ADMIN", "PRIME"])

  myWishlist(limit: Int, nextToken: String): ClosetConnection!
    @aws_cognito_user_pools
    @aws_auth(cognito_groups: ["BESTIE", "CREATOR", "COLLAB", "ADMIN", "PRIME"])

  # Bestie-only view (used by BestieCloset UI)
  bestieClosetItems(limit: Int, nextToken: String): ClosetConnection!
    @aws_cognito_user_pools
    @aws_auth(cognito_groups: ["BESTIE", "CREATOR", "COLLAB", "ADMIN", "PRIME"])

  # Comments & likes (Fans + Besties)
  closetItemComments(
    itemId: ID!
    limit: Int
    nextToken: String
  ): CommentConnection!
    @aws_cognito_user_pools

  adminClosetItemLikes(
    itemId: ID!
    limit: Int
    nextToken: String
  ): LikeConnection!
    @aws_cognito_user_pools
    @aws_auth(cognito_groups: ["ADMIN", "PRIME"])

  adminClosetItemComments(
    itemId: ID!
    limit: Int
    nextToken: String
  ): CommentConnection!
    @aws_cognito_user_pools
    @aws_auth(cognito_groups: ["ADMIN", "PRIME"])

  # Admin / feed views
  adminListPending(limit: Int, nextToken: String): ClosetConnection!
    @aws_cognito_user_pools
    @aws_auth(cognito_groups: ["ADMIN", "PRIME"])

  adminListClosetItems(
    status: ClosetStatus
    limit: Int
    nextToken: String
  ): ClosetConnection!
    @aws_cognito_user_pools
    @aws_auth(cognito_groups: ["ADMIN", "PRIME"])

  # Community feed – all signed-in users (Fans + Besties)
  closetFeed(
    sort: ClosetFeedSort
    limit: Int
    nextToken: String
  ): ClosetConnection!
    @aws_cognito_user_pools

  # Episodes / early access
  isEpisodeEarlyAccess(episodeId: ID!): EpisodeAccess!
    @aws_cognito_user_pools

  # Fan/Bestie episode unlocks
  myUnlockedEpisodes: [EpisodeUnlock!]!
    @aws_cognito_user_pools

  # Game / leaderboard
  topXP(limit: Int = 50, season: String): [LeaderboardEntry!]!
    @aws_cognito_user_pools

  topCoins(limit: Int = 50, season: String): [LeaderboardEntry!]!
    @aws_cognito_user_pools

  # Polls
  getPoll(pollId: ID!): Poll
    @aws_cognito_user_pools

  # Game profile
  getMyProfile: GameProfile!
    @aws_cognito_user_pools

  # Bestie status
  meBestieStatus: BestieStatus!
    @aws_cognito_user_pools

  # Creator / livestream & monetisation
  getCreatorLivestreamInfo: CreatorLivestreamInfo!
    @aws_cognito_user_pools
    @aws_auth(cognito_groups: ["CREATOR", "ADMIN", "PRIME"])

  creatorRevenueSummary: CreatorRevenueSummary!
    @aws_cognito_user_pools
    @aws_auth(cognito_groups: ["CREATOR", "ADMIN", "PRIME"])

  # Creator filing cabinets (personal asset library)
  creatorCabinets: [CreatorCabinet!]!
    @aws_cognito_user_pools
    @aws_auth(cognito_groups: ["CREATOR", "ADMIN", "PRIME"])

  creatorCabinet(id: ID!): CreatorCabinet
    @aws_cognito_user_pools
    @aws_auth(cognito_groups: ["CREATOR", "ADMIN", "PRIME"])

  creatorCabinetAssets(
    cabinetId: ID!
    limit: Int
    nextToken: String
  ): CreatorAssetConnection!
    @aws_cognito_user_pools
    @aws_auth(cognito_groups: ["CREATOR", "ADMIN", "PRIME"])

  # Game economy config / rules (admin)
  getGameEconomyConfig: GameEconomyConfig!
    @aws_cognito_user_pools
    @aws_auth(cognito_groups: ["ADMIN", "PRIME"])

  # Episodes admin (admin-only)
  adminListEpisodes(
    status: EpisodeStatus
    showId: String
    season: Int
    limit: Int = 20
    nextToken: String
  ): EpisodeAdminConnection!
    @aws_cognito_user_pools
    @aws_auth(cognito_groups: ["ADMIN", "PRIME"])

  # Admin Settings
  getAdminSettings: AdminSettings!
    @aws_cognito_user_pools
    @aws_auth(cognito_groups: ["ADMIN", "PRIME"])
}

# ─────────────────────────────────────────
# Root mutation type
# ─────────────────────────────────────────
type Mutation {
  # Roles
  setUserRole(userId: ID!, role: String!): RoleResult!
    @aws_cognito_user_pools
    @aws_auth(cognito_groups: ["ADMIN", "PRIME"])

  # Closet (Bestie+ core)
  # Fans cannot own a closet; they can only engage with existing items.
  createClosetItem(input: CreateClosetItemInput!): ClosetItem!
    @aws_cognito_user_pools
    @aws_auth(cognito_groups: ["BESTIE", "CREATOR", "COLLAB", "ADMIN", "PRIME"])

  requestClosetApproval(itemId: ID!): ClosetItem!
    @aws_cognito_user_pools
    @aws_auth(cognito_groups: ["BESTIE", "CREATOR", "COLLAB", "ADMIN", "PRIME"])

  updateClosetMediaKey(itemId: ID!, mediaKey: String!): ClosetItem!
    @aws_cognito_user_pools
    @aws_auth(cognito_groups: ["BESTIE", "CREATOR", "COLLAB", "ADMIN", "PRIME"])

  updateClosetItemStory(input: UpdateClosetItemStoryInput!): ClosetItem!
    @aws_cognito_user_pools
    @aws_auth(cognito_groups: ["BESTIE", "CREATOR", "COLLAB", "ADMIN", "PRIME"])

  # Fan & Bestie engagement
  likeClosetItem(itemId: ID!): ClosetItem!
    @aws_cognito_user_pools

  commentOnClosetItem(input: CommentOnClosetItemInput!): Comment!
    @aws_cognito_user_pools

  # Pinned highlights & wishlist are Bestie+ (Fans have no persistent closet/profile)
  pinHighlight(itemId: ID!): GameProfile!
    @aws_cognito_user_pools
    @aws_auth(cognito_groups: ["BESTIE", "CREATOR", "COLLAB", "ADMIN", "PRIME"])

  toggleWishlistItem(itemId: ID!): ClosetItem!
    @aws_cognito_user_pools
    @aws_auth(cognito_groups: ["BESTIE", "CREATOR", "COLLAB", "ADMIN", "PRIME"])

  # Bestie closet aliases (used by BestieCloset UI)
  bestieCreateClosetItem(input: BestieCreateClosetItemInput!): ClosetItem!
    @aws_cognito_user_pools
    @aws_auth(cognito_groups: ["BESTIE", "CREATOR", "COLLAB", "ADMIN", "PRIME"])

  bestieUpdateClosetItem(id: ID!, input: BestieUpdateClosetItemInput!): ClosetItem!
    @aws_cognito_user_pools
    @aws_auth(cognito_groups: ["BESTIE", "CREATOR", "COLLAB", "ADMIN", "PRIME"])

  bestieDeleteClosetItem(id: ID!): Boolean!
    @aws_cognito_user_pools
    @aws_auth(cognito_groups: ["BESTIE", "CREATOR", "COLLAB", "ADMIN", "PRIME"])

  # Closet admin – argument names match React GQL
  adminCreateClosetItem(input: AdminCreateClosetItemInput!): ClosetItem!
    @aws_cognito_user_pools
    @aws_auth(cognito_groups: ["ADMIN", "PRIME"])

  adminApproveItem(closetItemId: ID!): ClosetItem!
    @aws_cognito_user_pools
    @aws_auth(cognito_groups: ["ADMIN", "PRIME"])

  adminRejectItem(closetItemId: ID!, reason: String): ClosetItem!
    @aws_cognito_user_pools
    @aws_auth(cognito_groups: ["ADMIN", "PRIME"])

  adminPublishClosetItem(closetItemId: ID!): ClosetItem
    @aws_cognito_user_pools
    @aws_auth(cognito_groups: ["ADMIN", "PRIME"])

  adminSetClosetAudience(
    closetItemId: ID!
    audience: ClosetAudience!
  ): ClosetItem!
    @aws_cognito_user_pools
    @aws_auth(cognito_groups: ["ADMIN", "PRIME"])

  adminUpdateClosetItem(
    input: AdminUpdateClosetItemInput!
  ): ClosetItem!
    @aws_cognito_user_pools
    @aws_auth(cognito_groups: ["ADMIN", "PRIME"])

  # Bestie membership / billing
  startBestieCheckout: BestieCheckoutSession!
    @aws_cognito_user_pools

  claimBestieTrial: BestieStatus!
    @aws_cognito_user_pools

  adminSetBestie(userId: ID!): BestieStatus!
    @aws_cognito_user_pools
    @aws_auth(cognito_groups: ["ADMIN", "PRIME"])

  adminRevokeBestie(userId: ID!): BestieStatus!
    @aws_cognito_user_pools
    @aws_auth(cognito_groups: ["ADMIN", "PRIME"])

  adminSetBestieByEmail(email: String!): BestieStatus!
    @aws_cognito_user_pools
    @aws_auth(cognito_groups: ["ADMIN", "PRIME"])

  adminRevokeBestieByEmail(email: String!): BestieStatus!
    @aws_cognito_user_pools
    @aws_auth(cognito_groups: ["ADMIN", "PRIME"])

  # Game engine
  # (Fan vs Bestie persistence is enforced in Lambda by tier, not schema)
  logGameEvent(input: LogGameEventInput!): GameEventResult!
    @aws_cognito_user_pools

  # Spend coins to unlock an episode early (Besties will actually have coins; Fans likely won't)
  unlockEpisode(episodeId: ID!): UnlockEpisodeResult!
    @aws_cognito_user_pools

  # NOTE: aligned with lambda/game/gameplay.ts (expects input: { userId, coins, xp? })
  awardCoins(input: AwardCoinsInput!): GameProfile!
    @aws_cognito_user_pools
    @aws_auth(cognito_groups: ["ADMIN", "PRIME"])

  # Polls (aligned with lambda/game/polls.ts)
  createPoll(input: CreatePollInput!): Poll!
    @aws_cognito_user_pools
    @aws_auth(cognito_groups: ["ADMIN", "PRIME"])

  votePoll(pollId: ID!, optionIndex: Int!): Poll!
    @aws_cognito_user_pools

  # Game profile updates
  grantBadge(userId: ID!, badge: String!): GameProfile!
    @aws_cognito_user_pools
    @aws_auth(cognito_groups: ["ADMIN", "PRIME"])

  # NOTE: aligned with lambda/game/profile.ts (event.arguments.displayName)
  setDisplayName(displayName: String!): GameProfile!
    @aws_cognito_user_pools

  updateProfile(input: UpdateProfileInput!): GameProfile!
    @aws_cognito_user_pools

  # Bestie workflow: background changes / stories / feed
  requestClosetBackgroundChange(input: BgChangeRequestInput!): BgChangeRequestResult!
    @aws_cognito_user_pools
    @aws_auth(cognito_groups: ["BESTIE", "CREATOR", "COLLAB", "ADMIN", "PRIME"])

  createStory(input: CreateStoryInput!): Story!
    @aws_cognito_user_pools
    @aws_auth(cognito_groups: ["BESTIE", "CREATOR", "COLLAB", "ADMIN", "PRIME"])

  publishStory(storyId: ID!): Story!
    @aws_cognito_user_pools
    @aws_auth(cognito_groups: ["BESTIE", "CREATOR", "COLLAB", "ADMIN", "PRIME"])

  addClosetItemToCommunityFeed(itemId: ID!): ClosetItem!
    @aws_cognito_user_pools
    @aws_auth(cognito_groups: ["BESTIE", "CREATOR", "COLLAB", "ADMIN", "PRIME"])

  removeClosetItemFromCommunityFeed(itemId: ID!): ClosetItem!
    @aws_cognito_user_pools
    @aws_auth(cognito_groups: ["BESTIE", "CREATOR", "COLLAB", "ADMIN", "PRIME"])

  shareClosetItemToPinterest(itemId: ID!): ShareResult!
    @aws_cognito_user_pools
    @aws_auth(cognito_groups: ["BESTIE", "CREATOR", "COLLAB", "ADMIN", "PRIME"])

  # Creator livestream + commerce
  pinLivestreamHighlight(highlightId: ID, title: String): PinResult!
    @aws_cognito_user_pools
    @aws_auth(cognito_groups: ["CREATOR", "ADMIN", "PRIME"])

  recordAffiliateClick(itemId: ID!, source: String): AffiliateClickResult!
    @aws_cognito_user_pools
    @aws_auth(cognito_groups: ["CREATOR", "ADMIN", "PRIME"])

  # Creator AI (now as Mutation, with new enum / result type)
  creatorAiSuggest(
    text: String
    kind: CreatorAiSuggestionKind
  ): CreatorAiSuggestionResult!
    @aws_cognito_user_pools
    @aws_auth(cognito_groups: ["CREATOR", "ADMIN", "PRIME"])

  # Creator filing cabinets (mutations)
  createCreatorCabinet(
    input: CreateCreatorCabinetInput!
  ): CreatorCabinet!
    @aws_cognito_user_pools
    @aws_auth(cognito_groups: ["CREATOR", "ADMIN", "PRIME"])

  updateCreatorCabinet(
    input: UpdateCreatorCabinetInput!
  ): CreatorCabinet!
    @aws_cognito_user_pools
    @aws_auth(cognito_groups: ["CREATOR", "ADMIN", "PRIME"])

  deleteCreatorCabinet(id: ID!): Boolean!
    @aws_cognito_user_pools
    @aws_auth(cognito_groups: ["CREATOR", "ADMIN", "PRIME"])

  """
  Returns a one-time signed URL for uploading a photo/video into a cabinet,
  plus the asset record that will represent it.
  """
  createCreatorAssetUpload(
    input: CreateCreatorAssetUploadInput!
  ): CreatorUploadUrl!
    @aws_cognito_user_pools
    @aws_auth(cognito_groups: ["CREATOR", "ADMIN", "PRIME"])

  # Game economy config / rules (admin)
  updateGameEconomyConfig(input: UpdateGameEconomyConfigInput!): GameEconomyConfig!
    @aws_cognito_user_pools
    @aws_auth(cognito_groups: ["ADMIN", "PRIME"])

  # Episodes admin (admin-only)
  adminCreateEpisode(input: AdminCreateEpisodeInput!): Episode!
    @aws_cognito_user_pools
    @aws_auth(cognito_groups: ["ADMIN", "PRIME"])

  adminUpdateEpisode(episodeId: ID!, input: AdminUpdateEpisodeInput!): Episode!
    @aws_cognito_user_pools
    @aws_auth(cognito_groups: ["ADMIN", "PRIME"])

  # Admin Settings
  updateAdminSettings(input: AdminSettingsInput!): AdminSettings!
    @aws_cognito_user_pools
    @aws_auth(cognito_groups: ["ADMIN", "PRIME"])
}

# ─────────────────────────────────────────
# Admin Settings Types
# ─────────────────────────────────────────

type AdminSettings {
  animationsEnabled: Boolean!
  soundsEnabled: Boolean!
  autoBadgeGrant: Boolean!
  badgeRules: [BadgeRule!]!
}

type BadgeRule {
  id: ID!
  label: String!
  trigger: String! # stored as string; client evals it
}

input AdminSettingsInput {
  animationsEnabled: Boolean
  soundsEnabled: Boolean
  autoBadgeGrant: Boolean
  badgeRules: [BadgeRuleInput!]
}

input BadgeRuleInput {
  id: ID!
  label: String!
  trigger: String!
}

# ─────────────────────────────────────────
# Game economy configuration / rules
# ─────────────────────────────────────────

"""
Single game rule describing how coins are earned or spent,
plus optional JSON metadata to tune behavior.
"""
type GameRule {
  id: ID!
  category: String!       # e.g. WATCH_TIME, CHAT, TRIVIA, STREAK, SOCIAL, EVENT, REDEMPTION
  label: String!          # e.g. "Watch 10 minutes"
  description: String
  coins: Int!             # positive = reward, negative = cost
  per: String             # e.g. PER_10_MIN, PER_DAY, PER_EVENT
  maxPerDay: Int
  meta: AWSJSON
}

"""
Top-level economy config used by admin + fan-facing rules + overview.
"""
type GameEconomyConfig {
  id: ID!
  version: Int!
  updatedAt: AWSDateTime
  updatedBy: String

  # Global economy knobs
  coinToUsdRatio: Float
  dailyCoinCap: Int
  weeklyCoinCap: Int
  monthlyBonusEventsLimit: Int

  # Rule list
  rules: [GameRule!]!

  # Optional freeform notes for admins
  notes: String
}

input GameRuleInput {
  id: ID
  category: String!
  label: String!
  description: String
  coins: Int!
  per: String
  maxPerDay: Int
  meta: AWSJSON
}

input UpdateGameEconomyConfigInput {
  coinToUsdRatio: Float
  dailyCoinCap: Int
  weeklyCoinCap: Int
  monthlyBonusEventsLimit: Int
  rules: [GameRuleInput!]!
  notes: String
}

# ─────────────────────────────────────────
# Core / Auth
# ─────────────────────────────────────────

type Me {
  id: ID!
  email: String!
  role: String!
  tier: String!
}

type RoleResult {
  userId: ID!
  role: String!
}

# ─────────────────────────────────────────
# Closet enums
# ─────────────────────────────────────────

# Which fans are allowed to see the look (admin-facing)
enum ClosetAudience {
  PUBLIC
  BESTIES
  EXCLUSIVE
}

# Overall visibility flags used across the app (legacy / fan-facing)
enum ClosetVisibility {
  PRIVATE
  BESTIE
  PUBLIC
}

# Moderation / lifecycle status for a closet item
enum ClosetStatus {
  PENDING
  APPROVED
  PUBLISHED
  REJECTED
}

# Sorting for the fan Closet feed
enum ClosetFeedSort {
  NEWEST
  MOST_LOVED
  LALAS_PICK
  MY_FAVES
}

# ─────────────────────────────────────────
# Closet core types
# ─────────────────────────────────────────

type ClosetItem {
  id: ID!
  ownerId: ID
  # admin-set owner (creator / lala / bestie)
  ownerSub: ID
  # legacy ID used in some queries
  title: String
  mediaKey: String
  rawMediaKey: String
  category: String
  subcategory: String
  colorTags: [String!]
  season: String
  # short vibe / mood label from admin (e.g. "Date night", "Cozy Sunday")
  vibes: String
  notes: String
  visibility: ClosetVisibility!
  affiliateUrl: String
  # Link this closet item to one or more episodes
  # (episodes where the outfit appears / is featured)
  episodeIds: [ID!]
  # Game / moderation metadata
  status: ClosetStatus!
  # now required in practice
  audience: ClosetAudience
  pinned: Boolean
  # Lala's pick
  favoriteCount: Int
  # how many coins the item is worth
  coinValue: Int
  backgroundStatus: String
  # when this item is scheduled to go live (if applicable)
  scheduledAt: AWSDateTime
  createdAt: AWSDateTime
  updatedAt: AWSDateTime
}

type ClosetConnection {
  items: [ClosetItem!]!
  nextToken: String
}

# ─────────────────────────────────────────
# Closet inputs – fan / bestie
# ─────────────────────────────────────────

input CreateClosetItemInput {
  title: String
  mediaKey: String
  rawMediaKey: String
  category: String
  subcategory: String
  colorTags: [String!]
  season: String
  vibes: String
  notes: String
  visibility: ClosetVisibility
  affiliateUrl: String
  episodeIds: [ID!]
}

input UpdateClosetItemStoryInput {
  itemId: ID!
  storyId: ID
  storyPosition: Int
}

input CommentOnClosetItemInput {
  itemId: ID!
  text: String!
}

input BestieCreateClosetItemInput {
  title: String
  mediaKey: String
  rawMediaKey: String
  category: String
  subcategory: String
  colorTags: [String!]
  season: String
  vibes: String
  notes: String
  visibility: ClosetVisibility
  affiliateUrl: String
  episodeIds: [ID!]
}

input BestieUpdateClosetItemInput {
  title: String
  mediaKey: String
  rawMediaKey: String
  category: String
  subcategory: String
  colorTags: [String!]
  season: String
  vibes: String
  notes: String
  visibility: ClosetVisibility
  affiliateUrl: String
  episodeIds: [ID!]
}

# ─────────────────────────────────────────
# Closet inputs – admin
# ─────────────────────────────────────────

input AdminCreateClosetItemInput {
  ownerId: ID
  title: String
  mediaKey: String
  rawMediaKey: String
  category: String
  subcategory: String
  colorTags: [String!]
  season: String
  # new: matches "Vibes" field in admin upload form
  vibes: String
  notes: String
  visibility: ClosetVisibility
  affiliateUrl: String
  # Link to episodes this look appears in
  episodeIds: [ID!]
  # admin metadata
  status: ClosetStatus
  audience: ClosetAudience
  pinned: Boolean
  coinValue: Int
  backgroundStatus: String
}

input AdminUpdateClosetItemInput {
  id: ID!
  ownerId: ID
  title: String
  mediaKey: String
  rawMediaKey: String
  category: String
  subcategory: String
  colorTags: [String!]
  season: String
  vibes: String
  notes: String
  visibility: ClosetVisibility
  affiliateUrl: String
  # Link to episodes this look appears in
  episodeIds: [ID!]
  # admin metadata
  status: ClosetStatus
  audience: ClosetAudience
  pinned: Boolean
  coinValue: Int
  backgroundStatus: String
  scheduledAt: AWSDateTime
}

type Comment {
  id: ID!
  itemId: ID!
  userId: ID!
  text: String!
  createdAt: AWSDateTime!
}

type CommentConnection {
  items: [Comment!]!
  nextToken: String
}

type Like {
  itemId: ID!
  userId: ID!
  createdAt: AWSDateTime!
}

type LikeConnection {
  items: [Like!]!
  nextToken: String
}

# ─────────────────────────────────────────
# Episodes / Bestie access
# ─────────────────────────────────────────

enum EpisodeStatus {
  DRAFT
  SCHEDULED
  PUBLISHED
}

type ThumbnailImage {
  key: String!
  primary: Boolean!
}

type Episode {
  id: ID!
  title: String!
  season: Int
  episodeNumber: Int
  showId: String
  shortDescription: String
  fullDescription: String
  status: EpisodeStatus!
  publicAt: String!
  durationSeconds: Int
  unlockCoinCost: Int
  chatEnabled: Boolean!
  thumbnails: [ThumbnailImage!]!
  outfitsLinkedCount: Int
}

type EpisodeAdminConnection {
  items: [Episode!]!
  nextToken: String
}

type EpisodeAccess {
  episodeId: ID!
  isEarly: Boolean!
  reason: String
}

type EpisodeUnlock {
  episodeId: ID!
  unlockedAt: String!
  costCoins: Int!
  source: String
  episode: Episode
}

type UnlockEpisodeResult {
  success: Boolean!
  unlockedAt: String!
  costCoins: Int!
  episode: Episode!
  remainingCoins: Int!
}

type BestieStatus {
  userId: ID!
  isBestie: Boolean!
  tier: String
  renewsAt: AWSDateTime
  trialActive: Boolean
  trialEndsAt: AWSDateTime
}

type BestieCheckoutSession {
  checkoutUrl: String!
}

input AdminCreateEpisodeInput {
  id: ID
  title: String!
  season: Int
  episodeNumber: Int
  showId: String
  shortDescription: String
  fullDescription: String
  status: EpisodeStatus!          # DRAFT | SCHEDULED | PUBLISHED
  publicAt: String!               # ISO string
  durationSeconds: Int
  unlockCoinCost: Int
  chatEnabled: Boolean = true
  thumbnails: [ThumbnailImageInput!]
}

input AdminUpdateEpisodeInput {
  title: String
  season: Int
  episodeNumber: Int
  showId: String
  shortDescription: String
  fullDescription: String
  status: EpisodeStatus
  publicAt: String
  durationSeconds: Int
  unlockCoinCost: Int
  chatEnabled: Boolean
  thumbnails: [ThumbnailImageInput!]
}

input ThumbnailImageInput {
  key: String!
  primary: Boolean!
}

# Background change requests
input BgChangeRequestInput {
  itemId: ID!
  newBackgroundKey: String!
  notes: String
}

type BgChangeRequestResult {
  ok: Boolean!
  requestId: ID
}

# Stories
type Story {
  id: ID!
  ownerId: ID!
  title: String
  status: String
  createdAt: AWSDateTime
  publishedAt: AWSDateTime
}

input CreateStoryInput {
  title: String!
  closetItemIds: [ID!]
}

type ShareResult {
  ok: Boolean!
  url: String
}

# ─────────────────────────────────────────
# Fans / Game types
# ─────────────────────────────────────────

"""Per-fan game profile / XP / coins."""
type GameProfile {
  userId: ID!
  displayName: String
  level: Int!
  xp: Int!
  coins: Int!
  badges: [String!]!
  avatarUrl: String
  bio: String

  # Timestamp of last gameplay-related event
  lastEventAt: AWSDateTime

  # Daily login streak
  streakCount: Int
  lastLoginAt: AWSDateTime

  # Fan’s pinned closet items
  pinnedClosetItems: [ClosetItem!]!
}

"""Result of logging a game event."""
type GameEventResult {
  success: Boolean!

  # current XP / coins after the event
  xp: Int
  coins: Int

  # delta from this event
  newXP: Int
  newCoins: Int

  lastEventAt: AWSDateTime
}

"""Leaderboard entry for topXP / topCoins."""
type LeaderboardEntry {
  userId: ID!
  displayName: String
  xp: Int
  coins: Int
  rank: Int!
}

input LogGameEventInput {
  type: String!
  metadata: AWSJSON
}

input AwardCoinsInput {
  userId: ID!
  coins: Int!
  xp: Int
}

input UpdateProfileInput {
  displayName: String
  avatarUrl: String
  bio: String
}

# ─────────────────────────────────────────
# Polls
# ─────────────────────────────────────────

type Poll {
  pollId: ID!
  question: String!
  options: [String!]!
  totals: [Int!]!
  createdBy: String
  createdAt: AWSDateTime
}

input CreatePollInput {
  question: String!
  options: [String!]!
}

# ─────────────────────────────────────────
# Creator / Livestream / Commerce / AI + Cabinets
# ─────────────────────────────────────────

type CreatorLivestreamInfo {
  channelArn: String
  playbackUrl: String
  isLive: Boolean!
}

type CreatorRevenueSummary {
  periodStart: AWSDateTime
  periodEnd: AWSDateTime
  currency: String!
  totalRevenue: Float!
  totalOrders: Int!
}

# --- Creator AI -------------------------------------------------

enum CreatorAiSuggestionKind {
  CAPTION
  HASHTAGS
  OTHER
}

type CreatorAiSuggestionResult {
  suggestions: [String!]!
}

# --- Creator filing cabinets -----------------------------------

enum CreatorAssetKind {
  PHOTO
  VIDEO
  OTHER
}

"""
High-level category for creator content.
"""
enum CreatorCabinetCategory {
  OUTFIT_REFS        # inspiration / looks
  EPISODE_BTS        # behind-the-scenes
  STORYBOARD         # story beats / frames
  BRIEF              # brand briefs / notes
  SPONSOR_ASSETS     # brand logos, ad assets
  THUMBNAILS         # thumbnails / cover art
  OTHER
}

type CreatorCabinet {
  id: ID!
  ownerSub: ID!
  name: String!
  description: String
  defaultCategory: CreatorCabinetCategory
  assetCount: Int!
  createdAt: AWSDateTime!
  updatedAt: AWSDateTime!
}

type CreatorAsset {
  id: ID!
  cabinetId: ID!
  ownerSub: ID!
  kind: CreatorAssetKind!
  category: CreatorCabinetCategory
  title: String
  notes: String
  tags: [String!]
  s3Key: String!
  contentType: String
  createdAt: AWSDateTime!
  updatedAt: AWSDateTime!
}

type CreatorAssetConnection {
  items: [CreatorAsset!]!
  nextToken: String
}

type CreatorUploadUrl {
  uploadUrl: AWSURL!
  asset: CreatorAsset!
}

input CreateCreatorCabinetInput {
  name: String!
  description: String
  defaultCategory: CreatorCabinetCategory
}

input UpdateCreatorCabinetInput {
  id: ID!
  name: String
  description: String
  defaultCategory: CreatorCabinetCategory
}

input CreateCreatorAssetUploadInput {
  cabinetId: ID!
  fileName: String!
  contentType: String!
  kind: CreatorAssetKind!
  category: CreatorCabinetCategory
  title: String
  notes: String
  tags: [String!]
}

type PinResult {
  ok: Boolean!
}

type AffiliateClickResult {
  ok: Boolean!
}
