{
  "version": 3,
  "sources": ["../../lambda/social-pulse/persistPulse.ts", "../../node_modules/uuid/dist-node/stringify.js", "../../node_modules/uuid/dist-node/rng.js", "../../node_modules/uuid/dist-node/native.js", "../../node_modules/uuid/dist-node/v4.js"],
  "sourcesContent": ["import { DynamoDBClient } from \"@aws-sdk/client-dynamodb\";\r\nimport {\r\n  DynamoDBDocumentClient,\r\n  PutCommand,\r\n} from \"@aws-sdk/lib-dynamodb\";\r\nimport { v4 as uuid } from \"uuid\";\r\n\r\nconst ddb = DynamoDBDocumentClient.from(new DynamoDBClient({}));\r\nconst TABLE_NAME = process.env.TABLE_NAME!;\r\nconst PK = process.env.PK_NAME ?? \"pk\";\r\nconst SK = process.env.SK_NAME ?? \"sk\";\r\n\r\nexport const handler = async (event: any) => {\r\n  const {\r\n    creatorId,\r\n    niche,\r\n    platforms,\r\n    trendBriefs,\r\n    contentIdeas,\r\n  } = event;\r\n\r\n  if (!creatorId) {\r\n    throw new Error(\"Missing creatorId in Social Pulse persist\");\r\n  }\r\n\r\n  const id = uuid();\r\n  const now = new Date().toISOString();\r\n\r\n  const item = {\r\n    [PK]: `CREATOR#${creatorId}`,\r\n    [SK]: `PULSE#${id}`,\r\n    type: \"CREATOR_SOCIAL_PULSE\",\r\n\r\n    id,\r\n    creatorId,\r\n    niche,\r\n    platforms,\r\n    trendBriefs,\r\n    contentIdeas,\r\n    createdAt: now,\r\n\r\n    gsi1pk: `CREATOR#${creatorId}`,\r\n    gsi1sk: `PULSE#${now}#${id}`,\r\n  };\r\n\r\n  await ddb.send(\r\n    new PutCommand({\r\n      TableName: TABLE_NAME,\r\n      Item: item,\r\n    }),\r\n  );\r\n\r\n  // Return in GraphQL-friendly shape\r\n  return {\r\n    id,\r\n    creatorId,\r\n    niche,\r\n    platforms,\r\n    trendBriefs,\r\n    contentIdeas,\r\n    createdAt: now,\r\n  };\r\n};\r\n", "import validate from './validate.js';\nconst byteToHex = [];\nfor (let i = 0; i < 256; ++i) {\n    byteToHex.push((i + 0x100).toString(16).slice(1));\n}\nexport function unsafeStringify(arr, offset = 0) {\n    return (byteToHex[arr[offset + 0]] +\n        byteToHex[arr[offset + 1]] +\n        byteToHex[arr[offset + 2]] +\n        byteToHex[arr[offset + 3]] +\n        '-' +\n        byteToHex[arr[offset + 4]] +\n        byteToHex[arr[offset + 5]] +\n        '-' +\n        byteToHex[arr[offset + 6]] +\n        byteToHex[arr[offset + 7]] +\n        '-' +\n        byteToHex[arr[offset + 8]] +\n        byteToHex[arr[offset + 9]] +\n        '-' +\n        byteToHex[arr[offset + 10]] +\n        byteToHex[arr[offset + 11]] +\n        byteToHex[arr[offset + 12]] +\n        byteToHex[arr[offset + 13]] +\n        byteToHex[arr[offset + 14]] +\n        byteToHex[arr[offset + 15]]).toLowerCase();\n}\nfunction stringify(arr, offset = 0) {\n    const uuid = unsafeStringify(arr, offset);\n    if (!validate(uuid)) {\n        throw TypeError('Stringified UUID is invalid');\n    }\n    return uuid;\n}\nexport default stringify;\n", "import { randomFillSync } from 'node:crypto';\nconst rnds8Pool = new Uint8Array(256);\nlet poolPtr = rnds8Pool.length;\nexport default function rng() {\n    if (poolPtr > rnds8Pool.length - 16) {\n        randomFillSync(rnds8Pool);\n        poolPtr = 0;\n    }\n    return rnds8Pool.slice(poolPtr, (poolPtr += 16));\n}\n", "import { randomUUID } from 'node:crypto';\nexport default { randomUUID };\n", "import native from './native.js';\nimport rng from './rng.js';\nimport { unsafeStringify } from './stringify.js';\nfunction _v4(options, buf, offset) {\n    options = options || {};\n    const rnds = options.random ?? options.rng?.() ?? rng();\n    if (rnds.length < 16) {\n        throw new Error('Random bytes length must be >= 16');\n    }\n    rnds[6] = (rnds[6] & 0x0f) | 0x40;\n    rnds[8] = (rnds[8] & 0x3f) | 0x80;\n    if (buf) {\n        offset = offset || 0;\n        if (offset < 0 || offset + 16 > buf.length) {\n            throw new RangeError(`UUID byte range ${offset}:${offset + 15} is out of buffer bounds`);\n        }\n        for (let i = 0; i < 16; ++i) {\n            buf[offset + i] = rnds[i];\n        }\n        return buf;\n    }\n    return unsafeStringify(rnds);\n}\nfunction v4(options, buf, offset) {\n    if (native.randomUUID && !buf && !options) {\n        return native.randomUUID();\n    }\n    return _v4(options, buf, offset);\n}\nexport default v4;\n"],
  "mappings": "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",
  "names": ["persistPulse_exports", "__export", "handler", "__toCommonJS", "import_client_dynamodb", "import_lib_dynamodb", "byteToHex", "i", "unsafeStringify", "arr", "offset", "import_node_crypto", "rnds8Pool", "poolPtr", "rng", "import_node_crypto", "native_default", "_v4", "options", "buf", "offset", "rnds", "rng", "unsafeStringify", "v4", "native_default", "v4_default", "ddb", "TABLE_NAME", "PK", "SK", "handler", "event", "creatorId", "niche", "platforms", "trendBriefs", "contentIdeas", "id", "v4_default", "now", "item"]
}
