{
 "Description": "Besties closet + background change workflows - dev",
 "Resources": {
  "ImageSegmentationFnServiceRoleCA334768": {
   "Type": "AWS::IAM::Role",
   "Properties": {
    "AssumeRolePolicyDocument": {
     "Statement": [
      {
       "Action": "sts:AssumeRole",
       "Effect": "Allow",
       "Principal": {
        "Service": "lambda.amazonaws.com"
       }
      }
     ],
     "Version": "2012-10-17"
    },
    "ManagedPolicyArns": [
     {
      "Fn::Join": [
       "",
       [
        "arn:",
        {
         "Ref": "AWS::Partition"
        },
        ":iam::aws:policy/service-role/AWSLambdaBasicExecutionRole"
       ]
      ]
     }
    ],
    "Tags": [
     {
      "Key": "App",
      "Value": "stylingadventures"
     },
     {
      "Key": "Env",
      "Value": "dev"
     }
    ]
   },
   "Metadata": {
    "aws:cdk:path": "BestiesClosetStack/ImageSegmentationFn/ServiceRole/Resource"
   }
  },
  "ImageSegmentationFnServiceRoleDefaultPolicyB8F731BA": {
   "Type": "AWS::IAM::Policy",
   "Properties": {
    "PolicyDocument": {
     "Statement": [
      {
       "Action": [
        "s3:GetObject*",
        "s3:GetBucket*",
        "s3:List*"
       ],
       "Effect": "Allow",
       "Resource": [
        {
         "Fn::ImportValue": "UploadsStack:ExportsOutputFnGetAttUploadsBucket5E5E9B64Arn8603C131"
        },
        {
         "Fn::Join": [
          "",
          [
           {
            "Fn::ImportValue": "UploadsStack:ExportsOutputFnGetAttUploadsBucket5E5E9B64Arn8603C131"
           },
           "/closet/*"
          ]
         ]
        }
       ]
      },
      {
       "Action": [
        "s3:DeleteObject*",
        "s3:PutObject",
        "s3:PutObjectLegalHold",
        "s3:PutObjectRetention",
        "s3:PutObjectTagging",
        "s3:PutObjectVersionTagging",
        "s3:Abort*"
       ],
       "Effect": "Allow",
       "Resource": [
        {
         "Fn::ImportValue": "UploadsStack:ExportsOutputFnGetAttUploadsBucket5E5E9B64Arn8603C131"
        },
        {
         "Fn::Join": [
          "",
          [
           {
            "Fn::ImportValue": "UploadsStack:ExportsOutputFnGetAttUploadsBucket5E5E9B64Arn8603C131"
           },
           "/closet/processed/*"
          ]
         ]
        }
       ]
      }
     ],
     "Version": "2012-10-17"
    },
    "PolicyName": "ImageSegmentationFnServiceRoleDefaultPolicyB8F731BA",
    "Roles": [
     {
      "Ref": "ImageSegmentationFnServiceRoleCA334768"
     }
    ]
   },
   "Metadata": {
    "aws:cdk:path": "BestiesClosetStack/ImageSegmentationFn/ServiceRole/DefaultPolicy/Resource"
   }
  },
  "ImageSegmentationFn0414CF98": {
   "Type": "AWS::Lambda::Function",
   "Properties": {
    "Code": {
     "ImageUri": {
      "Fn::Sub": "637423256673.dkr.ecr.us-east-1.${AWS::URLSuffix}/cdk-hnb659fds-container-assets-637423256673-us-east-1:9f03a0707686d9f612e0ee101baf0eafbf5b523a41fef1d674b875568b98151a"
     }
    },
    "Environment": {
     "Variables": {
      "UPLOADS_BUCKET_NAME": {
       "Fn::ImportValue": "UploadsStack:ExportsOutputRefUploadsBucket5E5E9B64F2F56CC2"
      },
      "PROCESSED_PREFIX": "closet/processed"
     }
    },
    "EphemeralStorage": {
     "Size": 4096
    },
    "MemorySize": 3008,
    "PackageType": "Image",
    "Role": {
     "Fn::GetAtt": [
      "ImageSegmentationFnServiceRoleCA334768",
      "Arn"
     ]
    },
    "Tags": [
     {
      "Key": "App",
      "Value": "stylingadventures"
     },
     {
      "Key": "Env",
      "Value": "dev"
     }
    ],
    "Timeout": 120
   },
   "DependsOn": [
    "ImageSegmentationFnServiceRoleDefaultPolicyB8F731BA",
    "ImageSegmentationFnServiceRoleCA334768"
   ],
   "Metadata": {
    "aws:cdk:path": "BestiesClosetStack/ImageSegmentationFn/Resource",
    "aws:asset:path": "asset.9f03a0707686d9f612e0ee101baf0eafbf5b523a41fef1d674b875568b98151a",
    "aws:asset:dockerfile-path": "Dockerfile",
    "aws:asset:property": "Code.ImageUri"
   }
  },
  "ModerationFnServiceRoleBF6ED484": {
   "Type": "AWS::IAM::Role",
   "Properties": {
    "AssumeRolePolicyDocument": {
     "Statement": [
      {
       "Action": "sts:AssumeRole",
       "Effect": "Allow",
       "Principal": {
        "Service": "lambda.amazonaws.com"
       }
      }
     ],
     "Version": "2012-10-17"
    },
    "ManagedPolicyArns": [
     {
      "Fn::Join": [
       "",
       [
        "arn:",
        {
         "Ref": "AWS::Partition"
        },
        ":iam::aws:policy/service-role/AWSLambdaBasicExecutionRole"
       ]
      ]
     }
    ],
    "Tags": [
     {
      "Key": "App",
      "Value": "stylingadventures"
     },
     {
      "Key": "Env",
      "Value": "dev"
     }
    ]
   },
   "Metadata": {
    "aws:cdk:path": "BestiesClosetStack/ModerationFn/ServiceRole/Resource"
   }
  },
  "ModerationFnServiceRoleDefaultPolicy9C9AC1C0": {
   "Type": "AWS::IAM::Policy",
   "Properties": {
    "PolicyDocument": {
     "Statement": [
      {
       "Action": [
        "dynamodb:BatchGetItem",
        "dynamodb:GetRecords",
        "dynamodb:GetShardIterator",
        "dynamodb:Query",
        "dynamodb:GetItem",
        "dynamodb:Scan",
        "dynamodb:ConditionCheckItem",
        "dynamodb:BatchWriteItem",
        "dynamodb:PutItem",
        "dynamodb:UpdateItem",
        "dynamodb:DeleteItem",
        "dynamodb:DescribeTable"
       ],
       "Effect": "Allow",
       "Resource": [
        {
         "Fn::ImportValue": "DataStack:ExportsOutputFnGetAttAppTable815C50BCArnF3D9E3C3"
        },
        {
         "Fn::Join": [
          "",
          [
           {
            "Fn::ImportValue": "DataStack:ExportsOutputFnGetAttAppTable815C50BCArnF3D9E3C3"
           },
           "/index/*"
          ]
         ]
        }
       ]
      },
      {
       "Action": [
        "s3:GetObject*",
        "s3:GetBucket*",
        "s3:List*",
        "s3:DeleteObject*",
        "s3:PutObject",
        "s3:PutObjectLegalHold",
        "s3:PutObjectRetention",
        "s3:PutObjectTagging",
        "s3:PutObjectVersionTagging",
        "s3:Abort*"
       ],
       "Effect": "Allow",
       "Resource": [
        {
         "Fn::ImportValue": "UploadsStack:ExportsOutputFnGetAttUploadsBucket5E5E9B64Arn8603C131"
        },
        {
         "Fn::Join": [
          "",
          [
           {
            "Fn::ImportValue": "UploadsStack:ExportsOutputFnGetAttUploadsBucket5E5E9B64Arn8603C131"
           },
           "/*"
          ]
         ]
        }
       ]
      }
     ],
     "Version": "2012-10-17"
    },
    "PolicyName": "ModerationFnServiceRoleDefaultPolicy9C9AC1C0",
    "Roles": [
     {
      "Ref": "ModerationFnServiceRoleBF6ED484"
     }
    ]
   },
   "Metadata": {
    "aws:cdk:path": "BestiesClosetStack/ModerationFn/ServiceRole/DefaultPolicy/Resource"
   }
  },
  "ModerationFn7E78A67D": {
   "Type": "AWS::Lambda::Function",
   "Properties": {
    "Code": {
     "S3Bucket": "cdk-hnb659fds-assets-637423256673-us-east-1",
     "S3Key": "c2920f16056fa2c537644143b6b83ed743129b90534bfd802dc05235ab2ccaed.zip"
    },
    "Environment": {
     "Variables": {
      "TABLE_NAME": {
       "Fn::ImportValue": "DataStack:ExportsOutputRefAppTable815C50BC1988FCFB"
      },
      "BUCKET_NAME": {
       "Fn::ImportValue": "UploadsStack:ExportsOutputRefUploadsBucket5E5E9B64F2F56CC2"
      },
      "NODE_OPTIONS": "--enable-source-maps"
     }
    },
    "Handler": "index.handler",
    "MemorySize": 512,
    "Role": {
     "Fn::GetAtt": [
      "ModerationFnServiceRoleBF6ED484",
      "Arn"
     ]
    },
    "Runtime": "nodejs20.x",
    "Tags": [
     {
      "Key": "App",
      "Value": "stylingadventures"
     },
     {
      "Key": "Env",
      "Value": "dev"
     }
    ],
    "Timeout": 30
   },
   "DependsOn": [
    "ModerationFnServiceRoleDefaultPolicy9C9AC1C0",
    "ModerationFnServiceRoleBF6ED484"
   ],
   "Metadata": {
    "aws:cdk:path": "BestiesClosetStack/ModerationFn/Resource",
    "aws:asset:path": "asset.c2920f16056fa2c537644143b6b83ed743129b90534bfd802dc05235ab2ccaed",
    "aws:asset:is-bundled": true,
    "aws:asset:property": "Code"
   }
  },
  "PiiCheckFnServiceRole84F31904": {
   "Type": "AWS::IAM::Role",
   "Properties": {
    "AssumeRolePolicyDocument": {
     "Statement": [
      {
       "Action": "sts:AssumeRole",
       "Effect": "Allow",
       "Principal": {
        "Service": "lambda.amazonaws.com"
       }
      }
     ],
     "Version": "2012-10-17"
    },
    "ManagedPolicyArns": [
     {
      "Fn::Join": [
       "",
       [
        "arn:",
        {
         "Ref": "AWS::Partition"
        },
        ":iam::aws:policy/service-role/AWSLambdaBasicExecutionRole"
       ]
      ]
     }
    ],
    "Tags": [
     {
      "Key": "App",
      "Value": "stylingadventures"
     },
     {
      "Key": "Env",
      "Value": "dev"
     }
    ]
   },
   "Metadata": {
    "aws:cdk:path": "BestiesClosetStack/PiiCheckFn/ServiceRole/Resource"
   }
  },
  "PiiCheckFnServiceRoleDefaultPolicy5209AB8F": {
   "Type": "AWS::IAM::Policy",
   "Properties": {
    "PolicyDocument": {
     "Statement": [
      {
       "Action": [
        "dynamodb:BatchGetItem",
        "dynamodb:GetRecords",
        "dynamodb:GetShardIterator",
        "dynamodb:Query",
        "dynamodb:GetItem",
        "dynamodb:Scan",
        "dynamodb:ConditionCheckItem",
        "dynamodb:BatchWriteItem",
        "dynamodb:PutItem",
        "dynamodb:UpdateItem",
        "dynamodb:DeleteItem",
        "dynamodb:DescribeTable"
       ],
       "Effect": "Allow",
       "Resource": [
        {
         "Fn::ImportValue": "DataStack:ExportsOutputFnGetAttAppTable815C50BCArnF3D9E3C3"
        },
        {
         "Fn::Join": [
          "",
          [
           {
            "Fn::ImportValue": "DataStack:ExportsOutputFnGetAttAppTable815C50BCArnF3D9E3C3"
           },
           "/index/*"
          ]
         ]
        }
       ]
      }
     ],
     "Version": "2012-10-17"
    },
    "PolicyName": "PiiCheckFnServiceRoleDefaultPolicy5209AB8F",
    "Roles": [
     {
      "Ref": "PiiCheckFnServiceRole84F31904"
     }
    ]
   },
   "Metadata": {
    "aws:cdk:path": "BestiesClosetStack/PiiCheckFn/ServiceRole/DefaultPolicy/Resource"
   }
  },
  "PiiCheckFnF52DF218": {
   "Type": "AWS::Lambda::Function",
   "Properties": {
    "Code": {
     "S3Bucket": "cdk-hnb659fds-assets-637423256673-us-east-1",
     "S3Key": "3bde3e9d95b60e7b775f5d71ce73b9b0b1971b69e5bbabca8e918ff4b7333ff8.zip"
    },
    "Environment": {
     "Variables": {
      "TABLE_NAME": {
       "Fn::ImportValue": "DataStack:ExportsOutputRefAppTable815C50BC1988FCFB"
      },
      "NODE_OPTIONS": "--enable-source-maps"
     }
    },
    "Handler": "index.handler",
    "MemorySize": 512,
    "Role": {
     "Fn::GetAtt": [
      "PiiCheckFnServiceRole84F31904",
      "Arn"
     ]
    },
    "Runtime": "nodejs20.x",
    "Tags": [
     {
      "Key": "App",
      "Value": "stylingadventures"
     },
     {
      "Key": "Env",
      "Value": "dev"
     }
    ],
    "Timeout": 30
   },
   "DependsOn": [
    "PiiCheckFnServiceRoleDefaultPolicy5209AB8F",
    "PiiCheckFnServiceRole84F31904"
   ],
   "Metadata": {
    "aws:cdk:path": "BestiesClosetStack/PiiCheckFn/Resource",
    "aws:asset:path": "asset.3bde3e9d95b60e7b775f5d71ce73b9b0b1971b69e5bbabca8e918ff4b7333ff8",
    "aws:asset:is-bundled": true,
    "aws:asset:property": "Code"
   }
  },
  "PublishClosetItemFnServiceRole9997268D": {
   "Type": "AWS::IAM::Role",
   "Properties": {
    "AssumeRolePolicyDocument": {
     "Statement": [
      {
       "Action": "sts:AssumeRole",
       "Effect": "Allow",
       "Principal": {
        "Service": "lambda.amazonaws.com"
       }
      }
     ],
     "Version": "2012-10-17"
    },
    "ManagedPolicyArns": [
     {
      "Fn::Join": [
       "",
       [
        "arn:",
        {
         "Ref": "AWS::Partition"
        },
        ":iam::aws:policy/service-role/AWSLambdaBasicExecutionRole"
       ]
      ]
     }
    ],
    "Tags": [
     {
      "Key": "App",
      "Value": "stylingadventures"
     },
     {
      "Key": "Env",
      "Value": "dev"
     }
    ]
   },
   "Metadata": {
    "aws:cdk:path": "BestiesClosetStack/PublishClosetItemFn/ServiceRole/Resource"
   }
  },
  "PublishClosetItemFnServiceRoleDefaultPolicy4282ADC3": {
   "Type": "AWS::IAM::Policy",
   "Properties": {
    "PolicyDocument": {
     "Statement": [
      {
       "Action": [
        "dynamodb:BatchGetItem",
        "dynamodb:GetRecords",
        "dynamodb:GetShardIterator",
        "dynamodb:Query",
        "dynamodb:GetItem",
        "dynamodb:Scan",
        "dynamodb:ConditionCheckItem",
        "dynamodb:BatchWriteItem",
        "dynamodb:PutItem",
        "dynamodb:UpdateItem",
        "dynamodb:DeleteItem",
        "dynamodb:DescribeTable"
       ],
       "Effect": "Allow",
       "Resource": [
        {
         "Fn::ImportValue": "DataStack:ExportsOutputFnGetAttAppTable815C50BCArnF3D9E3C3"
        },
        {
         "Fn::Join": [
          "",
          [
           {
            "Fn::ImportValue": "DataStack:ExportsOutputFnGetAttAppTable815C50BCArnF3D9E3C3"
           },
           "/index/*"
          ]
         ]
        }
       ]
      },
      {
       "Action": [
        "s3:GetObject*",
        "s3:GetBucket*",
        "s3:List*",
        "s3:DeleteObject*",
        "s3:PutObject",
        "s3:PutObjectLegalHold",
        "s3:PutObjectRetention",
        "s3:PutObjectTagging",
        "s3:PutObjectVersionTagging",
        "s3:Abort*"
       ],
       "Effect": "Allow",
       "Resource": [
        {
         "Fn::ImportValue": "UploadsStack:ExportsOutputFnGetAttUploadsBucket5E5E9B64Arn8603C131"
        },
        {
         "Fn::Join": [
          "",
          [
           {
            "Fn::ImportValue": "UploadsStack:ExportsOutputFnGetAttUploadsBucket5E5E9B64Arn8603C131"
           },
           "/*"
          ]
         ]
        }
       ]
      }
     ],
     "Version": "2012-10-17"
    },
    "PolicyName": "PublishClosetItemFnServiceRoleDefaultPolicy4282ADC3",
    "Roles": [
     {
      "Ref": "PublishClosetItemFnServiceRole9997268D"
     }
    ]
   },
   "Metadata": {
    "aws:cdk:path": "BestiesClosetStack/PublishClosetItemFn/ServiceRole/DefaultPolicy/Resource"
   }
  },
  "PublishClosetItemFn8BF46E04": {
   "Type": "AWS::Lambda::Function",
   "Properties": {
    "Code": {
     "S3Bucket": "cdk-hnb659fds-assets-637423256673-us-east-1",
     "S3Key": "fea5a6ff2cd4c4887afea8687d9ffd6488623ad8f4e1ce48eefa967df941ddf7.zip"
    },
    "Environment": {
     "Variables": {
      "TABLE_NAME": {
       "Fn::ImportValue": "DataStack:ExportsOutputRefAppTable815C50BC1988FCFB"
      },
      "BUCKET_NAME": {
       "Fn::ImportValue": "UploadsStack:ExportsOutputRefUploadsBucket5E5E9B64F2F56CC2"
      },
      "PUBLISHED_PREFIX": "published",
      "NODE_OPTIONS": "--enable-source-maps"
     }
    },
    "Handler": "index.handler",
    "MemorySize": 1024,
    "Role": {
     "Fn::GetAtt": [
      "PublishClosetItemFnServiceRole9997268D",
      "Arn"
     ]
    },
    "Runtime": "nodejs20.x",
    "Tags": [
     {
      "Key": "App",
      "Value": "stylingadventures"
     },
     {
      "Key": "Env",
      "Value": "dev"
     }
    ],
    "Timeout": 60
   },
   "DependsOn": [
    "PublishClosetItemFnServiceRoleDefaultPolicy4282ADC3",
    "PublishClosetItemFnServiceRole9997268D"
   ],
   "Metadata": {
    "aws:cdk:path": "BestiesClosetStack/PublishClosetItemFn/Resource",
    "aws:asset:path": "asset.fea5a6ff2cd4c4887afea8687d9ffd6488623ad8f4e1ce48eefa967df941ddf7",
    "aws:asset:is-bundled": true,
    "aws:asset:property": "Code"
   }
  },
  "NotifyAdminFnServiceRole14F33905": {
   "Type": "AWS::IAM::Role",
   "Properties": {
    "AssumeRolePolicyDocument": {
     "Statement": [
      {
       "Action": "sts:AssumeRole",
       "Effect": "Allow",
       "Principal": {
        "Service": "lambda.amazonaws.com"
       }
      }
     ],
     "Version": "2012-10-17"
    },
    "ManagedPolicyArns": [
     {
      "Fn::Join": [
       "",
       [
        "arn:",
        {
         "Ref": "AWS::Partition"
        },
        ":iam::aws:policy/service-role/AWSLambdaBasicExecutionRole"
       ]
      ]
     }
    ],
    "Tags": [
     {
      "Key": "App",
      "Value": "stylingadventures"
     },
     {
      "Key": "Env",
      "Value": "dev"
     }
    ]
   },
   "Metadata": {
    "aws:cdk:path": "BestiesClosetStack/NotifyAdminFn/ServiceRole/Resource"
   }
  },
  "NotifyAdminFnServiceRoleDefaultPolicyBA423BD5": {
   "Type": "AWS::IAM::Policy",
   "Properties": {
    "PolicyDocument": {
     "Statement": [
      {
       "Action": [
        "dynamodb:BatchGetItem",
        "dynamodb:GetRecords",
        "dynamodb:GetShardIterator",
        "dynamodb:Query",
        "dynamodb:GetItem",
        "dynamodb:Scan",
        "dynamodb:ConditionCheckItem",
        "dynamodb:BatchWriteItem",
        "dynamodb:PutItem",
        "dynamodb:UpdateItem",
        "dynamodb:DeleteItem",
        "dynamodb:DescribeTable"
       ],
       "Effect": "Allow",
       "Resource": [
        {
         "Fn::ImportValue": "DataStack:ExportsOutputFnGetAttAppTable815C50BCArnF3D9E3C3"
        },
        {
         "Fn::Join": [
          "",
          [
           {
            "Fn::ImportValue": "DataStack:ExportsOutputFnGetAttAppTable815C50BCArnF3D9E3C3"
           },
           "/index/*"
          ]
         ]
        }
       ]
      }
     ],
     "Version": "2012-10-17"
    },
    "PolicyName": "NotifyAdminFnServiceRoleDefaultPolicyBA423BD5",
    "Roles": [
     {
      "Ref": "NotifyAdminFnServiceRole14F33905"
     }
    ]
   },
   "Metadata": {
    "aws:cdk:path": "BestiesClosetStack/NotifyAdminFn/ServiceRole/DefaultPolicy/Resource"
   }
  },
  "NotifyAdminFnFDB24FD6": {
   "Type": "AWS::Lambda::Function",
   "Properties": {
    "Code": {
     "S3Bucket": "cdk-hnb659fds-assets-637423256673-us-east-1",
     "S3Key": "dfa17ea5df9f26bad484f0a879b75a9a4eb72f591e7fe4c239596df509591501.zip"
    },
    "Environment": {
     "Variables": {
      "TABLE_NAME": {
       "Fn::ImportValue": "DataStack:ExportsOutputRefAppTable815C50BC1988FCFB"
      },
      "PK_NAME": "pk",
      "SK_NAME": "sk",
      "NODE_OPTIONS": "--enable-source-maps"
     }
    },
    "Handler": "index.handler",
    "MemorySize": 512,
    "Role": {
     "Fn::GetAtt": [
      "NotifyAdminFnServiceRole14F33905",
      "Arn"
     ]
    },
    "Runtime": "nodejs20.x",
    "Tags": [
     {
      "Key": "App",
      "Value": "stylingadventures"
     },
     {
      "Key": "Env",
      "Value": "dev"
     }
    ],
    "Timeout": 30
   },
   "DependsOn": [
    "NotifyAdminFnServiceRoleDefaultPolicyBA423BD5",
    "NotifyAdminFnServiceRole14F33905"
   ],
   "Metadata": {
    "aws:cdk:path": "BestiesClosetStack/NotifyAdminFn/Resource",
    "aws:asset:path": "asset.dfa17ea5df9f26bad484f0a879b75a9a4eb72f591e7fe4c239596df509591501",
    "aws:asset:is-bundled": true,
    "aws:asset:property": "Code"
   }
  },
  "ClosetUploadApprovalSMRole38D45F6B": {
   "Type": "AWS::IAM::Role",
   "Properties": {
    "AssumeRolePolicyDocument": {
     "Statement": [
      {
       "Action": "sts:AssumeRole",
       "Effect": "Allow",
       "Principal": {
        "Service": "states.amazonaws.com"
       }
      }
     ],
     "Version": "2012-10-17"
    },
    "Tags": [
     {
      "Key": "App",
      "Value": "stylingadventures"
     },
     {
      "Key": "Env",
      "Value": "dev"
     }
    ]
   },
   "Metadata": {
    "aws:cdk:path": "BestiesClosetStack/ClosetUploadApprovalSM/Role/Resource"
   }
  },
  "ClosetUploadApprovalSMRoleDefaultPolicyFFBBCD8F": {
   "Type": "AWS::IAM::Policy",
   "Properties": {
    "PolicyDocument": {
     "Statement": [
      {
       "Action": "lambda:InvokeFunction",
       "Effect": "Allow",
       "Resource": [
        {
         "Fn::GetAtt": [
          "ImageSegmentationFn0414CF98",
          "Arn"
         ]
        },
        {
         "Fn::Join": [
          "",
          [
           {
            "Fn::GetAtt": [
             "ImageSegmentationFn0414CF98",
             "Arn"
            ]
           },
           ":*"
          ]
         ]
        }
       ]
      },
      {
       "Action": "lambda:InvokeFunction",
       "Effect": "Allow",
       "Resource": [
        {
         "Fn::GetAtt": [
          "ModerationFn7E78A67D",
          "Arn"
         ]
        },
        {
         "Fn::Join": [
          "",
          [
           {
            "Fn::GetAtt": [
             "ModerationFn7E78A67D",
             "Arn"
            ]
           },
           ":*"
          ]
         ]
        }
       ]
      },
      {
       "Action": "lambda:InvokeFunction",
       "Effect": "Allow",
       "Resource": [
        {
         "Fn::GetAtt": [
          "PiiCheckFnF52DF218",
          "Arn"
         ]
        },
        {
         "Fn::Join": [
          "",
          [
           {
            "Fn::GetAtt": [
             "PiiCheckFnF52DF218",
             "Arn"
            ]
           },
           ":*"
          ]
         ]
        }
       ]
      },
      {
       "Action": "lambda:InvokeFunction",
       "Effect": "Allow",
       "Resource": [
        {
         "Fn::GetAtt": [
          "NotifyAdminFnFDB24FD6",
          "Arn"
         ]
        },
        {
         "Fn::Join": [
          "",
          [
           {
            "Fn::GetAtt": [
             "NotifyAdminFnFDB24FD6",
             "Arn"
            ]
           },
           ":*"
          ]
         ]
        }
       ]
      },
      {
       "Action": "lambda:InvokeFunction",
       "Effect": "Allow",
       "Resource": [
        {
         "Fn::GetAtt": [
          "PublishClosetItemFn8BF46E04",
          "Arn"
         ]
        },
        {
         "Fn::Join": [
          "",
          [
           {
            "Fn::GetAtt": [
             "PublishClosetItemFn8BF46E04",
             "Arn"
            ]
           },
           ":*"
          ]
         ]
        }
       ]
      },
      {
       "Action": [
        "xray:PutTraceSegments",
        "xray:PutTelemetryRecords",
        "xray:GetSamplingRules",
        "xray:GetSamplingTargets"
       ],
       "Effect": "Allow",
       "Resource": "*"
      }
     ],
     "Version": "2012-10-17"
    },
    "PolicyName": "ClosetUploadApprovalSMRoleDefaultPolicyFFBBCD8F",
    "Roles": [
     {
      "Ref": "ClosetUploadApprovalSMRole38D45F6B"
     }
    ]
   },
   "Metadata": {
    "aws:cdk:path": "BestiesClosetStack/ClosetUploadApprovalSM/Role/DefaultPolicy/Resource"
   }
  },
  "ClosetUploadApprovalSM46D354C9": {
   "Type": "AWS::StepFunctions::StateMachine",
   "Properties": {
    "DefinitionString": {
     "Fn::Join": [
      "",
      [
       "{\"StartAt\":\"SegmentOutfit\",\"States\":{\"SegmentOutfit\":{\"Next\":\"ModerateImage\",\"Retry\":[{\"ErrorEquals\":[\"Lambda.ClientExecutionTimeoutException\",\"Lambda.ServiceException\",\"Lambda.AWSLambdaException\",\"Lambda.SdkClientException\"],\"IntervalSeconds\":2,\"MaxAttempts\":6,\"BackoffRate\":2}],\"Type\":\"Task\",\"ResultPath\":\"$.segmentation\",\"Resource\":\"",
       {
        "Fn::GetAtt": [
         "ImageSegmentationFn0414CF98",
         "Arn"
        ]
       },
       "\",\"Parameters\":{\"item\":{\"s3Key.$\":\"$.item.s3Key\",\"bucket\":\"",
       {
        "Fn::ImportValue": "UploadsStack:ExportsOutputRefUploadsBucket5E5E9B64F2F56CC2"
       },
       "\"}}},\"ModerateImage\":{\"Next\":\"CheckPII\",\"Retry\":[{\"ErrorEquals\":[\"Lambda.ClientExecutionTimeoutException\",\"Lambda.ServiceException\",\"Lambda.AWSLambdaException\",\"Lambda.SdkClientException\"],\"IntervalSeconds\":2,\"MaxAttempts\":6,\"BackoffRate\":2}],\"Type\":\"Task\",\"ResultPath\":\"$.moderation\",\"Resource\":\"",
       {
        "Fn::GetAtt": [
         "ModerationFn7E78A67D",
         "Arn"
        ]
       },
       "\",\"Parameters\":\"$\"},\"CheckPII\":{\"Next\":\"NotifyAdminForApproval\",\"Retry\":[{\"ErrorEquals\":[\"Lambda.ClientExecutionTimeoutException\",\"Lambda.ServiceException\",\"Lambda.AWSLambdaException\",\"Lambda.SdkClientException\"],\"IntervalSeconds\":2,\"MaxAttempts\":6,\"BackoffRate\":2}],\"Type\":\"Task\",\"ResultPath\":\"$.pii\",\"Resource\":\"",
       {
        "Fn::GetAtt": [
         "PiiCheckFnF52DF218",
         "Arn"
        ]
       },
       "\",\"Parameters\":\"$\"},\"NotifyAdminForApproval\":{\"Next\":\"AdminApproved?\",\"Retry\":[{\"ErrorEquals\":[\"Lambda.ClientExecutionTimeoutException\",\"Lambda.ServiceException\",\"Lambda.AWSLambdaException\",\"Lambda.SdkClientException\"],\"IntervalSeconds\":2,\"MaxAttempts\":6,\"BackoffRate\":2}],\"Type\":\"Task\",\"TimeoutSeconds\":86400,\"ResultPath\":\"$.admin\",\"ResultSelector\":{\"decision.$\":\"$.decision\",\"reason.$\":\"$.reason\"},\"Resource\":\"arn:",
       {
        "Ref": "AWS::Partition"
       },
       ":states:::lambda:invoke.waitForTaskToken\",\"Parameters\":{\"FunctionName\":\"",
       {
        "Fn::GetAtt": [
         "NotifyAdminFnFDB24FD6",
         "Arn"
        ]
       },
       "\",\"Payload\":{\"token.$\":\"$$.Task.Token\",\"item.$\":\"$.item\",\"processedImageKey.$\":\"$.segmentation.outputKey\",\"moderation.$\":\"$.moderation\",\"pii.$\":\"$.pii\"}}},\"AdminApproved?\":{\"Type\":\"Choice\",\"Choices\":[{\"Variable\":\"$.admin.decision\",\"StringEquals\":\"APPROVE\",\"Next\":\"PublishClosetItem\"},{\"Variable\":\"$.admin.decision\",\"StringEquals\":\"REJECT\",\"Next\":\"Rejected\"}],\"Default\":\"Rejected\"},\"Rejected\":{\"Type\":\"Fail\",\"Cause\":\"RejectedByAdmin\"},\"PublishClosetItem\":{\"Next\":\"Published\",\"Retry\":[{\"ErrorEquals\":[\"Lambda.ClientExecutionTimeoutException\",\"Lambda.ServiceException\",\"Lambda.AWSLambdaException\",\"Lambda.SdkClientException\"],\"IntervalSeconds\":2,\"MaxAttempts\":6,\"BackoffRate\":2}],\"Type\":\"Task\",\"ResultPath\":\"$.published\",\"Resource\":\"",
       {
        "Fn::GetAtt": [
         "PublishClosetItemFn8BF46E04",
         "Arn"
        ]
       },
       "\",\"Parameters\":\"$\"},\"Published\":{\"Type\":\"Succeed\"}}}"
      ]
     ]
    },
    "RoleArn": {
     "Fn::GetAtt": [
      "ClosetUploadApprovalSMRole38D45F6B",
      "Arn"
     ]
    },
    "StateMachineType": "STANDARD",
    "Tags": [
     {
      "Key": "App",
      "Value": "stylingadventures"
     },
     {
      "Key": "Env",
      "Value": "dev"
     }
    ],
    "TracingConfiguration": {
     "Enabled": true
    }
   },
   "DependsOn": [
    "ClosetUploadApprovalSMRoleDefaultPolicyFFBBCD8F",
    "ClosetUploadApprovalSMRole38D45F6B"
   ],
   "UpdateReplacePolicy": "Delete",
   "DeletionPolicy": "Delete",
   "Metadata": {
    "aws:cdk:path": "BestiesClosetStack/ClosetUploadApprovalSM/Resource"
   }
  },
  "ValidateBgChangeFnServiceRoleA475219F": {
   "Type": "AWS::IAM::Role",
   "Properties": {
    "AssumeRolePolicyDocument": {
     "Statement": [
      {
       "Action": "sts:AssumeRole",
       "Effect": "Allow",
       "Principal": {
        "Service": "lambda.amazonaws.com"
       }
      }
     ],
     "Version": "2012-10-17"
    },
    "ManagedPolicyArns": [
     {
      "Fn::Join": [
       "",
       [
        "arn:",
        {
         "Ref": "AWS::Partition"
        },
        ":iam::aws:policy/service-role/AWSLambdaBasicExecutionRole"
       ]
      ]
     }
    ],
    "Tags": [
     {
      "Key": "App",
      "Value": "stylingadventures"
     },
     {
      "Key": "Env",
      "Value": "dev"
     }
    ]
   },
   "Metadata": {
    "aws:cdk:path": "BestiesClosetStack/ValidateBgChangeFn/ServiceRole/Resource"
   }
  },
  "ValidateBgChangeFnServiceRoleDefaultPolicyF44C3E36": {
   "Type": "AWS::IAM::Policy",
   "Properties": {
    "PolicyDocument": {
     "Statement": [
      {
       "Action": [
        "dynamodb:BatchGetItem",
        "dynamodb:GetRecords",
        "dynamodb:GetShardIterator",
        "dynamodb:Query",
        "dynamodb:GetItem",
        "dynamodb:Scan",
        "dynamodb:ConditionCheckItem",
        "dynamodb:BatchWriteItem",
        "dynamodb:PutItem",
        "dynamodb:UpdateItem",
        "dynamodb:DeleteItem",
        "dynamodb:DescribeTable"
       ],
       "Effect": "Allow",
       "Resource": [
        {
         "Fn::ImportValue": "DataStack:ExportsOutputFnGetAttAppTable815C50BCArnF3D9E3C3"
        },
        {
         "Fn::Join": [
          "",
          [
           {
            "Fn::ImportValue": "DataStack:ExportsOutputFnGetAttAppTable815C50BCArnF3D9E3C3"
           },
           "/index/*"
          ]
         ]
        }
       ]
      }
     ],
     "Version": "2012-10-17"
    },
    "PolicyName": "ValidateBgChangeFnServiceRoleDefaultPolicyF44C3E36",
    "Roles": [
     {
      "Ref": "ValidateBgChangeFnServiceRoleA475219F"
     }
    ]
   },
   "Metadata": {
    "aws:cdk:path": "BestiesClosetStack/ValidateBgChangeFn/ServiceRole/DefaultPolicy/Resource"
   }
  },
  "ValidateBgChangeFn419727A4": {
   "Type": "AWS::Lambda::Function",
   "Properties": {
    "Code": {
     "S3Bucket": "cdk-hnb659fds-assets-637423256673-us-east-1",
     "S3Key": "747c8b56a542c8c793d144d82a5d2e732230958c7beb96fe84efe4d8b105e204.zip"
    },
    "Environment": {
     "Variables": {
      "TABLE_NAME": {
       "Fn::ImportValue": "DataStack:ExportsOutputRefAppTable815C50BC1988FCFB"
      },
      "UPLOADS_BUCKET": {
       "Fn::ImportValue": "UploadsStack:ExportsOutputRefUploadsBucket5E5E9B64F2F56CC2"
      },
      "NODE_OPTIONS": "--enable-source-maps",
      "PK_NAME": "pk",
      "SK_NAME": "sk"
     }
    },
    "Handler": "index.handler",
    "MemorySize": 512,
    "Role": {
     "Fn::GetAtt": [
      "ValidateBgChangeFnServiceRoleA475219F",
      "Arn"
     ]
    },
    "Runtime": "nodejs20.x",
    "Tags": [
     {
      "Key": "App",
      "Value": "stylingadventures"
     },
     {
      "Key": "Env",
      "Value": "dev"
     }
    ],
    "Timeout": 30
   },
   "DependsOn": [
    "ValidateBgChangeFnServiceRoleDefaultPolicyF44C3E36",
    "ValidateBgChangeFnServiceRoleA475219F"
   ],
   "Metadata": {
    "aws:cdk:path": "BestiesClosetStack/ValidateBgChangeFn/Resource",
    "aws:asset:path": "asset.747c8b56a542c8c793d144d82a5d2e732230958c7beb96fe84efe4d8b105e204",
    "aws:asset:is-bundled": true,
    "aws:asset:property": "Code"
   }
  },
  "ModerateBgFnServiceRoleA8662475": {
   "Type": "AWS::IAM::Role",
   "Properties": {
    "AssumeRolePolicyDocument": {
     "Statement": [
      {
       "Action": "sts:AssumeRole",
       "Effect": "Allow",
       "Principal": {
        "Service": "lambda.amazonaws.com"
       }
      }
     ],
     "Version": "2012-10-17"
    },
    "ManagedPolicyArns": [
     {
      "Fn::Join": [
       "",
       [
        "arn:",
        {
         "Ref": "AWS::Partition"
        },
        ":iam::aws:policy/service-role/AWSLambdaBasicExecutionRole"
       ]
      ]
     }
    ],
    "Tags": [
     {
      "Key": "App",
      "Value": "stylingadventures"
     },
     {
      "Key": "Env",
      "Value": "dev"
     }
    ]
   },
   "Metadata": {
    "aws:cdk:path": "BestiesClosetStack/ModerateBgFn/ServiceRole/Resource"
   }
  },
  "ModerateBgFnServiceRoleDefaultPolicy75CA2E9C": {
   "Type": "AWS::IAM::Policy",
   "Properties": {
    "PolicyDocument": {
     "Statement": [
      {
       "Action": [
        "dynamodb:BatchGetItem",
        "dynamodb:GetRecords",
        "dynamodb:GetShardIterator",
        "dynamodb:Query",
        "dynamodb:GetItem",
        "dynamodb:Scan",
        "dynamodb:ConditionCheckItem",
        "dynamodb:BatchWriteItem",
        "dynamodb:PutItem",
        "dynamodb:UpdateItem",
        "dynamodb:DeleteItem",
        "dynamodb:DescribeTable"
       ],
       "Effect": "Allow",
       "Resource": [
        {
         "Fn::ImportValue": "DataStack:ExportsOutputFnGetAttAppTable815C50BCArnF3D9E3C3"
        },
        {
         "Fn::Join": [
          "",
          [
           {
            "Fn::ImportValue": "DataStack:ExportsOutputFnGetAttAppTable815C50BCArnF3D9E3C3"
           },
           "/index/*"
          ]
         ]
        }
       ]
      },
      {
       "Action": [
        "s3:GetObject*",
        "s3:GetBucket*",
        "s3:List*"
       ],
       "Effect": "Allow",
       "Resource": [
        {
         "Fn::ImportValue": "UploadsStack:ExportsOutputFnGetAttUploadsBucket5E5E9B64Arn8603C131"
        },
        {
         "Fn::Join": [
          "",
          [
           {
            "Fn::ImportValue": "UploadsStack:ExportsOutputFnGetAttUploadsBucket5E5E9B64Arn8603C131"
           },
           "/*"
          ]
         ]
        }
       ]
      }
     ],
     "Version": "2012-10-17"
    },
    "PolicyName": "ModerateBgFnServiceRoleDefaultPolicy75CA2E9C",
    "Roles": [
     {
      "Ref": "ModerateBgFnServiceRoleA8662475"
     }
    ]
   },
   "Metadata": {
    "aws:cdk:path": "BestiesClosetStack/ModerateBgFn/ServiceRole/DefaultPolicy/Resource"
   }
  },
  "ModerateBgFn9078832F": {
   "Type": "AWS::Lambda::Function",
   "Properties": {
    "Code": {
     "S3Bucket": "cdk-hnb659fds-assets-637423256673-us-east-1",
     "S3Key": "5ca245031610985bf8d9820d169d4b2a39d406e6f44ec6685cf1ab11f7f2d014.zip"
    },
    "Environment": {
     "Variables": {
      "TABLE_NAME": {
       "Fn::ImportValue": "DataStack:ExportsOutputRefAppTable815C50BC1988FCFB"
      },
      "UPLOADS_BUCKET": {
       "Fn::ImportValue": "UploadsStack:ExportsOutputRefUploadsBucket5E5E9B64F2F56CC2"
      },
      "NODE_OPTIONS": "--enable-source-maps",
      "PK_NAME": "pk",
      "SK_NAME": "sk"
     }
    },
    "Handler": "index.handler",
    "MemorySize": 512,
    "Role": {
     "Fn::GetAtt": [
      "ModerateBgFnServiceRoleA8662475",
      "Arn"
     ]
    },
    "Runtime": "nodejs20.x",
    "Tags": [
     {
      "Key": "App",
      "Value": "stylingadventures"
     },
     {
      "Key": "Env",
      "Value": "dev"
     }
    ],
    "Timeout": 30
   },
   "DependsOn": [
    "ModerateBgFnServiceRoleDefaultPolicy75CA2E9C",
    "ModerateBgFnServiceRoleA8662475"
   ],
   "Metadata": {
    "aws:cdk:path": "BestiesClosetStack/ModerateBgFn/Resource",
    "aws:asset:path": "asset.5ca245031610985bf8d9820d169d4b2a39d406e6f44ec6685cf1ab11f7f2d014",
    "aws:asset:is-bundled": true,
    "aws:asset:property": "Code"
   }
  },
  "ApplyBgChangeFnServiceRole9AC3176A": {
   "Type": "AWS::IAM::Role",
   "Properties": {
    "AssumeRolePolicyDocument": {
     "Statement": [
      {
       "Action": "sts:AssumeRole",
       "Effect": "Allow",
       "Principal": {
        "Service": "lambda.amazonaws.com"
       }
      }
     ],
     "Version": "2012-10-17"
    },
    "ManagedPolicyArns": [
     {
      "Fn::Join": [
       "",
       [
        "arn:",
        {
         "Ref": "AWS::Partition"
        },
        ":iam::aws:policy/service-role/AWSLambdaBasicExecutionRole"
       ]
      ]
     }
    ],
    "Tags": [
     {
      "Key": "App",
      "Value": "stylingadventures"
     },
     {
      "Key": "Env",
      "Value": "dev"
     }
    ]
   },
   "Metadata": {
    "aws:cdk:path": "BestiesClosetStack/ApplyBgChangeFn/ServiceRole/Resource"
   }
  },
  "ApplyBgChangeFnServiceRoleDefaultPolicyF1F3687F": {
   "Type": "AWS::IAM::Policy",
   "Properties": {
    "PolicyDocument": {
     "Statement": [
      {
       "Action": [
        "dynamodb:BatchGetItem",
        "dynamodb:GetRecords",
        "dynamodb:GetShardIterator",
        "dynamodb:Query",
        "dynamodb:GetItem",
        "dynamodb:Scan",
        "dynamodb:ConditionCheckItem",
        "dynamodb:BatchWriteItem",
        "dynamodb:PutItem",
        "dynamodb:UpdateItem",
        "dynamodb:DeleteItem",
        "dynamodb:DescribeTable"
       ],
       "Effect": "Allow",
       "Resource": [
        {
         "Fn::ImportValue": "DataStack:ExportsOutputFnGetAttAppTable815C50BCArnF3D9E3C3"
        },
        {
         "Fn::Join": [
          "",
          [
           {
            "Fn::ImportValue": "DataStack:ExportsOutputFnGetAttAppTable815C50BCArnF3D9E3C3"
           },
           "/index/*"
          ]
         ]
        }
       ]
      }
     ],
     "Version": "2012-10-17"
    },
    "PolicyName": "ApplyBgChangeFnServiceRoleDefaultPolicyF1F3687F",
    "Roles": [
     {
      "Ref": "ApplyBgChangeFnServiceRole9AC3176A"
     }
    ]
   },
   "Metadata": {
    "aws:cdk:path": "BestiesClosetStack/ApplyBgChangeFn/ServiceRole/DefaultPolicy/Resource"
   }
  },
  "ApplyBgChangeFn6D1C78C3": {
   "Type": "AWS::Lambda::Function",
   "Properties": {
    "Code": {
     "S3Bucket": "cdk-hnb659fds-assets-637423256673-us-east-1",
     "S3Key": "862c0fa7572dc63eac883051febde85b44650e42bd7b9ef4538264aeef176b22.zip"
    },
    "Environment": {
     "Variables": {
      "TABLE_NAME": {
       "Fn::ImportValue": "DataStack:ExportsOutputRefAppTable815C50BC1988FCFB"
      },
      "UPLOADS_BUCKET": {
       "Fn::ImportValue": "UploadsStack:ExportsOutputRefUploadsBucket5E5E9B64F2F56CC2"
      },
      "NODE_OPTIONS": "--enable-source-maps",
      "PK_NAME": "pk",
      "SK_NAME": "sk"
     }
    },
    "Handler": "index.handler",
    "MemorySize": 1024,
    "Role": {
     "Fn::GetAtt": [
      "ApplyBgChangeFnServiceRole9AC3176A",
      "Arn"
     ]
    },
    "Runtime": "nodejs20.x",
    "Tags": [
     {
      "Key": "App",
      "Value": "stylingadventures"
     },
     {
      "Key": "Env",
      "Value": "dev"
     }
    ],
    "Timeout": 60
   },
   "DependsOn": [
    "ApplyBgChangeFnServiceRoleDefaultPolicyF1F3687F",
    "ApplyBgChangeFnServiceRole9AC3176A"
   ],
   "Metadata": {
    "aws:cdk:path": "BestiesClosetStack/ApplyBgChangeFn/Resource",
    "aws:asset:path": "asset.862c0fa7572dc63eac883051febde85b44650e42bd7b9ef4538264aeef176b22",
    "aws:asset:is-bundled": true,
    "aws:asset:property": "Code"
   }
  },
  "BestieBackgroundApprovalTopic895968C0": {
   "Type": "AWS::SNS::Topic",
   "Properties": {
    "DisplayName": "Bestie Background Change Approvals",
    "Tags": [
     {
      "Key": "App",
      "Value": "stylingadventures"
     },
     {
      "Key": "Env",
      "Value": "dev"
     }
    ]
   },
   "Metadata": {
    "aws:cdk:path": "BestiesClosetStack/BestieBackgroundApprovalTopic/Resource"
   }
  },
  "BestieBackgroundApprovalTopicPolicy3A92D095": {
   "Type": "AWS::SNS::TopicPolicy",
   "Properties": {
    "PolicyDocument": {
     "Statement": [
      {
       "Action": "sns:Publish",
       "Effect": "Allow",
       "Principal": {
        "Service": "events.amazonaws.com"
       },
       "Resource": {
        "Ref": "BestieBackgroundApprovalTopic895968C0"
       },
       "Sid": "0"
      }
     ],
     "Version": "2012-10-17"
    },
    "Topics": [
     {
      "Ref": "BestieBackgroundApprovalTopic895968C0"
     }
    ]
   },
   "Metadata": {
    "aws:cdk:path": "BestiesClosetStack/BestieBackgroundApprovalTopic/Policy/Resource"
   }
  },
  "BestiesBus2096AB60": {
   "Type": "AWS::Events::EventBus",
   "Properties": {
    "Name": "sa-BestiesClosetStack-besties",
    "Tags": [
     {
      "Key": "App",
      "Value": "stylingadventures"
     },
     {
      "Key": "Env",
      "Value": "dev"
     }
    ]
   },
   "Metadata": {
    "aws:cdk:path": "BestiesClosetStack/BestiesBus/Resource"
   }
  },
  "BgChangePendingReviewRule1B7C9136": {
   "Type": "AWS::Events::Rule",
   "Properties": {
    "EventBusName": {
     "Ref": "BestiesBus2096AB60"
    },
    "EventPattern": {
     "source": [
      "stylingadventures.besties"
     ],
     "detail-type": [
      "BestieBackgroundChangePendingReview"
     ]
    },
    "State": "ENABLED",
    "Tags": [
     {
      "Key": "App",
      "Value": "stylingadventures"
     },
     {
      "Key": "Env",
      "Value": "dev"
     }
    ],
    "Targets": [
     {
      "Arn": {
       "Ref": "BestieBackgroundApprovalTopic895968C0"
      },
      "Id": "Target0"
     }
    ]
   },
   "Metadata": {
    "aws:cdk:path": "BestiesClosetStack/BgChangePendingReviewRule/Resource"
   }
  },
  "ClosetItemPendingReviewRule3799EF69": {
   "Type": "AWS::Events::Rule",
   "Properties": {
    "EventBusName": {
     "Ref": "BestiesBus2096AB60"
    },
    "EventPattern": {
     "source": [
      "stylingadventures.besties"
     ],
     "detail-type": [
      "BestieClosetItemPendingReview"
     ]
    },
    "State": "ENABLED",
    "Tags": [
     {
      "Key": "App",
      "Value": "stylingadventures"
     },
     {
      "Key": "Env",
      "Value": "dev"
     }
    ],
    "Targets": [
     {
      "Arn": {
       "Ref": "BestieBackgroundApprovalTopic895968C0"
      },
      "Id": "Target0"
     }
    ]
   },
   "Metadata": {
    "aws:cdk:path": "BestiesClosetStack/ClosetItemPendingReviewRule/Resource"
   }
  },
  "BackgroundChangeApprovalSMRole8975368A": {
   "Type": "AWS::IAM::Role",
   "Properties": {
    "AssumeRolePolicyDocument": {
     "Statement": [
      {
       "Action": "sts:AssumeRole",
       "Effect": "Allow",
       "Principal": {
        "Service": "states.amazonaws.com"
       }
      }
     ],
     "Version": "2012-10-17"
    },
    "Tags": [
     {
      "Key": "App",
      "Value": "stylingadventures"
     },
     {
      "Key": "Env",
      "Value": "dev"
     }
    ]
   },
   "Metadata": {
    "aws:cdk:path": "BestiesClosetStack/BackgroundChangeApprovalSM/Role/Resource"
   }
  },
  "BackgroundChangeApprovalSMRoleDefaultPolicy631B6BC3": {
   "Type": "AWS::IAM::Policy",
   "Properties": {
    "PolicyDocument": {
     "Statement": [
      {
       "Action": "lambda:InvokeFunction",
       "Effect": "Allow",
       "Resource": [
        {
         "Fn::GetAtt": [
          "ValidateBgChangeFn419727A4",
          "Arn"
         ]
        },
        {
         "Fn::Join": [
          "",
          [
           {
            "Fn::GetAtt": [
             "ValidateBgChangeFn419727A4",
             "Arn"
            ]
           },
           ":*"
          ]
         ]
        }
       ]
      },
      {
       "Action": "lambda:InvokeFunction",
       "Effect": "Allow",
       "Resource": [
        {
         "Fn::GetAtt": [
          "ImageSegmentationFn0414CF98",
          "Arn"
         ]
        },
        {
         "Fn::Join": [
          "",
          [
           {
            "Fn::GetAtt": [
             "ImageSegmentationFn0414CF98",
             "Arn"
            ]
           },
           ":*"
          ]
         ]
        }
       ]
      },
      {
       "Action": "lambda:InvokeFunction",
       "Effect": "Allow",
       "Resource": [
        {
         "Fn::GetAtt": [
          "ModerateBgFn9078832F",
          "Arn"
         ]
        },
        {
         "Fn::Join": [
          "",
          [
           {
            "Fn::GetAtt": [
             "ModerateBgFn9078832F",
             "Arn"
            ]
           },
           ":*"
          ]
         ]
        }
       ]
      },
      {
       "Action": "sns:Publish",
       "Effect": "Allow",
       "Resource": {
        "Ref": "BestieBackgroundApprovalTopic895968C0"
       }
      },
      {
       "Action": "lambda:InvokeFunction",
       "Effect": "Allow",
       "Resource": [
        {
         "Fn::GetAtt": [
          "ApplyBgChangeFn6D1C78C3",
          "Arn"
         ]
        },
        {
         "Fn::Join": [
          "",
          [
           {
            "Fn::GetAtt": [
             "ApplyBgChangeFn6D1C78C3",
             "Arn"
            ]
           },
           ":*"
          ]
         ]
        }
       ]
      },
      {
       "Action": [
        "xray:PutTraceSegments",
        "xray:PutTelemetryRecords",
        "xray:GetSamplingRules",
        "xray:GetSamplingTargets"
       ],
       "Effect": "Allow",
       "Resource": "*"
      }
     ],
     "Version": "2012-10-17"
    },
    "PolicyName": "BackgroundChangeApprovalSMRoleDefaultPolicy631B6BC3",
    "Roles": [
     {
      "Ref": "BackgroundChangeApprovalSMRole8975368A"
     }
    ]
   },
   "Metadata": {
    "aws:cdk:path": "BestiesClosetStack/BackgroundChangeApprovalSM/Role/DefaultPolicy/Resource"
   }
  },
  "BackgroundChangeApprovalSMA6DF140D": {
   "Type": "AWS::StepFunctions::StateMachine",
   "Properties": {
    "DefinitionString": {
     "Fn::Join": [
      "",
      [
       "{\"StartAt\":\"ValidateBackgroundChange\",\"States\":{\"ValidateBackgroundChange\":{\"Next\":\"SegmentOutfitForBgChange\",\"Retry\":[{\"ErrorEquals\":[\"Lambda.ClientExecutionTimeoutException\",\"Lambda.ServiceException\",\"Lambda.AWSLambdaException\",\"Lambda.SdkClientException\"],\"IntervalSeconds\":2,\"MaxAttempts\":6,\"BackoffRate\":2}],\"Type\":\"Task\",\"ResultPath\":\"$.validation\",\"Resource\":\"",
       {
        "Fn::GetAtt": [
         "ValidateBgChangeFn419727A4",
         "Arn"
        ]
       },
       "\"},\"SegmentOutfitForBgChange\":{\"Next\":\"ModerateBackground\",\"Retry\":[{\"ErrorEquals\":[\"Lambda.ClientExecutionTimeoutException\",\"Lambda.ServiceException\",\"Lambda.AWSLambdaException\",\"Lambda.SdkClientException\"],\"IntervalSeconds\":2,\"MaxAttempts\":6,\"BackoffRate\":2}],\"Type\":\"Task\",\"TimeoutSeconds\":180,\"ResultPath\":\"$.segmentationBg\",\"Resource\":\"",
       {
        "Fn::GetAtt": [
         "ImageSegmentationFn0414CF98",
         "Arn"
        ]
       },
       "\",\"Parameters\":{\"item\":{\"s3Key.$\":\"$.item.s3Key\",\"bucket\":\"",
       {
        "Fn::ImportValue": "UploadsStack:ExportsOutputRefUploadsBucket5E5E9B64F2F56CC2"
       },
       "\"}}},\"ModerateBackground\":{\"Next\":\"NotifyAdminBgChange\",\"Retry\":[{\"ErrorEquals\":[\"Lambda.ClientExecutionTimeoutException\",\"Lambda.ServiceException\",\"Lambda.AWSLambdaException\",\"Lambda.SdkClientException\"],\"IntervalSeconds\":2,\"MaxAttempts\":6,\"BackoffRate\":2}],\"Type\":\"Task\",\"ResultPath\":\"$.moderationBg\",\"Resource\":\"",
       {
        "Fn::GetAtt": [
         "ModerateBgFn9078832F",
         "Arn"
        ]
       },
       "\"},\"NotifyAdminBgChange\":{\"Next\":\"AdminApprovedBgChange?\",\"Type\":\"Task\",\"ResultPath\":\"$.approval\",\"Resource\":\"arn:",
       {
        "Ref": "AWS::Partition"
       },
       ":states:::sns:publish.waitForTaskToken\",\"Parameters\":{\"TopicArn\":\"",
       {
        "Ref": "BestieBackgroundApprovalTopic895968C0"
       },
       "\",\"Message\":{\"type\":\"BESTIE_BACKGROUND_CHANGE\",\"detail.$\":\"$\",\"taskToken.$\":\"$$.Task.Token\",\"processedImageKey.$\":\"$.segmentationBg.outputKey\"}}},\"AdminApprovedBgChange?\":{\"Type\":\"Choice\",\"Choices\":[{\"Variable\":\"$.approval.approved\",\"BooleanEquals\":true,\"Next\":\"ApplyBackgroundChange\"}],\"Default\":\"BackgroundChangeRejected\"},\"BackgroundChangeRejected\":{\"Type\":\"Pass\",\"Result\":{\"status\":\"REJECTED\"},\"End\":true},\"ApplyBackgroundChange\":{\"End\":true,\"Retry\":[{\"ErrorEquals\":[\"Lambda.ClientExecutionTimeoutException\",\"Lambda.ServiceException\",\"Lambda.AWSLambdaException\",\"Lambda.SdkClientException\"],\"IntervalSeconds\":2,\"MaxAttempts\":6,\"BackoffRate\":2}],\"Type\":\"Task\",\"ResultPath\":\"$.applied\",\"Resource\":\"",
       {
        "Fn::GetAtt": [
         "ApplyBgChangeFn6D1C78C3",
         "Arn"
        ]
       },
       "\"}}}"
      ]
     ]
    },
    "RoleArn": {
     "Fn::GetAtt": [
      "BackgroundChangeApprovalSMRole8975368A",
      "Arn"
     ]
    },
    "StateMachineType": "STANDARD",
    "Tags": [
     {
      "Key": "App",
      "Value": "stylingadventures"
     },
     {
      "Key": "Env",
      "Value": "dev"
     }
    ],
    "TracingConfiguration": {
     "Enabled": true
    }
   },
   "DependsOn": [
    "BackgroundChangeApprovalSMRoleDefaultPolicy631B6BC3",
    "BackgroundChangeApprovalSMRole8975368A"
   ],
   "UpdateReplacePolicy": "Delete",
   "DeletionPolicy": "Delete",
   "Metadata": {
    "aws:cdk:path": "BestiesClosetStack/BackgroundChangeApprovalSM/Resource"
   }
  },
  "SaveApprovalTokenFnServiceRoleD525F86C": {
   "Type": "AWS::IAM::Role",
   "Properties": {
    "AssumeRolePolicyDocument": {
     "Statement": [
      {
       "Action": "sts:AssumeRole",
       "Effect": "Allow",
       "Principal": {
        "Service": "lambda.amazonaws.com"
       }
      }
     ],
     "Version": "2012-10-17"
    },
    "ManagedPolicyArns": [
     {
      "Fn::Join": [
       "",
       [
        "arn:",
        {
         "Ref": "AWS::Partition"
        },
        ":iam::aws:policy/service-role/AWSLambdaBasicExecutionRole"
       ]
      ]
     }
    ],
    "Tags": [
     {
      "Key": "App",
      "Value": "stylingadventures"
     },
     {
      "Key": "Env",
      "Value": "dev"
     }
    ]
   },
   "Metadata": {
    "aws:cdk:path": "BestiesClosetStack/SaveApprovalTokenFn/ServiceRole/Resource"
   }
  },
  "SaveApprovalTokenFnServiceRoleDefaultPolicy8271F5BF": {
   "Type": "AWS::IAM::Policy",
   "Properties": {
    "PolicyDocument": {
     "Statement": [
      {
       "Action": [
        "dynamodb:BatchGetItem",
        "dynamodb:GetRecords",
        "dynamodb:GetShardIterator",
        "dynamodb:Query",
        "dynamodb:GetItem",
        "dynamodb:Scan",
        "dynamodb:ConditionCheckItem",
        "dynamodb:BatchWriteItem",
        "dynamodb:PutItem",
        "dynamodb:UpdateItem",
        "dynamodb:DeleteItem",
        "dynamodb:DescribeTable"
       ],
       "Effect": "Allow",
       "Resource": [
        {
         "Fn::ImportValue": "DataStack:ExportsOutputFnGetAttAppTable815C50BCArnF3D9E3C3"
        },
        {
         "Fn::Join": [
          "",
          [
           {
            "Fn::ImportValue": "DataStack:ExportsOutputFnGetAttAppTable815C50BCArnF3D9E3C3"
           },
           "/index/*"
          ]
         ]
        }
       ]
      }
     ],
     "Version": "2012-10-17"
    },
    "PolicyName": "SaveApprovalTokenFnServiceRoleDefaultPolicy8271F5BF",
    "Roles": [
     {
      "Ref": "SaveApprovalTokenFnServiceRoleD525F86C"
     }
    ]
   },
   "Metadata": {
    "aws:cdk:path": "BestiesClosetStack/SaveApprovalTokenFn/ServiceRole/DefaultPolicy/Resource"
   }
  },
  "SaveApprovalTokenFnBF4550C6": {
   "Type": "AWS::Lambda::Function",
   "Properties": {
    "Code": {
     "S3Bucket": "cdk-hnb659fds-assets-637423256673-us-east-1",
     "S3Key": "193a25b2fc06146354e9e5db8f227d96865ec02a3549934f5b17aec73c82fa5a.zip"
    },
    "Environment": {
     "Variables": {
      "TABLE_NAME": {
       "Fn::ImportValue": "DataStack:ExportsOutputRefAppTable815C50BC1988FCFB"
      },
      "PK_NAME": "pk",
      "SK_NAME": "sk",
      "NODE_OPTIONS": "--enable-source-maps"
     }
    },
    "Handler": "index.handler",
    "Role": {
     "Fn::GetAtt": [
      "SaveApprovalTokenFnServiceRoleD525F86C",
      "Arn"
     ]
    },
    "Runtime": "nodejs20.x",
    "Tags": [
     {
      "Key": "App",
      "Value": "stylingadventures"
     },
     {
      "Key": "Env",
      "Value": "dev"
     }
    ]
   },
   "DependsOn": [
    "SaveApprovalTokenFnServiceRoleDefaultPolicy8271F5BF",
    "SaveApprovalTokenFnServiceRoleD525F86C"
   ],
   "Metadata": {
    "aws:cdk:path": "BestiesClosetStack/SaveApprovalTokenFn/Resource",
    "aws:asset:path": "asset.193a25b2fc06146354e9e5db8f227d96865ec02a3549934f5b17aec73c82fa5a",
    "aws:asset:is-bundled": true,
    "aws:asset:property": "Code"
   }
  },
  "SaveApprovalTokenFnAllowInvokeBestiesClosetStackBestieBackgroundApprovalTopic94BA1983DB3E4AFD": {
   "Type": "AWS::Lambda::Permission",
   "Properties": {
    "Action": "lambda:InvokeFunction",
    "FunctionName": {
     "Fn::GetAtt": [
      "SaveApprovalTokenFnBF4550C6",
      "Arn"
     ]
    },
    "Principal": "sns.amazonaws.com",
    "SourceArn": {
     "Ref": "BestieBackgroundApprovalTopic895968C0"
    }
   },
   "Metadata": {
    "aws:cdk:path": "BestiesClosetStack/SaveApprovalTokenFn/AllowInvoke:BestiesClosetStackBestieBackgroundApprovalTopic94BA1983"
   }
  },
  "SaveApprovalTokenFnBestieBackgroundApprovalTopic6BA6BE2B": {
   "Type": "AWS::SNS::Subscription",
   "Properties": {
    "Endpoint": {
     "Fn::GetAtt": [
      "SaveApprovalTokenFnBF4550C6",
      "Arn"
     ]
    },
    "Protocol": "lambda",
    "TopicArn": {
     "Ref": "BestieBackgroundApprovalTopic895968C0"
    }
   },
   "Metadata": {
    "aws:cdk:path": "BestiesClosetStack/SaveApprovalTokenFn/BestieBackgroundApprovalTopic/Resource"
   }
  },
  "ApproveClosetUploadFnServiceRole6FCD1BF1": {
   "Type": "AWS::IAM::Role",
   "Properties": {
    "AssumeRolePolicyDocument": {
     "Statement": [
      {
       "Action": "sts:AssumeRole",
       "Effect": "Allow",
       "Principal": {
        "Service": "lambda.amazonaws.com"
       }
      }
     ],
     "Version": "2012-10-17"
    },
    "ManagedPolicyArns": [
     {
      "Fn::Join": [
       "",
       [
        "arn:",
        {
         "Ref": "AWS::Partition"
        },
        ":iam::aws:policy/service-role/AWSLambdaBasicExecutionRole"
       ]
      ]
     }
    ],
    "Tags": [
     {
      "Key": "App",
      "Value": "stylingadventures"
     },
     {
      "Key": "Env",
      "Value": "dev"
     }
    ]
   },
   "Metadata": {
    "aws:cdk:path": "BestiesClosetStack/ApproveClosetUploadFn/ServiceRole/Resource"
   }
  },
  "ApproveClosetUploadFnServiceRoleDefaultPolicy1412967A": {
   "Type": "AWS::IAM::Policy",
   "Properties": {
    "PolicyDocument": {
     "Statement": [
      {
       "Action": [
        "dynamodb:BatchGetItem",
        "dynamodb:GetRecords",
        "dynamodb:GetShardIterator",
        "dynamodb:Query",
        "dynamodb:GetItem",
        "dynamodb:Scan",
        "dynamodb:ConditionCheckItem",
        "dynamodb:BatchWriteItem",
        "dynamodb:PutItem",
        "dynamodb:UpdateItem",
        "dynamodb:DeleteItem",
        "dynamodb:DescribeTable"
       ],
       "Effect": "Allow",
       "Resource": [
        {
         "Fn::ImportValue": "DataStack:ExportsOutputFnGetAttAppTable815C50BCArnF3D9E3C3"
        },
        {
         "Fn::Join": [
          "",
          [
           {
            "Fn::ImportValue": "DataStack:ExportsOutputFnGetAttAppTable815C50BCArnF3D9E3C3"
           },
           "/index/*"
          ]
         ]
        }
       ]
      },
      {
       "Action": [
        "states:SendTaskSuccess",
        "states:SendTaskFailure"
       ],
       "Effect": "Allow",
       "Resource": "*"
      }
     ],
     "Version": "2012-10-17"
    },
    "PolicyName": "ApproveClosetUploadFnServiceRoleDefaultPolicy1412967A",
    "Roles": [
     {
      "Ref": "ApproveClosetUploadFnServiceRole6FCD1BF1"
     }
    ]
   },
   "Metadata": {
    "aws:cdk:path": "BestiesClosetStack/ApproveClosetUploadFn/ServiceRole/DefaultPolicy/Resource"
   }
  },
  "ApproveClosetUploadFnC4D99774": {
   "Type": "AWS::Lambda::Function",
   "Properties": {
    "Code": {
     "S3Bucket": "cdk-hnb659fds-assets-637423256673-us-east-1",
     "S3Key": "f2bb7d489c8db319e6661d4558f1bbc19932754d807189532370934809ec9548.zip"
    },
    "Environment": {
     "Variables": {
      "TABLE_NAME": {
       "Fn::ImportValue": "DataStack:ExportsOutputRefAppTable815C50BC1988FCFB"
      },
      "PK_NAME": "pk",
      "SK_NAME": "sk",
      "NODE_OPTIONS": "--enable-source-maps"
     }
    },
    "Handler": "index.handler",
    "Role": {
     "Fn::GetAtt": [
      "ApproveClosetUploadFnServiceRole6FCD1BF1",
      "Arn"
     ]
    },
    "Runtime": "nodejs20.x",
    "Tags": [
     {
      "Key": "App",
      "Value": "stylingadventures"
     },
     {
      "Key": "Env",
      "Value": "dev"
     }
    ]
   },
   "DependsOn": [
    "ApproveClosetUploadFnServiceRoleDefaultPolicy1412967A",
    "ApproveClosetUploadFnServiceRole6FCD1BF1"
   ],
   "Metadata": {
    "aws:cdk:path": "BestiesClosetStack/ApproveClosetUploadFn/Resource",
    "aws:asset:path": "asset.f2bb7d489c8db319e6661d4558f1bbc19932754d807189532370934809ec9548",
    "aws:asset:is-bundled": true,
    "aws:asset:property": "Code"
   }
  },
  "BestiesAdminApiD443FA75": {
   "Type": "AWS::ApiGatewayV2::Api",
   "Properties": {
    "Name": "sa-BestiesClosetStack-admin-api",
    "ProtocolType": "HTTP",
    "Tags": {
     "App": "stylingadventures",
     "Env": "dev"
    }
   },
   "Metadata": {
    "aws:cdk:path": "BestiesClosetStack/BestiesAdminApi/Resource"
   }
  },
  "BestiesAdminApiDefaultStage477978A2": {
   "Type": "AWS::ApiGatewayV2::Stage",
   "Properties": {
    "ApiId": {
     "Ref": "BestiesAdminApiD443FA75"
    },
    "AutoDeploy": true,
    "StageName": "$default",
    "Tags": {
     "App": "stylingadventures",
     "Env": "dev"
    }
   },
   "Metadata": {
    "aws:cdk:path": "BestiesClosetStack/BestiesAdminApi/DefaultStage/Resource"
   }
  },
  "BestiesAdminApiPOSTadminclosetapproveApproveClosetUploadIntegration8A051F48": {
   "Type": "AWS::ApiGatewayV2::Integration",
   "Properties": {
    "ApiId": {
     "Ref": "BestiesAdminApiD443FA75"
    },
    "IntegrationType": "AWS_PROXY",
    "IntegrationUri": {
     "Fn::GetAtt": [
      "ApproveClosetUploadFnC4D99774",
      "Arn"
     ]
    },
    "PayloadFormatVersion": "2.0"
   },
   "Metadata": {
    "aws:cdk:path": "BestiesClosetStack/BestiesAdminApi/POST--admin--closet--approve/ApproveClosetUploadIntegration/Resource"
   }
  },
  "BestiesAdminApiPOSTadminclosetapproveApproveClosetUploadIntegrationPermissionC159ADDA": {
   "Type": "AWS::Lambda::Permission",
   "Properties": {
    "Action": "lambda:InvokeFunction",
    "FunctionName": {
     "Fn::GetAtt": [
      "ApproveClosetUploadFnC4D99774",
      "Arn"
     ]
    },
    "Principal": "apigateway.amazonaws.com",
    "SourceArn": {
     "Fn::Join": [
      "",
      [
       "arn:",
       {
        "Ref": "AWS::Partition"
       },
       ":execute-api:us-east-1:637423256673:",
       {
        "Ref": "BestiesAdminApiD443FA75"
       },
       "/*/*/admin/closet/approve"
      ]
     ]
    }
   },
   "Metadata": {
    "aws:cdk:path": "BestiesClosetStack/BestiesAdminApi/POST--admin--closet--approve/ApproveClosetUploadIntegration-Permission"
   }
  },
  "BestiesAdminApiPOSTadminclosetapproveC2CD6284": {
   "Type": "AWS::ApiGatewayV2::Route",
   "Properties": {
    "ApiId": {
     "Ref": "BestiesAdminApiD443FA75"
    },
    "AuthorizationType": "NONE",
    "RouteKey": "POST /admin/closet/approve",
    "Target": {
     "Fn::Join": [
      "",
      [
       "integrations/",
       {
        "Ref": "BestiesAdminApiPOSTadminclosetapproveApproveClosetUploadIntegration8A051F48"
       }
      ]
     ]
    }
   },
   "Metadata": {
    "aws:cdk:path": "BestiesClosetStack/BestiesAdminApi/POST--admin--closet--approve/Resource"
   }
  },
  "CDKMetadata": {
   "Type": "AWS::CDK::Metadata",
   "Properties": {
    "Analytics": "v2:deflate64:H4sIAAAAAAAA/11RwW7bMAz9lt4VLnN26THpWjRAuwb27gGjsA5jWzJMKkFg6N8HyU2X9qL3HvlIUVQBRbGA+R2eZWb3zazlHYyVom0MnmU7ttjt9gjjb28bGtYd1vQUnFX2zjy8u1u+oaFjEfYuGsYOxtK3lBIZN75le8m+zKIhO2xRhFTgpvsyRVIOSuq9sPrhskIhM02ydX5PR4E/GT6vl8W11VQvC1gF25DmUlHq3z+sslWURmB8yf3W7uQbMpWTTdi1LIf41Q3jE3JrqmAt0d48HDxbMpWi0ivaA7v8wi96gyLRSKr963u2yTCRfP5fxK2swk7swP11mbc6GjqRU4HxMeEqSHJ88jJ8rDm0FA32XKPSGS+nAsZn1X7Zc0onSLJSrK9D15RDpQ86sbVTqge8TvFNZl+MpiTxYbBk8rJTH3Z1MrwF7YNGkz4JjvLjVMzh5z38ujsK82wITrkjKCf8BwvLRYB7AgAA"
   },
   "Metadata": {
    "aws:cdk:path": "BestiesClosetStack/CDKMetadata/Default"
   }
  }
 },
 "Outputs": {
  "AdminApiUrl": {
   "Value": {
    "Fn::Join": [
     "",
     [
      "https://",
      {
       "Ref": "BestiesAdminApiD443FA75"
      },
      ".execute-api.us-east-1.",
      {
       "Ref": "AWS::URLSuffix"
      },
      "/"
     ]
    ]
   }
  },
  "ExportsOutputRefClosetUploadApprovalSM46D354C9ED6F8513": {
   "Value": {
    "Ref": "ClosetUploadApprovalSM46D354C9"
   },
   "Export": {
    "Name": "BestiesClosetStack:ExportsOutputRefClosetUploadApprovalSM46D354C9ED6F8513"
   }
  },
  "ExportsOutputRefBackgroundChangeApprovalSMA6DF140DCA66162D": {
   "Value": {
    "Ref": "BackgroundChangeApprovalSMA6DF140D"
   },
   "Export": {
    "Name": "BestiesClosetStack:ExportsOutputRefBackgroundChangeApprovalSMA6DF140DCA66162D"
   }
  }
 },
 "Parameters": {
  "BootstrapVersion": {
   "Type": "AWS::SSM::Parameter::Value<String>",
   "Default": "/cdk-bootstrap/hnb659fds/version",
   "Description": "Version of the CDK Bootstrap resources in this environment, automatically retrieved from SSM Parameter Store. [cdk:skip]"
  }
 },
 "Rules": {
  "CheckBootstrapVersion": {
   "Assertions": [
    {
     "Assert": {
      "Fn::Not": [
       {
        "Fn::Contains": [
         [
          "1",
          "2",
          "3",
          "4",
          "5"
         ],
         {
          "Ref": "BootstrapVersion"
         }
        ]
       }
      ]
     },
     "AssertDescription": "CDK bootstrap stack version 6 required. Please run 'cdk bootstrap' with a recent version of the CDK CLI."
    }
   ]
  }
 }
}