{
  "version": 3,
  "sources": ["../../lambda/prime-bank/calculate-bank-meter.ts"],
  "sourcesContent": ["// lambda/prime-bank/calculate-bank-meter.ts\r\nimport {\r\n  DynamoDBClient,\r\n  UpdateItemCommand,\r\n  GetItemCommand,\r\n} from \"@aws-sdk/client-dynamodb\";\r\nimport { Handler } from \"aws-lambda\";\r\n\r\nconst ACCOUNT_TABLE_NAME = process.env.PRIME_BANK_ACCOUNT_TABLE_NAME!;\r\nconst ddb = new DynamoDBClient({});\r\n\r\ninterface CalculateBankMeterEvent {\r\n  userId: string;\r\n}\r\n\r\nexport const handler: Handler<CalculateBankMeterEvent, any> = async (event) => {\r\n  console.log(\"CalculateBankMeter event:\", JSON.stringify(event));\r\n\r\n  const { userId } = event;\r\n\r\n  // 1) Fetch current account\r\n  const resp = await ddb.send(\r\n    new GetItemCommand({\r\n      TableName: ACCOUNT_TABLE_NAME,\r\n      Key: { userId: { S: userId } },\r\n    })\r\n  );\r\n\r\n  // TODO: use your real logic here.\r\n  // For now, just set a dummy value (e.g., 10).\r\n  const newMeterValue = 10;\r\n\r\n  await ddb.send(\r\n    new UpdateItemCommand({\r\n      TableName: ACCOUNT_TABLE_NAME,\r\n      Key: { userId: { S: userId } },\r\n      UpdateExpression: \"SET bankMeterProgress = :value\",\r\n      ExpressionAttributeValues: {\r\n        \":value\": { N: String(newMeterValue) },\r\n      },\r\n    })\r\n  );\r\n\r\n  return {\r\n    ok: true,\r\n    userId,\r\n    bankMeterProgress: newMeterValue,\r\n  };\r\n};\r\n"],
  "mappings": "yaAAA,IAAAA,EAAA,GAAAC,EAAAD,EAAA,aAAAE,IAAA,eAAAC,EAAAH,GACA,IAAAI,EAIO,oCAGDC,EAAqB,QAAQ,IAAI,8BACjCC,EAAM,IAAI,iBAAe,CAAC,CAAC,EAMpBJ,EAAiD,MAAOK,GAAU,CAC7E,QAAQ,IAAI,4BAA6B,KAAK,UAAUA,CAAK,CAAC,EAE9D,GAAM,CAAE,OAAAC,CAAO,EAAID,EAGbE,EAAO,MAAMH,EAAI,KACrB,IAAI,iBAAe,CACjB,UAAWD,EACX,IAAK,CAAE,OAAQ,CAAE,EAAGG,CAAO,CAAE,CAC/B,CAAC,CACH,EAIME,EAAgB,GAEtB,aAAMJ,EAAI,KACR,IAAI,oBAAkB,CACpB,UAAWD,EACX,IAAK,CAAE,OAAQ,CAAE,EAAGG,CAAO,CAAE,EAC7B,iBAAkB,iCAClB,0BAA2B,CACzB,SAAU,CAAE,EAAG,OAAOE,CAAa,CAAE,CACvC,CACF,CAAC,CACH,EAEO,CACL,GAAI,GACJ,OAAAF,EACA,kBAAmBE,CACrB,CACF",
  "names": ["calculate_bank_meter_exports", "__export", "handler", "__toCommonJS", "import_client_dynamodb", "ACCOUNT_TABLE_NAME", "ddb", "event", "userId", "resp", "newMeterValue"]
}
