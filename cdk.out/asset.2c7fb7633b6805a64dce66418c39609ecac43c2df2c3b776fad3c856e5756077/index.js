"use strict";var a=Object.defineProperty;var l=Object.getOwnPropertyDescriptor;var d=Object.getOwnPropertyNames;var c=Object.prototype.hasOwnProperty;var B=(e,n)=>{for(var s in n)a(e,s,{get:n[s],enumerable:!0})},L=(e,n,s,r)=>{if(n&&typeof n=="object"||typeof n=="function")for(let o of d(n))!c.call(e,o)&&o!==s&&a(e,o,{get:()=>n[o],enumerable:!(r=l(n,o))||r.enumerable});return e};var f=e=>L(a({},"__esModule",{value:!0}),e);var x={};B(x,{handler:()=>w});module.exports=f(x);var m=require("@aws-sdk/client-dynamodb"),t=require("@aws-sdk/lib-dynamodb");var p=process.env.TABLE_NAME??process.env.APP_TABLE??process.env.TABLE??"";if(!p)throw new Error("Missing DynamoDB table env. Provide TABLE_NAME (or APP_TABLE / TABLE).");var u=t.DynamoDBDocumentClient.from(new m.DynamoDBClient({})),w=async e=>{let{fieldName:n}=e.info,{limit:s=10,season:r="GLOBAL"}=e.arguments||{};if(n==="topXP"||n==="topCoins"){let o=`LEADERBOARD#${r}`,A=await u.send(new t.QueryCommand({TableName:p,IndexName:"gsi1",KeyConditionExpression:"gsi1pk = :p AND begins_with(gsi1sk, :xp)",ExpressionAttributeValues:{":p":o,":xp":"XP#"},ScanIndexForward:!1,Limit:Math.min(100,s)})),E=1;return(A.Items??[]).map(i=>({userId:i.pk.replace("USER#",""),displayName:i.displayName??void 0,xp:i.xp??null,coins:i.coins??null,rank:E++}))}throw new Error(`Unknown field ${n}`)};0&&(module.exports={handler});
//# sourceMappingURL=index.js.map
