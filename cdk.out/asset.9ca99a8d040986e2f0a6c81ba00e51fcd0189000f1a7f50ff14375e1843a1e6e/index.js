"use strict";var o=Object.defineProperty;var c=Object.getOwnPropertyDescriptor;var A=Object.getOwnPropertyNames;var u=Object.prototype.hasOwnProperty;var C=(t,e)=>{for(var r in e)o(t,r,{get:e[r],enumerable:!0})},N=(t,e,r,a)=>{if(e&&typeof e=="object"||typeof e=="function")for(let n of A(e))!u.call(t,n)&&n!==r&&o(t,n,{get:()=>e[n],enumerable:!(a=c(e,n))||a.enumerable});return t};var S=t=>N(o({},"__esModule",{value:!0}),t);var p={};C(p,{handler:()=>_});module.exports=S(p);var s=require("@aws-sdk/client-dynamodb"),E=process.env.PRIME_BANK_ACCOUNT_TABLE_NAME,I=process.env.PRIME_BANK_TRANSACTION_TABLE_NAME,i=new s.DynamoDBClient({}),_=async t=>{console.log("AwardCreatorCredits event:",JSON.stringify(t));let{userId:e,amount:r,source:a,notes:n}=t;await i.send(new s.UpdateItemCommand({TableName:E,Key:{userId:{S:e}},UpdateExpression:"ADD creatorCredits :delta",ExpressionAttributeValues:{":delta":{N:String(r)}}}));let m=new Date().toISOString(),d=`txn_${Date.now()}`;return await i.send(new s.PutItemCommand({TableName:I,Item:{userId:{S:e},timestamp:{S:m},transactionId:{S:d},type:{S:"earn"},currency:{S:"creatorCredits"},amount:{N:String(r)},source:{S:a},...n?{notes:{S:n}}:{}}})),{ok:!0,userId:e,amount:r,transactionId:d}};0&&(module.exports={handler});
//# sourceMappingURL=index.js.map
