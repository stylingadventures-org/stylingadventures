"use strict";var a=Object.defineProperty;var A=Object.getOwnPropertyDescriptor;var c=Object.getOwnPropertyNames;var u=Object.prototype.hasOwnProperty;var N=(n,e)=>{for(var t in e)a(n,t,{get:e[t],enumerable:!0})},S=(n,e,t,o)=>{if(e&&typeof e=="object"||typeof e=="function")for(let r of c(e))!u.call(n,r)&&r!==t&&a(n,r,{get:()=>e[r],enumerable:!(o=A(e,r))||o.enumerable});return n};var p=n=>S(a({},"__esModule",{value:!0}),n);var _={};N(_,{handler:()=>I});module.exports=p(_);var s=require("@aws-sdk/client-dynamodb"),C=process.env.PRIME_BANK_ACCOUNT_TABLE_NAME,E=process.env.PRIME_BANK_TRANSACTION_TABLE_NAME,m=new s.DynamoDBClient({}),I=async n=>{console.log("AwardPrimeCoins event:",JSON.stringify(n));let{userId:e,amount:t,source:o,notes:r}=n;await m.send(new s.UpdateItemCommand({TableName:C,Key:{userId:{S:e}},UpdateExpression:"ADD primeCoins :delta",ExpressionAttributeValues:{":delta":{N:String(t)}}}));let d=new Date().toISOString(),i=`txn_${Date.now()}`;return await m.send(new s.PutItemCommand({TableName:E,Item:{userId:{S:e},timestamp:{S:d},transactionId:{S:i},type:{S:"earn"},currency:{S:"primeCoins"},amount:{N:String(t)},source:{S:o},...r?{notes:{S:r}}:{}}})),{ok:!0,userId:e,amount:t,transactionId:i}};0&&(module.exports={handler});
//# sourceMappingURL=index.js.map
