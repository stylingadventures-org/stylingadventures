{
  "version": 3,
  "sources": ["../../lambda/closet/admin.ts"],
  "sourcesContent": ["// lambda/closet/admin.ts\r\n\r\nimport {\r\n  DynamoDBClient,\r\n  QueryCommand,\r\n  UpdateItemCommand,\r\n  GetItemCommand,\r\n  PutItemCommand,\r\n} from \"@aws-sdk/client-dynamodb\";\r\nimport {\r\n  SFNClient,\r\n  SendTaskFailureCommand,\r\n  SendTaskSuccessCommand,\r\n} from \"@aws-sdk/client-sfn\";\r\nimport { randomUUID } from \"crypto\";\r\n\r\nconst ddb = new DynamoDBClient({});\r\nconst sfn = new SFNClient({});\r\n\r\nconst { TABLE_NAME = \"\", APPROVAL_SM_ARN = \"\" } = process.env;\r\nif (!TABLE_NAME) {\r\n  throw new Error(\"Missing env: TABLE_NAME\");\r\n}\r\n\r\nconst nowIso = () => new Date().toISOString();\r\nconst S = (v: string) => ({ S: v });\r\n\r\ntype AppSyncEvent = {\r\n  info: { fieldName: string };\r\n  arguments: any;\r\n  identity?: any;\r\n};\r\n\r\ntype ClosetStatus = \"DRAFT\" | \"PENDING\" | \"APPROVED\" | \"REJECTED\" | \"PUBLISHED\";\r\ntype ClosetAudience = \"PUBLIC\" | \"BESTIE\" | \"EXCLUSIVE\";\r\n\r\ntype ClosetItem = {\r\n  id: string;\r\n  userId: string; // what the frontend expects\r\n  ownerSub: string;\r\n  status: ClosetStatus;\r\n  createdAt: string;\r\n  updatedAt: string;\r\n  mediaKey: string;\r\n  rawMediaKey?: string;\r\n  title: string;\r\n  reason?: string;\r\n  audience: ClosetAudience;\r\n};\r\n\r\ntype AdminCreateClosetItemInput = {\r\n  title: string;\r\n  rawMediaKey: string;\r\n  season?: string | null;\r\n  vibes?: string | null;\r\n};\r\n\r\nfunction getIdentity(event: AppSyncEvent) {\r\n  const claims = (event.identity as any)?.claims || {};\r\n  const sub = (event.identity as any)?.sub || claims.sub;\r\n  const groupsRaw = claims[\"cognito:groups\"];\r\n  const groups = Array.isArray(groupsRaw)\r\n    ? groupsRaw\r\n    : String(groupsRaw || \"\")\r\n        .split(\",\")\r\n        .map((x) => x.trim())\r\n        .filter(Boolean);\r\n\r\n  const isAdmin = groups.includes(\"ADMIN\") || groups.includes(\"COLLAB\");\r\n\r\n  if (!sub) {\r\n    throw new Error(\"Unauthorized\");\r\n  }\r\n\r\n  return { sub, isAdmin };\r\n}\r\n\r\nfunction mapItem(raw: any): ClosetItem {\r\n  return {\r\n    id: raw.id.S!,\r\n    userId: raw.ownerSub.S!,\r\n    ownerSub: raw.ownerSub.S!,\r\n    status: raw.status.S! as ClosetStatus,\r\n    createdAt: raw.createdAt.S!,\r\n    updatedAt: raw.updatedAt.S!,\r\n    mediaKey: raw.mediaKey?.S ?? \"\",\r\n    rawMediaKey: raw.rawMediaKey?.S ?? \"\",\r\n    title: raw.title?.S ?? \"\",\r\n    reason: raw.reason?.S ?? \"\",\r\n    audience: (raw.audience?.S as ClosetAudience) || \"PUBLIC\",\r\n  };\r\n}\r\n\r\n/* ===================== Queries ===================== */\r\n\r\n/** Admin queue \u2013 pending items */\r\nexport const adminListPending = async (\r\n  event: AppSyncEvent,\r\n): Promise<ClosetItem[]> => {\r\n  const { isAdmin } = getIdentity(event);\r\n  if (!isAdmin) {\r\n    throw new Error(\"Forbidden\");\r\n  }\r\n\r\n  const out = await ddb.send(\r\n    new QueryCommand({\r\n      TableName: TABLE_NAME,\r\n      IndexName: \"gsi2\", // status index\r\n      KeyConditionExpression: \"gsi2pk = :p\",\r\n      ExpressionAttributeValues: { \":p\": S(\"STATUS#PENDING\") },\r\n      ScanIndexForward: true,\r\n      ProjectionExpression:\r\n        \"id, ownerSub, #s, createdAt, updatedAt, mediaKey, rawMediaKey, title, reason, audience\",\r\n      ExpressionAttributeNames: { \"#s\": \"status\" },\r\n    }),\r\n  );\r\n\r\n  return (out.Items || []).map((it) =>\r\n    mapItem({\r\n      ...it,\r\n      status: it[\"status\"],\r\n    }),\r\n  );\r\n};\r\n\r\n/** Fan-facing closet feed \u2013 approved looks */\r\nexport const closetFeed = async (\r\n  event: AppSyncEvent,\r\n): Promise<ClosetItem[]> => {\r\n  // Any signed-in user can see the feed; still parse identity for sub\r\n  getIdentity(event); // will throw if not authed\r\n\r\n  const { sort = \"NEWEST\" } = event.arguments || {};\r\n\r\n  const out = await ddb.send(\r\n    new QueryCommand({\r\n      TableName: TABLE_NAME,\r\n      IndexName: \"gsi2\",\r\n      KeyConditionExpression: \"gsi2pk = :p\",\r\n      ExpressionAttributeValues: { \":p\": S(\"STATUS#APPROVED\") },\r\n      // newest first (gsi2sk is timestamp string)\r\n      ScanIndexForward: sort === \"OLDEST\",\r\n      ProjectionExpression:\r\n        \"id, ownerSub, #s, createdAt, updatedAt, mediaKey, rawMediaKey, title, audience\",\r\n      ExpressionAttributeNames: { \"#s\": \"status\" },\r\n    }),\r\n  );\r\n\r\n  const items = (out.Items || []).map((it) =>\r\n    mapItem({\r\n      ...it,\r\n      status: it[\"status\"],\r\n    }),\r\n  );\r\n\r\n  if (sort === \"MOST_LOVED\") {\r\n    // TODO: if/when you add loveCount, sort by it here.\r\n    return items;\r\n  }\r\n\r\n  return items;\r\n};\r\n\r\n/** Simple alias used for admin \"Top looks\" tab \u2013 same as closetFeed for now */\r\nexport const topClosetLooks = async (\r\n  event: AppSyncEvent,\r\n): Promise<ClosetItem[]> => {\r\n  return closetFeed({ ...event, arguments: { sort: \"NEWEST\" } });\r\n};\r\n\r\n/* ===================== Mutations ===================== */\r\n\r\n/**\r\n * Admin creates a new closet item.\r\n * The frontend has already uploaded the raw image via signedUpload(),\r\n * and passes rawMediaKey here. A separate background-removal worker\r\n * will later look up this item by rawMediaKey and set mediaKey.\r\n */\r\nexport const adminCreateClosetItem = async (\r\n  event: AppSyncEvent,\r\n): Promise<ClosetItem> => {\r\n  const { sub, isAdmin } = getIdentity(event);\r\n  if (!isAdmin) throw new Error(\"Forbidden\");\r\n\r\n  const input = event.arguments?.input as AdminCreateClosetItemInput;\r\n  if (!input?.title) throw new Error(\"title required\");\r\n  if (!input?.rawMediaKey) throw new Error(\"rawMediaKey required\");\r\n\r\n  const id = randomUUID();\r\n  const now = nowIso();\r\n\r\n  const audience: ClosetAudience = \"PUBLIC\";\r\n\r\n  const item = {\r\n    pk: S(`ITEM#${id}`),\r\n    sk: S(\"META\"),\r\n    id: S(id),\r\n    ownerSub: S(sub),\r\n    status: S(\"PENDING\"),\r\n    createdAt: S(now),\r\n    updatedAt: S(now),\r\n    title: S(input.title.trim()),\r\n    mediaKey: S(\"\"), // will be filled by background-removal worker\r\n    rawMediaKey: S(input.rawMediaKey),\r\n    audience: S(audience),\r\n    gsi2pk: S(\"STATUS#PENDING\"),\r\n    gsi2sk: S(now),\r\n  } as const;\r\n\r\n  // Optionally persist extra metadata\r\n  if (input.season) {\r\n    (item as any).season = S(input.season);\r\n  }\r\n  if (input.vibes) {\r\n    (item as any).vibes = S(input.vibes);\r\n  }\r\n\r\n  await ddb.send(\r\n    new PutItemCommand({\r\n      TableName: TABLE_NAME,\r\n      Item: item,\r\n    }),\r\n  );\r\n\r\n  return mapItem(item);\r\n};\r\n\r\n/** Approve an item */\r\nexport const adminApproveItem = async (\r\n  event: AppSyncEvent,\r\n): Promise<ClosetItem> => {\r\n  const { isAdmin } = getIdentity(event);\r\n  if (!isAdmin) throw new Error(\"Forbidden\");\r\n\r\n  const id = event.arguments?.id as string;\r\n  if (!id) throw new Error(\"id required\");\r\n\r\n  const now = nowIso();\r\n\r\n  const out = await ddb.send(\r\n    new UpdateItemCommand({\r\n      TableName: TABLE_NAME,\r\n      Key: { pk: S(`ITEM#${id}`), sk: S(\"META\") },\r\n      UpdateExpression:\r\n        \"SET #s = :s, updatedAt = :u, gsi2pk = :g2pk, gsi2sk = :g2sk REMOVE reason, approvalToken\",\r\n      ExpressionAttributeNames: { \"#s\": \"status\" },\r\n      ExpressionAttributeValues: {\r\n        \":s\": S(\"APPROVED\"),\r\n        \":u\": S(now),\r\n        \":g2pk\": S(\"STATUS#APPROVED\"),\r\n        \":g2sk\": S(now),\r\n      },\r\n      ReturnValues: \"ALL_OLD\",\r\n    }),\r\n  );\r\n\r\n  const prev = out.Attributes!;\r\n  const token = prev.approvalToken?.S;\r\n\r\n  if (token) {\r\n    // If the approval workflow was waiting, unblock it\r\n    try {\r\n      await sfn.send(\r\n        new SendTaskSuccessCommand({\r\n          taskToken: token,\r\n          output: JSON.stringify({ approved: true }),\r\n        }),\r\n      );\r\n    } catch {\r\n      // best effort\r\n    }\r\n  }\r\n\r\n  return mapItem({\r\n    ...prev,\r\n    status: S(\"APPROVED\"),\r\n  });\r\n};\r\n\r\n/** Reject an item */\r\nexport const adminRejectItem = async (\r\n  event: AppSyncEvent,\r\n): Promise<ClosetItem> => {\r\n  const { isAdmin } = getIdentity(event);\r\n  if (!isAdmin) throw new Error(\"Forbidden\");\r\n\r\n  const id = event.arguments?.id as string;\r\n  const reason = (event.arguments?.reason as string) || \"\";\r\n  if (!id) throw new Error(\"id required\");\r\n\r\n  const now = nowIso();\r\n\r\n  const out = await ddb.send(\r\n    new UpdateItemCommand({\r\n      TableName: TABLE_NAME,\r\n      Key: { pk: S(`ITEM#${id}`), sk: S(\"META\") },\r\n      UpdateExpression:\r\n        \"SET #s = :s, updatedAt = :u, gsi2pk = :g2pk, gsi2sk = :g2sk, reason = :r REMOVE approvalToken\",\r\n      ExpressionAttributeNames: { \"#s\": \"status\" },\r\n      ExpressionAttributeValues: {\r\n        \":s\": S(\"REJECTED\"),\r\n        \":u\": S(now),\r\n        \":g2pk\": S(\"STATUS#REJECTED\"),\r\n        \":g2sk\": S(now),\r\n        \":r\": S(reason),\r\n      },\r\n      ReturnValues: \"ALL_OLD\",\r\n    }),\r\n  );\r\n\r\n  const prev = out.Attributes!;\r\n  const token = prev.approvalToken?.S;\r\n\r\n  if (token) {\r\n    try {\r\n      await sfn.send(\r\n        new SendTaskFailureCommand({\r\n          taskToken: token,\r\n          error: \"Rejected\",\r\n          cause: reason || \"Rejected by admin\",\r\n        }),\r\n      );\r\n    } catch {\r\n      // best effort\r\n    }\r\n  }\r\n\r\n  return mapItem({\r\n    ...prev,\r\n    status: S(\"REJECTED\"),\r\n    reason: S(reason),\r\n  });\r\n};\r\n\r\n/** Change item audience (PUBLIC / BESTIE / EXCLUSIVE) */\r\nexport const adminSetClosetAudience = async (\r\n  event: AppSyncEvent,\r\n): Promise<ClosetItem> => {\r\n  const { isAdmin } = getIdentity(event);\r\n  if (!isAdmin) throw new Error(\"Forbidden\");\r\n\r\n  const id = event.arguments?.id as string;\r\n  const audience = event.arguments?.audience as ClosetAudience;\r\n  if (!id) throw new Error(\"id required\");\r\n  if (!audience) throw new Error(\"audience required\");\r\n\r\n  const now = nowIso();\r\n\r\n  const out = await ddb.send(\r\n    new UpdateItemCommand({\r\n      TableName: TABLE_NAME,\r\n      Key: { pk: S(`ITEM#${id}`), sk: S(\"META\") },\r\n      UpdateExpression: \"SET audience = :aud, updatedAt = :u\",\r\n      ExpressionAttributeValues: {\r\n        \":aud\": S(audience),\r\n        \":u\": S(now),\r\n      },\r\n      ReturnValues: \"ALL_NEW\",\r\n    }),\r\n  );\r\n\r\n  const updated = out.Attributes!;\r\n  return mapItem(updated);\r\n};\r\n\r\n/* ===================== Dispatcher (if this Lambda is used directly) ===================== */\r\n\r\nexport const handler = async (event: AppSyncEvent) => {\r\n  const f = event.info.fieldName;\r\n\r\n  if (f === \"adminListPending\") return adminListPending(event);\r\n  if (f === \"adminCreateClosetItem\") return adminCreateClosetItem(event);\r\n  if (f === \"adminApproveItem\") return adminApproveItem(event);\r\n  if (f === \"adminRejectItem\") return adminRejectItem(event);\r\n  if (f === \"adminSetClosetAudience\") return adminSetClosetAudience(event);\r\n  if (f === \"closetFeed\") return closetFeed(event);\r\n  if (f === \"topClosetLooks\") return topClosetLooks(event);\r\n\r\n  throw new Error(`No resolver for field ${f}`);\r\n};\r\n"],
  "mappings": "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",
  "names": ["admin_exports", "__export", "adminApproveItem", "adminCreateClosetItem", "adminListPending", "adminRejectItem", "adminSetClosetAudience", "closetFeed", "handler", "topClosetLooks", "__toCommonJS", "import_client_dynamodb", "import_client_sfn", "import_crypto", "ddb", "sfn", "TABLE_NAME", "APPROVAL_SM_ARN", "nowIso", "S", "v", "getIdentity", "event", "claims", "sub", "groupsRaw", "groups", "x", "isAdmin", "mapItem", "raw", "it", "sort", "items", "input", "id", "now", "item", "prev", "token", "reason", "audience", "updated", "f"]
}
