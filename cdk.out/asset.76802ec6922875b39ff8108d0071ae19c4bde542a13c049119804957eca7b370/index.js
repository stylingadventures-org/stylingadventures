"use strict";var s=Object.defineProperty;var m=Object.getOwnPropertyDescriptor;var C=Object.getOwnPropertyNames;var c=Object.prototype.hasOwnProperty;var y=(a,e)=>{for(var n in e)s(a,n,{get:e[n],enumerable:!0})},p=(a,e,n,r)=>{if(e&&typeof e=="object"||typeof e=="function")for(let t of C(e))!c.call(a,t)&&t!==n&&s(a,t,{get:()=>e[t],enumerable:!(r=m(e,t))||r.enumerable});return a};var A=a=>p(s({},"__esModule",{value:!0}),a);var w={};y(w,{handler:()=>u});module.exports=A(w);var o=require("@aws-sdk/client-dynamodb"),l=process.env.PRIME_BANK_ACCOUNT_TABLE_NAME,E=new o.DynamoDBClient({}),u=async a=>{console.log("EnforceEarningCaps event:",JSON.stringify(a));let{userId:e,amountToAward:n,role:r}=a,t=await E.send(new o.GetItemCommand({TableName:l,Key:{userId:{S:e}}})),d=r==="Bestie"?100:50,i=r==="Bestie"?500:250;return n<=d&&n<=i?(await E.send(new o.UpdateItemCommand({TableName:l,Key:{userId:{S:e}},UpdateExpression:"ADD dailyCoinTotal :delta, weeklyCoinTotal :delta SET lastDailyReset = :today, lastWeeklyReset = :today",ExpressionAttributeValues:{":delta":{N:String(n)},":today":{S:new Date().toISOString().slice(0,10)}}})),{ok:!0,userId:e,amountToAward:n}):{ok:!1,reason:"CAP_EXCEEDED",suggestedMaxAward:Math.min(d,i)}};0&&(module.exports={handler});
//# sourceMappingURL=index.js.map
