{
  "version": 3,
  "sources": ["../../lambda/creator/forecast-resolver.ts"],
  "sourcesContent": ["/**\r\n * lambda/creator/forecast-resolver.ts\r\n * \r\n * Handles Creator Forecast & Predictive Model (PCFM) queries and mutations:\r\n * - Generate creator forecasts (weekly/monthly/quarterly/yearly)\r\n * - Retrieve forecast history\r\n * - Get creator reports with analytics and predictions\r\n * - Platform-wide trend predictions\r\n * - Growth recommendations for creators\r\n * - Admin: Update analytics snapshots, generate forecasts\r\n */\r\n\r\nimport {\r\n  DynamoDBClient,\r\n  PutItemCommand,\r\n  QueryCommand,\r\n  UpdateItemCommand,\r\n  GetItemCommand,\r\n} from \"@aws-sdk/client-dynamodb\";\r\nimport { marshall, unmarshall } from \"@aws-sdk/util-dynamodb\";\r\nimport { randomUUID } from \"crypto\";\r\nimport { AppSyncIdentityCognito } from \"aws-lambda\";\r\n\r\nconst ddb = new DynamoDBClient({});\r\nconst TABLE_NAME = process.env.TABLE_NAME!;\r\n\r\ntype SAIdentity = (AppSyncIdentityCognito & { groups?: string[] | null }) | null | undefined;\r\n\r\n// \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\r\n// Auth helpers\r\n// \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\r\n\r\nfunction assertAuth(identity: SAIdentity): asserts identity {\r\n  if (!identity?.sub) throw new Error(\"Not authenticated\");\r\n}\r\n\r\nfunction isCreator(identity: SAIdentity): boolean {\r\n  const claims = (identity as any)?.claims || {};\r\n  const raw = claims[\"cognito:groups\"];\r\n  const groups = Array.isArray(raw)\r\n    ? raw\r\n    : String(raw || \"\").split(\",\").map((g) => g.trim()).filter(Boolean);\r\n\r\n  return (\r\n    groups.includes(\"CREATOR\") ||\r\n    groups.includes(\"COLLAB\") ||\r\n    groups.includes(\"ADMIN\") ||\r\n    groups.includes(\"PRIME\")\r\n  );\r\n}\r\n\r\nfunction isAdmin(identity: SAIdentity): boolean {\r\n  const claims = (identity as any)?.claims || {};\r\n  const raw = claims[\"cognito:groups\"];\r\n  const groups = Array.isArray(raw)\r\n    ? raw\r\n    : String(raw || \"\").split(\",\").map((g) => g.trim()).filter(Boolean);\r\n  return groups.includes(\"ADMIN\") || groups.includes(\"PRIME\");\r\n}\r\n\r\n// \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\r\n// Types\r\n// \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\r\n\r\ninterface CreatorForecast {\r\n  id: string;\r\n  creatorId: string;\r\n  forecastId: string;\r\n  generatedAt: string;\r\n  forecastPeriod: \"WEEKLY\" | \"MONTHLY\" | \"QUARTERLY\" | \"YEARLY\";\r\n  growthPrediction: GrowthMetrics;\r\n  audienceSentiment: SentimentAnalysis;\r\n  trendPredictions: TrendPrediction[];\r\n  riskFactors: RiskFactor[];\r\n  opportunities: Opportunity[];\r\n  recommendations: Recommendation[];\r\n  confidence: number;\r\n  lastUpdated: string;\r\n}\r\n\r\ninterface GrowthMetrics {\r\n  currentFollowers: number;\r\n  projectedFollowers: number;\r\n  growthRate: number;\r\n  engagementRate: number;\r\n  projectedEngagementRate: number;\r\n  estRevenueImpact: number;\r\n}\r\n\r\ninterface SentimentAnalysis {\r\n  overallSentiment: string;\r\n  positivePercent: number;\r\n  neutralPercent: number;\r\n  negativePercent: number;\r\n  sentimentTrend: string;\r\n  keyTopics: string[];\r\n  communityHealth: number;\r\n}\r\n\r\ninterface TrendPrediction {\r\n  id: string;\r\n  forecastId: string;\r\n  trendName: string;\r\n  category: string;\r\n  probability: number;\r\n  relevance: string;\r\n  actionItems: string[];\r\n}\r\n\r\ninterface RiskFactor {\r\n  id: string;\r\n  forecastId: string;\r\n  riskName: string;\r\n  severity: \"LOW\" | \"MEDIUM\" | \"HIGH\" | \"CRITICAL\";\r\n  probability: number;\r\n  potentialImpact: string;\r\n  mitigationStrategy: string;\r\n}\r\n\r\ninterface Opportunity {\r\n  id: string;\r\n  forecastId: string;\r\n  opportunityName: string;\r\n  category: string;\r\n  estimatedValue: number;\r\n  timeWindow: string;\r\n  actionItems: string[];\r\n  difficulty: string;\r\n}\r\n\r\ninterface Recommendation {\r\n  id: string;\r\n  forecastId: string;\r\n  priority: number;\r\n  title: string;\r\n  description: string;\r\n  expectedOutcome: string;\r\n  timeframe: string;\r\n  resourcesNeeded: string[];\r\n  successMetrics: string[];\r\n}\r\n\r\ninterface AnalyticsMetrics {\r\n  followers: number;\r\n  followersThisWeek: number;\r\n  engagement: number;\r\n  engagementThisWeek: number;\r\n  contentPosted: number;\r\n  avgLikes: number;\r\n  avgComments: number;\r\n  avgShares: number;\r\n  topContentType: string;\r\n  peakEngagementTime: string;\r\n}\r\n\r\n// \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\r\n// Helpers\r\n// \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\r\n\r\nfunction nowIso() {\r\n  return new Date().toISOString();\r\n}\r\n\r\nfunction pkForCreatorForecast(creatorId: string) {\r\n  return `CREATOR#${creatorId}#FORECAST`;\r\n}\r\n\r\nfunction skForForecast(forecastId: string) {\r\n  return `FORECAST#${forecastId}`;\r\n}\r\n\r\nconst ddbMarshal = (value: any) =>\r\n  marshall(value, { removeUndefinedValues: true });\r\n\r\n// \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\r\n// Queries\r\n// \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\r\n\r\nasync function handleCreatorLatestForecast(\r\n  args: { creatorId: string },\r\n  identity: SAIdentity,\r\n): Promise<CreatorForecast | null> {\r\n  assertAuth(identity);\r\n  if (!isCreator(identity)) throw new Error(\"Creator tier required\");\r\n\r\n  const res = await ddb.send(\r\n    new QueryCommand({\r\n      TableName: TABLE_NAME,\r\n      KeyConditionExpression: \"pk = :pk\",\r\n      ScanIndexForward: false,\r\n      Limit: 1,\r\n      ExpressionAttributeValues: ddbMarshal({\r\n        \":pk\": pkForCreatorForecast(args.creatorId),\r\n      }),\r\n    }),\r\n  );\r\n\r\n  const raw = (res.Items ?? [])[0];\r\n  if (!raw) return null;\r\n\r\n  return unmarshall(raw) as CreatorForecast;\r\n}\r\n\r\nasync function handleCreatorForecastHistory(\r\n  args: { creatorId: string; limit?: number; nextToken?: string },\r\n  identity: SAIdentity,\r\n): Promise<{ items: CreatorForecast[]; nextToken: string | null }> {\r\n  assertAuth(identity);\r\n  if (!isCreator(identity)) throw new Error(\"Creator tier required\");\r\n\r\n  const limit = Math.min(args.limit ?? 10, 50);\r\n\r\n  const res = await ddb.send(\r\n    new QueryCommand({\r\n      TableName: TABLE_NAME,\r\n      KeyConditionExpression: \"pk = :pk\",\r\n      ScanIndexForward: false,\r\n      Limit: limit,\r\n      ExpressionAttributeValues: ddbMarshal({\r\n        \":pk\": pkForCreatorForecast(args.creatorId),\r\n      }),\r\n      ExclusiveStartKey: args.nextToken\r\n        ? JSON.parse(Buffer.from(args.nextToken, \"base64\").toString())\r\n        : undefined,\r\n    }),\r\n  );\r\n\r\n  const items = (res.Items ?? []).map((raw) => unmarshall(raw) as CreatorForecast);\r\n\r\n  let nextToken = null;\r\n  if (res.LastEvaluatedKey) {\r\n    nextToken = Buffer.from(JSON.stringify(res.LastEvaluatedKey)).toString(\"base64\");\r\n  }\r\n\r\n  return { items, nextToken };\r\n}\r\n\r\nasync function handleCreatorReport(\r\n  args: { creatorId: string },\r\n  identity: SAIdentity,\r\n): Promise<any> {\r\n  assertAuth(identity);\r\n  if (!isCreator(identity)) throw new Error(\"Creator tier required\");\r\n\r\n  const forecast = await handleCreatorLatestForecast(args, identity);\r\n\r\n  return {\r\n    id: randomUUID(),\r\n    creatorId: args.creatorId,\r\n    reportDate: nowIso(),\r\n    analyticsSnapshot: {\r\n      followers: 10000,\r\n      followersThisWeek: 150,\r\n      engagement: 0.045,\r\n      engagementThisWeek: 0.048,\r\n      contentPosted: 5,\r\n      avgLikes: 234,\r\n      avgComments: 12,\r\n      avgShares: 8,\r\n      topContentType: \"REEL\",\r\n      peakEngagementTime: \"19:00 EST\",\r\n    },\r\n    forecasts: forecast ? [forecast] : [],\r\n    recommendations: [],\r\n  };\r\n}\r\n\r\nasync function handlePlatformTrendPredictions(\r\n  identity: SAIdentity,\r\n): Promise<TrendPrediction[]> {\r\n  assertAuth(identity);\r\n  if (!isCreator(identity)) throw new Error(\"Creator tier required\");\r\n\r\n  return [\r\n    {\r\n      id: randomUUID(),\r\n      forecastId: \"PLATFORM\",\r\n      trendName: \"Micro-Episode Format Growth\",\r\n      category: \"CONTENT_FORMAT\",\r\n      probability: 0.82,\r\n      relevance: \"HIGH\",\r\n      actionItems: [\"Create 5-10 min episodes\", \"Focus on serialization\"],\r\n    },\r\n    {\r\n      id: randomUUID(),\r\n      forecastId: \"PLATFORM\",\r\n      trendName: \"Creator Collabs on Music\",\r\n      category: \"MUSIC\",\r\n      probability: 0.76,\r\n      relevance: \"HIGH\",\r\n      actionItems: [\"Partner with producers\", \"Release duets/remixes\"],\r\n    },\r\n  ];\r\n}\r\n\r\nasync function handleCreatorGrowthRecommendations(\r\n  args: { creatorId: string },\r\n  identity: SAIdentity,\r\n): Promise<Recommendation[]> {\r\n  assertAuth(identity);\r\n  if (!isCreator(identity)) throw new Error(\"Creator tier required\");\r\n\r\n  return [\r\n    {\r\n      id: randomUUID(),\r\n      forecastId: randomUUID(),\r\n      priority: 1,\r\n      title: \"Increase posting frequency\",\r\n      description: \"Post 3-4x per week for optimal engagement\",\r\n      expectedOutcome: \"15-20% follower growth\",\r\n      timeframe: \"30 days\",\r\n      resourcesNeeded: [\"Content planning\", \"Scheduling tool\"],\r\n      successMetrics: [\"Engagement rate > 5%\", \"Follower growth > 10%\"],\r\n    },\r\n  ];\r\n}\r\n\r\n// \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\r\n// Mutations (Admin only)\r\n// \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\r\n\r\nasync function handleAdminGenerateCreatorForecast(\r\n  args: {\r\n    creatorId: string;\r\n    forecastPeriod: \"WEEKLY\" | \"MONTHLY\" | \"QUARTERLY\" | \"YEARLY\";\r\n  },\r\n  identity: SAIdentity,\r\n): Promise<CreatorForecast> {\r\n  if (!isAdmin(identity)) throw new Error(\"ADMIN required\");\r\n\r\n  const forecastId = randomUUID();\r\n  const now = nowIso();\r\n\r\n  const forecast: CreatorForecast = {\r\n    id: forecastId,\r\n    creatorId: args.creatorId,\r\n    forecastId,\r\n    generatedAt: now,\r\n    forecastPeriod: args.forecastPeriod,\r\n    growthPrediction: {\r\n      currentFollowers: 10000,\r\n      projectedFollowers: 11500,\r\n      growthRate: 0.15,\r\n      engagementRate: 0.045,\r\n      projectedEngagementRate: 0.052,\r\n      estRevenueImpact: 1200,\r\n    },\r\n    audienceSentiment: {\r\n      overallSentiment: \"POSITIVE\",\r\n      positivePercent: 72,\r\n      neutralPercent: 20,\r\n      negativePercent: 8,\r\n      sentimentTrend: \"IMPROVING\",\r\n      keyTopics: [\"Fashion\", \"Music\", \"Behind-the-scenes\"],\r\n      communityHealth: 8,\r\n    },\r\n    trendPredictions: [],\r\n    riskFactors: [\r\n      {\r\n        id: randomUUID(),\r\n        forecastId,\r\n        riskName: \"Content saturation\",\r\n        severity: \"MEDIUM\",\r\n        probability: 0.35,\r\n        potentialImpact: \"5-10% engagement drop\",\r\n        mitigationStrategy: \"Diversify content types\",\r\n      },\r\n    ],\r\n    opportunities: [\r\n      {\r\n        id: randomUUID(),\r\n        forecastId,\r\n        opportunityName: \"Sponsor partnership\",\r\n        category: \"SPONSORSHIP\",\r\n        estimatedValue: 5000,\r\n        timeWindow: \"60 days\",\r\n        actionItems: [\"Pitch deck\", \"Media kit\"],\r\n        difficulty: \"MEDIUM\",\r\n      },\r\n    ],\r\n    recommendations: [],\r\n    confidence: 0.82,\r\n    lastUpdated: now,\r\n  };\r\n\r\n  await ddb.send(\r\n    new PutItemCommand({\r\n      TableName: TABLE_NAME,\r\n      Item: ddbMarshal({\r\n        pk: pkForCreatorForecast(args.creatorId),\r\n        sk: skForForecast(forecastId),\r\n        entityType: \"CREATOR_FORECAST\",\r\n        gsi1pk: `FORECAST#PERIOD#${args.forecastPeriod}`,\r\n        gsi1sk: now,\r\n        ...forecast,\r\n      }),\r\n    }),\r\n  );\r\n\r\n  return forecast;\r\n}\r\n\r\nasync function handleAdminUpdateAnalyticsSnapshot(\r\n  args: { creatorId: string; metrics: any },\r\n  identity: SAIdentity,\r\n): Promise<AnalyticsMetrics> {\r\n  if (!isAdmin(identity)) throw new Error(\"ADMIN required\");\r\n\r\n  return args.metrics;\r\n}\r\n\r\nasync function handleAdminGeneratePlatformTrends(\r\n  identity: SAIdentity,\r\n): Promise<TrendPrediction[]> {\r\n  if (!isAdmin(identity)) throw new Error(\"ADMIN required\");\r\n\r\n  return await handlePlatformTrendPredictions(identity);\r\n}\r\n\r\n// \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\r\n// AppSync Lambda resolver entrypoint\r\n// \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\r\n\r\nexport const handler = async (event: any) => {\r\n  console.log(\"CreatorForecastResolverFn event\", JSON.stringify(event));\r\n\r\n  const fieldName = event.info?.fieldName as string | undefined;\r\n\r\n  try {\r\n    switch (fieldName) {\r\n      case \"creatorLatestForecast\":\r\n        return await handleCreatorLatestForecast(event.arguments, event.identity);\r\n\r\n      case \"creatorForecastHistory\":\r\n        return await handleCreatorForecastHistory(event.arguments, event.identity);\r\n\r\n      case \"creatorReport\":\r\n        return await handleCreatorReport(event.arguments, event.identity);\r\n\r\n      case \"platformTrendPredictions\":\r\n        return await handlePlatformTrendPredictions(event.identity);\r\n\r\n      case \"creatorGrowthRecommendations\":\r\n        return await handleCreatorGrowthRecommendations(event.arguments, event.identity);\r\n\r\n      case \"adminGenerateCreatorForecast\":\r\n        return await handleAdminGenerateCreatorForecast(event.arguments, event.identity);\r\n\r\n      case \"adminUpdateAnalyticsSnapshot\":\r\n        return await handleAdminUpdateAnalyticsSnapshot(event.arguments, event.identity);\r\n\r\n      case \"adminGeneratePlatformTrends\":\r\n        return await handleAdminGeneratePlatformTrends(event.identity);\r\n\r\n      default:\r\n        throw new Error(`Unknown field: ${fieldName}`);\r\n    }\r\n  } catch (err: any) {\r\n    console.error(\"CreatorForecastResolverFn error\", err);\r\n    throw err;\r\n  }\r\n};\r\n"],
  "mappings": "yaAAA,IAAAA,EAAA,GAAAC,EAAAD,EAAA,aAAAE,IAAA,eAAAC,EAAAH,GAYA,IAAAI,EAMO,oCACPC,EAAqC,kCACrCC,EAA2B,kBAGrBC,EAAM,IAAI,iBAAe,CAAC,CAAC,EAC3BC,EAAa,QAAQ,IAAI,WAQ/B,SAASC,EAAWC,EAAwC,CAC1D,GAAI,CAACA,GAAU,IAAK,MAAM,IAAI,MAAM,mBAAmB,CACzD,CAEA,SAASC,EAAUD,EAA+B,CAEhD,IAAME,GADUF,GAAkB,QAAU,CAAC,GAC1B,gBAAgB,EAC7BG,EAAS,MAAM,QAAQD,CAAG,EAC5BA,EACA,OAAOA,GAAO,EAAE,EAAE,MAAM,GAAG,EAAE,IAAKE,GAAMA,EAAE,KAAK,CAAC,EAAE,OAAO,OAAO,EAEpE,OACED,EAAO,SAAS,SAAS,GACzBA,EAAO,SAAS,QAAQ,GACxBA,EAAO,SAAS,OAAO,GACvBA,EAAO,SAAS,OAAO,CAE3B,CAEA,SAASE,EAAQL,EAA+B,CAE9C,IAAME,GADUF,GAAkB,QAAU,CAAC,GAC1B,gBAAgB,EAC7BG,EAAS,MAAM,QAAQD,CAAG,EAC5BA,EACA,OAAOA,GAAO,EAAE,EAAE,MAAM,GAAG,EAAE,IAAKE,GAAMA,EAAE,KAAK,CAAC,EAAE,OAAO,OAAO,EACpE,OAAOD,EAAO,SAAS,OAAO,GAAKA,EAAO,SAAS,OAAO,CAC5D,CAqGA,SAASG,GAAS,CAChB,OAAO,IAAI,KAAK,EAAE,YAAY,CAChC,CAEA,SAASC,EAAqBC,EAAmB,CAC/C,MAAO,WAAWA,CAAS,WAC7B,CAEA,SAASC,EAAcC,EAAoB,CACzC,MAAO,YAAYA,CAAU,EAC/B,CAEA,IAAMC,EAAcC,MAClB,YAASA,EAAO,CAAE,sBAAuB,EAAK,CAAC,EAMjD,eAAeC,EACbC,EACAd,EACiC,CAEjC,GADAD,EAAWC,CAAQ,EACf,CAACC,EAAUD,CAAQ,EAAG,MAAM,IAAI,MAAM,uBAAuB,EAcjE,IAAME,IAZM,MAAML,EAAI,KACpB,IAAI,eAAa,CACf,UAAWC,EACX,uBAAwB,WACxB,iBAAkB,GAClB,MAAO,EACP,0BAA2Ba,EAAW,CACpC,MAAOJ,EAAqBO,EAAK,SAAS,CAC5C,CAAC,CACH,CAAC,CACH,GAEiB,OAAS,CAAC,GAAG,CAAC,EAC/B,OAAKZ,KAEE,cAAWA,CAAG,EAFJ,IAGnB,CAEA,eAAea,EACbD,EACAd,EACiE,CAEjE,GADAD,EAAWC,CAAQ,EACf,CAACC,EAAUD,CAAQ,EAAG,MAAM,IAAI,MAAM,uBAAuB,EAEjE,IAAMgB,EAAQ,KAAK,IAAIF,EAAK,OAAS,GAAI,EAAE,EAErCG,EAAM,MAAMpB,EAAI,KACpB,IAAI,eAAa,CACf,UAAWC,EACX,uBAAwB,WACxB,iBAAkB,GAClB,MAAOkB,EACP,0BAA2BL,EAAW,CACpC,MAAOJ,EAAqBO,EAAK,SAAS,CAC5C,CAAC,EACD,kBAAmBA,EAAK,UACpB,KAAK,MAAM,OAAO,KAAKA,EAAK,UAAW,QAAQ,EAAE,SAAS,CAAC,EAC3D,MACN,CAAC,CACH,EAEMI,GAASD,EAAI,OAAS,CAAC,GAAG,IAAKf,MAAQ,cAAWA,CAAG,CAAoB,EAE3EiB,EAAY,KAChB,OAAIF,EAAI,mBACNE,EAAY,OAAO,KAAK,KAAK,UAAUF,EAAI,gBAAgB,CAAC,EAAE,SAAS,QAAQ,GAG1E,CAAE,MAAAC,EAAO,UAAAC,CAAU,CAC5B,CAEA,eAAeC,EACbN,EACAd,EACc,CAEd,GADAD,EAAWC,CAAQ,EACf,CAACC,EAAUD,CAAQ,EAAG,MAAM,IAAI,MAAM,uBAAuB,EAEjE,IAAMqB,EAAW,MAAMR,EAA4BC,EAAMd,CAAQ,EAEjE,MAAO,CACL,MAAI,cAAW,EACf,UAAWc,EAAK,UAChB,WAAYR,EAAO,EACnB,kBAAmB,CACjB,UAAW,IACX,kBAAmB,IACnB,WAAY,KACZ,mBAAoB,KACpB,cAAe,EACf,SAAU,IACV,YAAa,GACb,UAAW,EACX,eAAgB,OAChB,mBAAoB,WACtB,EACA,UAAWe,EAAW,CAACA,CAAQ,EAAI,CAAC,EACpC,gBAAiB,CAAC,CACpB,CACF,CAEA,eAAeC,EACbtB,EAC4B,CAE5B,GADAD,EAAWC,CAAQ,EACf,CAACC,EAAUD,CAAQ,EAAG,MAAM,IAAI,MAAM,uBAAuB,EAEjE,MAAO,CACL,CACE,MAAI,cAAW,EACf,WAAY,WACZ,UAAW,8BACX,SAAU,iBACV,YAAa,IACb,UAAW,OACX,YAAa,CAAC,2BAA4B,wBAAwB,CACpE,EACA,CACE,MAAI,cAAW,EACf,WAAY,WACZ,UAAW,2BACX,SAAU,QACV,YAAa,IACb,UAAW,OACX,YAAa,CAAC,yBAA0B,uBAAuB,CACjE,CACF,CACF,CAEA,eAAeuB,EACbT,EACAd,EAC2B,CAE3B,GADAD,EAAWC,CAAQ,EACf,CAACC,EAAUD,CAAQ,EAAG,MAAM,IAAI,MAAM,uBAAuB,EAEjE,MAAO,CACL,CACE,MAAI,cAAW,EACf,cAAY,cAAW,EACvB,SAAU,EACV,MAAO,6BACP,YAAa,4CACb,gBAAiB,yBACjB,UAAW,UACX,gBAAiB,CAAC,mBAAoB,iBAAiB,EACvD,eAAgB,CAAC,uBAAwB,uBAAuB,CAClE,CACF,CACF,CAMA,eAAewB,EACbV,EAIAd,EAC0B,CAC1B,GAAI,CAACK,EAAQL,CAAQ,EAAG,MAAM,IAAI,MAAM,gBAAgB,EAExD,IAAMU,KAAa,cAAW,EACxBe,EAAMnB,EAAO,EAEbe,EAA4B,CAChC,GAAIX,EACJ,UAAWI,EAAK,UAChB,WAAAJ,EACA,YAAae,EACb,eAAgBX,EAAK,eACrB,iBAAkB,CAChB,iBAAkB,IAClB,mBAAoB,MACpB,WAAY,IACZ,eAAgB,KAChB,wBAAyB,KACzB,iBAAkB,IACpB,EACA,kBAAmB,CACjB,iBAAkB,WAClB,gBAAiB,GACjB,eAAgB,GAChB,gBAAiB,EACjB,eAAgB,YAChB,UAAW,CAAC,UAAW,QAAS,mBAAmB,EACnD,gBAAiB,CACnB,EACA,iBAAkB,CAAC,EACnB,YAAa,CACX,CACE,MAAI,cAAW,EACf,WAAAJ,EACA,SAAU,qBACV,SAAU,SACV,YAAa,IACb,gBAAiB,wBACjB,mBAAoB,yBACtB,CACF,EACA,cAAe,CACb,CACE,MAAI,cAAW,EACf,WAAAA,EACA,gBAAiB,sBACjB,SAAU,cACV,eAAgB,IAChB,WAAY,UACZ,YAAa,CAAC,aAAc,WAAW,EACvC,WAAY,QACd,CACF,EACA,gBAAiB,CAAC,EAClB,WAAY,IACZ,YAAae,CACf,EAEA,aAAM5B,EAAI,KACR,IAAI,iBAAe,CACjB,UAAWC,EACX,KAAMa,EAAW,CACf,GAAIJ,EAAqBO,EAAK,SAAS,EACvC,GAAIL,EAAcC,CAAU,EAC5B,WAAY,mBACZ,OAAQ,mBAAmBI,EAAK,cAAc,GAC9C,OAAQW,EACR,GAAGJ,CACL,CAAC,CACH,CAAC,CACH,EAEOA,CACT,CAEA,eAAeK,EACbZ,EACAd,EAC2B,CAC3B,GAAI,CAACK,EAAQL,CAAQ,EAAG,MAAM,IAAI,MAAM,gBAAgB,EAExD,OAAOc,EAAK,OACd,CAEA,eAAea,EACb3B,EAC4B,CAC5B,GAAI,CAACK,EAAQL,CAAQ,EAAG,MAAM,IAAI,MAAM,gBAAgB,EAExD,OAAO,MAAMsB,EAA+BtB,CAAQ,CACtD,CAMO,IAAMR,EAAU,MAAOoC,GAAe,CAC3C,QAAQ,IAAI,kCAAmC,KAAK,UAAUA,CAAK,CAAC,EAEpE,IAAMC,EAAYD,EAAM,MAAM,UAE9B,GAAI,CACF,OAAQC,EAAW,CACjB,IAAK,wBACH,OAAO,MAAMhB,EAA4Be,EAAM,UAAWA,EAAM,QAAQ,EAE1E,IAAK,yBACH,OAAO,MAAMb,EAA6Ba,EAAM,UAAWA,EAAM,QAAQ,EAE3E,IAAK,gBACH,OAAO,MAAMR,EAAoBQ,EAAM,UAAWA,EAAM,QAAQ,EAElE,IAAK,2BACH,OAAO,MAAMN,EAA+BM,EAAM,QAAQ,EAE5D,IAAK,+BACH,OAAO,MAAML,EAAmCK,EAAM,UAAWA,EAAM,QAAQ,EAEjF,IAAK,+BACH,OAAO,MAAMJ,EAAmCI,EAAM,UAAWA,EAAM,QAAQ,EAEjF,IAAK,+BACH,OAAO,MAAMF,EAAmCE,EAAM,UAAWA,EAAM,QAAQ,EAEjF,IAAK,8BACH,OAAO,MAAMD,EAAkCC,EAAM,QAAQ,EAE/D,QACE,MAAM,IAAI,MAAM,kBAAkBC,CAAS,EAAE,CACjD,CACF,OAASC,EAAU,CACjB,cAAQ,MAAM,kCAAmCA,CAAG,EAC9CA,CACR,CACF",
  "names": ["forecast_resolver_exports", "__export", "handler", "__toCommonJS", "import_client_dynamodb", "import_util_dynamodb", "import_crypto", "ddb", "TABLE_NAME", "assertAuth", "identity", "isCreator", "raw", "groups", "g", "isAdmin", "nowIso", "pkForCreatorForecast", "creatorId", "skForForecast", "forecastId", "ddbMarshal", "value", "handleCreatorLatestForecast", "args", "handleCreatorForecastHistory", "limit", "res", "items", "nextToken", "handleCreatorReport", "forecast", "handlePlatformTrendPredictions", "handleCreatorGrowthRecommendations", "handleAdminGenerateCreatorForecast", "now", "handleAdminUpdateAnalyticsSnapshot", "handleAdminGeneratePlatformTrends", "event", "fieldName", "err"]
}
