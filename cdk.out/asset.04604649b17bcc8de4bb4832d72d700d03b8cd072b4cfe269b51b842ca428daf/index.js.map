{
  "version": 3,
  "sources": ["../../lambda/graphql/index.ts"],
  "sourcesContent": ["// lambda/graphql/index.ts\r\nimport { randomUUID } from \"crypto\";\r\nimport { DynamoDBClient } from \"@aws-sdk/client-dynamodb\";\r\nimport {\r\n  DynamoDBDocumentClient,\r\n  GetCommand,\r\n  PutCommand,\r\n  UpdateCommand,\r\n  DeleteCommand,\r\n  QueryCommand,\r\n} from \"@aws-sdk/lib-dynamodb\";\r\nimport type {\r\n  AppSyncResolverEvent,\r\n  AppSyncIdentityCognito,\r\n} from \"aws-lambda\";\r\nimport { SFNClient, StartExecutionCommand } from \"@aws-sdk/client-sfn\";\r\n\r\nconst TABLE = process.env.TABLE_NAME!;\r\nconst APPROVAL_SM_ARN = process.env.APPROVAL_SM_ARN || \"\";\r\n\r\nconst ddb = DynamoDBDocumentClient.from(new DynamoDBClient({}));\r\nconst sfn = new SFNClient({});\r\n\r\n// \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\r\n// Helpers\r\n// \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\r\ntype ClosetStatus = \"DRAFT\" | \"PENDING\" | \"APPROVED\" | \"REJECTED\" | \"PUBLISHED\";\r\n\r\ninterface ClosetItem {\r\n  id: string;\r\n  ownerSub: string;\r\n  title?: string | null;\r\n  status: ClosetStatus;\r\n  mediaKey?: string | null;\r\n  createdAt: string;\r\n  updatedAt: string;\r\n  // single-table attributes:\r\n  pk?: string;\r\n  sk?: string;\r\n  gsi1pk?: string;\r\n  gsi1sk?: string;\r\n  gsi2pk?: string;\r\n  gsi2sk?: string;\r\n  approvalToken?: string;\r\n  reason?: string | null;\r\n}\r\n\r\nconst nowIso = () => new Date().toISOString();\r\nconst isAdmin = (ident?: AppSyncIdentityCognito) => {\r\n  const groups = (ident as any)?.claims?.[\"cognito:groups\"];\r\n  return Array.isArray(groups)\r\n    ? groups.includes(\"ADMIN\")\r\n    : `${groups || \"\"}`.includes(\"ADMIN\");\r\n};\r\n\r\nconst assertAuth = (sub?: string) => {\r\n  if (!sub) throw new Error(\"Unauthenticated\");\r\n};\r\n\r\nconst keysForId = (id: string) => ({\r\n  pk: `ITEM#${id}`,\r\n  sk: \"META\",\r\n});\r\n\r\nconst toPublic = (raw: any): ClosetItem => ({\r\n  id: raw.id,\r\n  ownerSub: raw.ownerSub,\r\n  title: raw.title ?? null,\r\n  status: raw.status,\r\n  mediaKey: raw.mediaKey ?? null,\r\n  createdAt: raw.createdAt,\r\n  updatedAt: raw.updatedAt,\r\n});\r\n\r\n// \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\r\n// Resolvers\r\n// \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\r\nexport const handler = async (event: AppSyncResolverEvent<any>) => {\r\n  const field = event.info.fieldName;\r\n  const ident = event.identity as AppSyncIdentityCognito | undefined;\r\n  const sub = ident?.sub;\r\n\r\n  // ------------------ Query.myCloset ------------------\r\n  if (field === \"myCloset\") {\r\n    assertAuth(sub);\r\n\r\n    // Most-recent first (by created/updated time)\r\n    const out = await ddb.send(\r\n      new QueryCommand({\r\n        TableName: TABLE,\r\n        IndexName: \"gsi1\",\r\n        KeyConditionExpression: \"gsi1pk = :p\",\r\n        ExpressionAttributeValues: {\r\n          \":p\": `OWNER#${sub}`,\r\n        },\r\n        ScanIndexForward: false,\r\n        Limit: 50,\r\n      })\r\n    );\r\n\r\n    return (out.Items || [])\r\n      .filter((x) => x.sk === \"META\")\r\n      .map(toPublic);\r\n  }\r\n\r\n  // ------------------ Mutation.createClosetItem ------------------\r\n  if (field === \"createClosetItem\") {\r\n    assertAuth(sub);\r\n    const { title, mediaKey } = (event.arguments || {}) as {\r\n      title?: string | null;\r\n      mediaKey?: string | null;\r\n    };\r\n\r\n    const id = randomUUID();\r\n    const ts = nowIso();\r\n\r\n    const item: ClosetItem = {\r\n      id,\r\n      ownerSub: sub!,\r\n      title: (title ?? \"\").trim() || null,\r\n      mediaKey: (mediaKey ?? \"\").trim() || null,\r\n      status: \"DRAFT\",\r\n      createdAt: ts,\r\n      updatedAt: ts,\r\n    };\r\n\r\n    await ddb.send(\r\n      new PutCommand({\r\n        TableName: TABLE,\r\n        Item: {\r\n          ...item,\r\n          ...keysForId(id),\r\n          gsi1pk: `OWNER#${sub}`,\r\n          gsi1sk: ts,\r\n          gsi2pk: `STATUS#DRAFT`,\r\n          gsi2sk: ts,\r\n        },\r\n        ConditionExpression: \"attribute_not_exists(pk)\",\r\n      })\r\n    );\r\n\r\n    return item;\r\n  }\r\n\r\n  // ------------------ Mutation.updateClosetItem ------------------\r\n  if (field === \"updateClosetItem\") {\r\n    assertAuth(sub);\r\n    const { id, title, mediaKey } = event.arguments as {\r\n      id: string;\r\n      title?: string | null;\r\n      mediaKey?: string | null;\r\n    };\r\n\r\n    // Ownership check\r\n    const got = await ddb.send(\r\n      new GetCommand({\r\n        TableName: TABLE,\r\n        Key: keysForId(id),\r\n      })\r\n    );\r\n    if (!got.Item) throw new Error(\"Not found\");\r\n    if (got.Item.ownerSub !== sub) throw new Error(\"Forbidden\");\r\n\r\n    const ts = nowIso();\r\n    const expr: string[] = [\"updatedAt = :u\"];\r\n    const values: Record<string, any> = { \":u\": ts };\r\n\r\n    if (typeof title !== \"undefined\") {\r\n      expr.push(\"#t = :t\");\r\n      values[\":t\"] = title ?? null;\r\n    }\r\n    if (typeof mediaKey !== \"undefined\") {\r\n      expr.push(\"mediaKey = :m\");\r\n      values[\":m\"] = mediaKey ?? null;\r\n    }\r\n\r\n    const updated = await ddb.send(\r\n      new UpdateCommand({\r\n        TableName: TABLE,\r\n        Key: keysForId(id),\r\n        UpdateExpression: `SET ${expr.join(\", \")}`,\r\n        ExpressionAttributeValues: values,\r\n        ExpressionAttributeNames: { \"#t\": \"title\" },\r\n        ReturnValues: \"ALL_NEW\",\r\n      })\r\n    );\r\n\r\n    return toPublic(updated.Attributes);\r\n  }\r\n\r\n  // ------------------ Mutation.updateClosetMediaKey ------------------\r\n  if (field === \"updateClosetMediaKey\") {\r\n    assertAuth(sub);\r\n    const { id, key } = event.arguments as { id: string; key: string };\r\n\r\n    const got = await ddb.send(\r\n      new GetCommand({\r\n        TableName: TABLE,\r\n        Key: keysForId(id),\r\n      })\r\n    );\r\n    if (!got.Item) throw new Error(\"Not found\");\r\n    if (got.Item.ownerSub !== sub) throw new Error(\"Forbidden\");\r\n\r\n    const ts = nowIso();\r\n    await ddb.send(\r\n      new UpdateCommand({\r\n        TableName: TABLE,\r\n        Key: keysForId(id),\r\n        UpdateExpression: \"SET mediaKey = :k, updatedAt = :u\",\r\n        ExpressionAttributeValues: { \":k\": key, \":u\": ts },\r\n      })\r\n    );\r\n    return true;\r\n  }\r\n\r\n  // ------------------ Mutation.deleteClosetItem ------------------\r\n  if (field === \"deleteClosetItem\") {\r\n    assertAuth(sub);\r\n    const { id } = event.arguments as { id: string };\r\n\r\n    const got = await ddb.send(\r\n      new GetCommand({\r\n        TableName: TABLE,\r\n        Key: keysForId(id),\r\n      })\r\n    );\r\n    if (!got.Item) throw new Error(\"Not found\");\r\n    if (got.Item.ownerSub !== sub && !isAdmin(ident))\r\n      throw new Error(\"Forbidden\");\r\n\r\n    await ddb.send(\r\n      new DeleteCommand({\r\n        TableName: TABLE,\r\n        Key: keysForId(id),\r\n      })\r\n    );\r\n    return true;\r\n  }\r\n\r\n  // ------------------ Mutation.requestClosetApproval ------------------\r\n  if (field === \"requestClosetApproval\") {\r\n    assertAuth(sub);\r\n    const { id } = event.arguments as { id: string };\r\n\r\n    const got = await ddb.send(\r\n      new GetCommand({\r\n        TableName: TABLE,\r\n        Key: keysForId(id),\r\n      })\r\n    );\r\n    if (!got.Item) throw new Error(\"Not found\");\r\n    if (got.Item.ownerSub !== sub) throw new Error(\"Forbidden\");\r\n\r\n    const ts = nowIso();\r\n\r\n    // Move to PENDING and index on gsi2\r\n    await ddb.send(\r\n      new UpdateCommand({\r\n        TableName: TABLE,\r\n        Key: keysForId(id),\r\n        UpdateExpression:\r\n          \"SET #s = :p, gsi2pk = :g, gsi2sk = :ts, updatedAt = :ts\",\r\n        ExpressionAttributeNames: { \"#s\": \"status\" },\r\n        ExpressionAttributeValues: {\r\n          \":p\": \"PENDING\",\r\n          \":g\": \"STATUS#PENDING\",\r\n          \":ts\": ts,\r\n        },\r\n      })\r\n    );\r\n\r\n    // Kick off approval state machine (human-in-the-loop via SNS)\r\n    if (APPROVAL_SM_ARN) {\r\n      await sfn.send(\r\n        new StartExecutionCommand({\r\n          stateMachineArn: APPROVAL_SM_ARN,\r\n          input: JSON.stringify({\r\n            itemId: id,\r\n            ownerSub: sub,\r\n            // other fields if you want\u2026\r\n          }),\r\n        })\r\n      );\r\n    }\r\n\r\n    return true;\r\n  }\r\n\r\n  // ------------------ Query.adminListPending ------------------\r\n  if (field === \"adminListPending\") {\r\n    if (!isAdmin(ident)) throw new Error(\"Not authorized\");\r\n\r\n    const args = (event.arguments || {}) as {\r\n      limit?: number | null;\r\n      nextToken?: string | null;\r\n    };\r\n\r\n    const limit = Math.min(Math.max(args.limit ?? 25, 1), 100);\r\n    const startKey = args.nextToken\r\n      ? JSON.parse(Buffer.from(args.nextToken, \"base64\").toString(\"utf8\"))\r\n      : undefined;\r\n\r\n    const out = await ddb.send(\r\n      new QueryCommand({\r\n        TableName: TABLE,\r\n        IndexName: \"gsi2\",\r\n        KeyConditionExpression: \"gsi2pk = :p\",\r\n        ExpressionAttributeValues: { \":p\": \"STATUS#PENDING\" },\r\n        ScanIndexForward: false,\r\n        Limit: limit,\r\n        ExclusiveStartKey: startKey,\r\n      })\r\n    );\r\n\r\n    return {\r\n      items: (out.Items || []).map(toPublic),\r\n      nextToken: out.LastEvaluatedKey\r\n        ? Buffer.from(JSON.stringify(out.LastEvaluatedKey)).toString(\"base64\")\r\n        : null,\r\n    };\r\n  }\r\n\r\n  // ------------------ Mutation.adminApproveItem ------------------\r\n  if (field === \"adminApproveItem\") {\r\n    if (!isAdmin(ident)) throw new Error(\"Not authorized\");\r\n    const { id } = event.arguments as { id: string };\r\n\r\n    const ts = nowIso();\r\n    await ddb.send(\r\n      new UpdateCommand({\r\n        TableName: TABLE,\r\n        Key: keysForId(id),\r\n        UpdateExpression:\r\n          \"SET #s = :a, gsi2pk = :g, gsi2sk = :ts, updatedAt = :ts REMOVE approvalToken\",\r\n        ExpressionAttributeNames: { \"#s\": \"status\" },\r\n        ExpressionAttributeValues: {\r\n          \":a\": \"APPROVED\",\r\n          \":g\": \"STATUS#APPROVED\",\r\n          \":ts\": ts,\r\n        },\r\n      })\r\n    );\r\n    return true;\r\n  }\r\n\r\n  // ------------------ Mutation.adminRejectItem ------------------\r\n  if (field === \"adminRejectItem\") {\r\n    if (!isAdmin(ident)) throw new Error(\"Not authorized\");\r\n    const { id, reason } = event.arguments as { id: string; reason?: string };\r\n\r\n    const ts = nowIso();\r\n    await ddb.send(\r\n      new UpdateCommand({\r\n        TableName: TABLE,\r\n        Key: keysForId(id),\r\n        UpdateExpression:\r\n          \"SET #s = :r, gsi2pk = :g, gsi2sk = :ts, updatedAt = :ts, reason = :why REMOVE approvalToken\",\r\n        ExpressionAttributeNames: { \"#s\": \"status\" },\r\n        ExpressionAttributeValues: {\r\n          \":r\": \"REJECTED\",\r\n          \":g\": \"STATUS#REJECTED\",\r\n          \":ts\": ts,\r\n          \":why\": reason ?? \"Rejected by admin\",\r\n        },\r\n      })\r\n    );\r\n    return true;\r\n  }\r\n\r\n  // ----------------------------------------------------------------\r\n  throw new Error(`Unhandled field: ${field}`);\r\n};\r\n"],
  "mappings": "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",
  "names": ["graphql_exports", "__export", "handler", "__toCommonJS", "import_crypto", "import_client_dynamodb", "import_lib_dynamodb", "import_client_sfn", "TABLE", "APPROVAL_SM_ARN", "ddb", "sfn", "nowIso", "isAdmin", "ident", "groups", "assertAuth", "sub", "keysForId", "id", "toPublic", "raw", "event", "field", "x", "title", "mediaKey", "ts", "item", "got", "expr", "values", "updated", "key", "args", "limit", "startKey", "out", "reason"]
}
