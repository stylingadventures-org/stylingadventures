"use strict";var s=Object.defineProperty;var o=Object.getOwnPropertyDescriptor;var a=Object.getOwnPropertyNames;var c=Object.prototype.hasOwnProperty;var d=(e,r)=>{for(var t in r)s(e,t,{get:r[t],enumerable:!0})},E=(e,r,t,i)=>{if(r&&typeof r=="object"||typeof r=="function")for(let n of a(r))!c.call(e,n)&&n!==t&&s(e,n,{get:()=>r[n],enumerable:!(i=o(r,n))||i.enumerable});return e};var I=e=>E(s({},"__esModule",{value:!0}),e);var p={};d(p,{handler:()=>v});module.exports=I(p);function l(e){if(!e)return new Date().toISOString();let r=new Date(e);return Number.isNaN(r.getTime())?new Date().toISOString():r.toISOString()}function g(){return`arc-${Math.random().toString(36).slice(2,10)}`}async function m(e){if(!e.userId)throw new Error("CareerArchive RECORD_EVENT: missing userId");if(!e.eventType)throw new Error("CareerArchive RECORD_EVENT: missing eventType");let r=l(e.at),t={eventId:g(),userId:e.userId,episodeId:e.episodeId,characterId:e.characterId,arcId:e.arcId,eventType:e.eventType,at:r,payload:e.payload};return console.log("CareerArchive RECORD_EVENT normalized:",JSON.stringify(t,null,2)),{kind:"recorded",event:t}}async function T(e){if(!e.userId)throw new Error("CareerArchive GET_TIMELINE: missing userId");let r=new Date().toISOString(),t=[{eventId:"mock-1",label:"Started first episode",episodeId:"EP-001",eventType:"EPISODE_STARTED",at:r},{eventId:"mock-2",label:"Completed first episode",episodeId:"EP-001",eventType:"EPISODE_COMPLETED",at:r}],i={userId:e.userId,characterId:e.characterId,arcId:e.arcId,nodes:t,stats:{totalEvents:t.length,episodesCompleted:t.filter(n=>n.eventType==="EPISODE_COMPLETED").length,achievementsUnlocked:t.filter(n=>n.eventType==="ACHIEVEMENT_UNLOCKED").length}};return console.log("CareerArchive GET_TIMELINE summary (mock):",JSON.stringify(i,null,2)),{kind:"timeline",summary:i}}var v=async e=>{if(console.log("CareerArchive incoming event:",JSON.stringify(e,null,2)),!e||!e.action)throw new Error("CareerArchive: missing action");switch(e.action){case"RECORD_EVENT":if(!e.record)throw new Error("CareerArchive RECORD_EVENT: missing 'record' payload");return m(e.record);case"GET_TIMELINE":if(!e.timeline)throw new Error("CareerArchive GET_TIMELINE: missing 'timeline' payload");return T(e.timeline);default:throw new Error(`CareerArchive: unsupported action ${e.action}`)}};0&&(module.exports={handler});
//# sourceMappingURL=index.js.map
